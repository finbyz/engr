{
  "version": 3,
  "sources": ["../../../../../apps/frappe/node_modules/frappe-datatable/node_modules/sortablejs/Sortable.js", "../../../../../apps/frappe/node_modules/frappe-datatable/dist/frappe-datatable.cjs.js", "../../../../../apps/engr/engr/public/js/taxes_and_totals.js", "../../../../../apps/engr/engr/public/js/transaction.js", "../../../../../apps/engr/engr/public/js/frappe/report/query_report.js", "../../../../../apps/engr/engr/public/js/utils.js"],
  "sourcesContent": ["/**!\n * Sortable\n * @author\tRubaXa   <trash@rubaxa.org>\n * @author\towenm    <owen23355@gmail.com>\n * @license MIT\n */\n\n(function sortableModule(factory) {\n\t\"use strict\";\n\n\tif (typeof define === \"function\" && define.amd) {\n\t\tdefine(factory);\n\t}\n\telse if (typeof module != \"undefined\" && typeof module.exports != \"undefined\") {\n\t\tmodule.exports = factory();\n\t}\n\telse {\n\t\t/* jshint sub:true */\n\t\twindow[\"Sortable\"] = factory();\n\t}\n})(function sortableFactory() {\n\t\"use strict\";\n\n\tif (typeof window === \"undefined\" || !window.document) {\n\t\treturn function sortableError() {\n\t\t\tthrow new Error(\"Sortable.js requires a window with a document\");\n\t\t};\n\t}\n\n\tvar dragEl,\n\t\tparentEl,\n\t\tghostEl,\n\t\tcloneEl,\n\t\trootEl,\n\t\tnextEl,\n\t\tlastDownEl,\n\n\t\tscrollEl,\n\t\tscrollParentEl,\n\t\tscrollCustomFn,\n\n\t\toldIndex,\n\t\tnewIndex,\n\n\t\tactiveGroup,\n\t\tputSortable,\n\n\t\tautoScrolls = [],\n\t\tscrolling = false,\n\n\t\tawaitingDragStarted = false,\n\t\tignoreNextClick = false,\n\t\tsortables = [],\n\n\t\tpointerElemChangedInterval,\n\t\tlastPointerElemX,\n\t\tlastPointerElemY,\n\n\t\ttapEvt,\n\t\ttouchEvt,\n\n\t\tmoved,\n\n\n\t\tlastTarget,\n\t\tlastDirection,\n\t\tpastFirstInvertThresh = false,\n\t\tisCircumstantialInvert = false,\n\t\tlastMode, // 'swap' or 'insert'\n\n\t\ttargetMoveDistance,\n\n\n\t\tforRepaintDummy,\n\t\trealDragElRect, // dragEl rect after current animation\n\n\t\t/** @const */\n\t\tR_SPACE = /\\s+/g,\n\n\t\texpando = 'Sortable' + (new Date).getTime(),\n\n\t\twin = window,\n\t\tdocument = win.document,\n\t\tparseInt = win.parseInt,\n\t\tsetTimeout = win.setTimeout,\n\n\t\t$ = win.jQuery || win.Zepto,\n\t\tPolymer = win.Polymer,\n\n\t\tcaptureMode = {\n\t\t\tcapture: false,\n\t\t\tpassive: false\n\t\t},\n\n\t\tIE11OrLess = !!navigator.userAgent.match(/(?:Trident.*rv[ :]?11\\.|msie|iemobile)/i),\n\t\tEdge = !!navigator.userAgent.match(/Edge/i),\n\t\t// FireFox = !!navigator.userAgent.match(/firefox/i),\n\n\t\tCSSFloatProperty = Edge || IE11OrLess ? 'cssFloat' : 'float',\n\n\t\t// This will not pass for IE9, because IE9 DnD only works on anchors\n\t\tsupportDraggable = ('draggable' in document.createElement('div')),\n\n\t\tsupportCssPointerEvents = (function() {\n\t\t\t// false when <= IE11\n\t\t\tif (IE11OrLess) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tvar el = document.createElement('x');\n\t\t\tel.style.cssText = 'pointer-events:auto';\n\t\t\treturn el.style.pointerEvents === 'auto';\n\t\t})(),\n\n\t\t_silent = false,\n\t\t_alignedSilent = false,\n\n\t\tabs = Math.abs,\n\t\tmin = Math.min,\n\n\t\tsavedInputChecked = [],\n\n\t\t_detectDirection = function(el, options) {\n\t\t\tvar elCSS = _css(el),\n\t\t\t\telWidth = parseInt(elCSS.width),\n\t\t\t\tchild1 = _getChild(el, 0, options),\n\t\t\t\tchild2 = _getChild(el, 1, options),\n\t\t\t\tfirstChildCSS = child1 && _css(child1),\n\t\t\t\tsecondChildCSS = child2 && _css(child2),\n\t\t\t\tfirstChildWidth = firstChildCSS && parseInt(firstChildCSS.marginLeft) + parseInt(firstChildCSS.marginRight) + _getRect(child1).width,\n\t\t\t\tsecondChildWidth = secondChildCSS && parseInt(secondChildCSS.marginLeft) + parseInt(secondChildCSS.marginRight) + _getRect(child2).width;\n\t\t\tif (elCSS.display === 'flex') {\n\t\t\t\treturn elCSS.flexDirection === 'column' || elCSS.flexDirection === 'column-reverse'\n\t\t\t\t? 'vertical' : 'horizontal';\n\t\t\t}\n\t\t\tif (child1 && firstChildCSS.float !== 'none') {\n\t\t\t\tvar touchingSideChild2 = firstChildCSS.float === 'left' ? 'left' : 'right';\n\n\t\t\t\treturn child2 && (secondChildCSS.clear === 'both' || secondChildCSS.clear === touchingSideChild2) ?\n\t\t\t\t\t'vertical' : 'horizontal';\n\t\t\t}\n\t\t\treturn (child1 &&\n\t\t\t\t(\n\t\t\t\t\tfirstChildCSS.display === 'block' ||\n\t\t\t\t\tfirstChildCSS.display === 'flex' ||\n\t\t\t\t\tfirstChildCSS.display === 'table' ||\n\t\t\t\t\tfirstChildCSS.display === 'grid' ||\n\t\t\t\t\tfirstChildWidth >= elWidth &&\n\t\t\t\t\telCSS[CSSFloatProperty] === 'none' ||\n\t\t\t\t\tchild2 &&\n\t\t\t\t\telCSS[CSSFloatProperty] === 'none' &&\n\t\t\t\t\tfirstChildWidth + secondChildWidth > elWidth\n\t\t\t\t) ?\n\t\t\t\t'vertical' : 'horizontal'\n\t\t\t);\n\t\t},\n\n\t\t/**\n\t\t * Detects first nearest empty sortable to X and Y position using emptyInsertThreshold.\n\t\t * @param  {Number} x      X position\n\t\t * @param  {Number} y      Y position\n\t\t * @return {HTMLElement}   Element of the first found nearest Sortable\n\t\t */\n\t\t_detectNearestEmptySortable = function(x, y) {\n\t\t\tfor (var i = 0; i < sortables.length; i++) {\n\t\t\t\tif (sortables[i].children.length) continue;\n\n\t\t\t\tvar rect = _getRect(sortables[i]),\n\t\t\t\t\tthreshold = sortables[i][expando].options.emptyInsertThreshold,\n\t\t\t\t\tinsideHorizontally = x >= (rect.left - threshold) && x <= (rect.right + threshold),\n\t\t\t\t\tinsideVertically = y >= (rect.top - threshold) && y <= (rect.bottom + threshold);\n\n\t\t\t\tif (insideHorizontally && insideVertically) {\n\t\t\t\t\treturn sortables[i];\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t_isClientInRowColumn = function(x, y, el, axis, options) {\n\t\t\tvar targetRect = _getRect(el),\n\t\t\t\ttargetS1Opp = axis === 'vertical' ? targetRect.left : targetRect.top,\n\t\t\t\ttargetS2Opp = axis === 'vertical' ? targetRect.right : targetRect.bottom,\n\t\t\t\tmouseOnOppAxis = axis === 'vertical' ? x : y;\n\n\t\t\treturn targetS1Opp < mouseOnOppAxis && mouseOnOppAxis < targetS2Opp;\n\t\t},\n\n\t\t_isElInRowColumn = function(el1, el2, axis) {\n\t\t\tvar el1Rect = el1 === dragEl && realDragElRect || _getRect(el1),\n\t\t\t\tel2Rect = el2 === dragEl && realDragElRect || _getRect(el2),\n\t\t\t\tel1S1Opp = axis === 'vertical' ? el1Rect.left : el1Rect.top,\n\t\t\t\tel1S2Opp = axis === 'vertical' ? el1Rect.right : el1Rect.bottom,\n\t\t\t\tel1OppLength = axis === 'vertical' ? el1Rect.width : el1Rect.height,\n\t\t\t\tel2S1Opp = axis === 'vertical' ? el2Rect.left : el2Rect.top,\n\t\t\t\tel2S2Opp = axis === 'vertical' ? el2Rect.right : el2Rect.bottom,\n\t\t\t\tel2OppLength = axis === 'vertical' ? el2Rect.width : el2Rect.height;\n\n\t\t\treturn (\n\t\t\t\tel1S1Opp === el2S1Opp ||\n\t\t\t\tel1S2Opp === el2S2Opp ||\n\t\t\t\t(el1S1Opp + el1OppLength / 2) === (el2S1Opp + el2OppLength / 2)\n\t\t\t);\n\t\t},\n\n\t\t_getParentAutoScrollElement = function(el, includeSelf) {\n\t\t\t// skip to window\n\t\t\tif (!el || !el.getBoundingClientRect) return win;\n\n\t\t\tvar elem = el;\n\t\t\tvar gotSelf = false;\n\t\t\tdo {\n\t\t\t\t// we don't need to get elem css if it isn't even overflowing in the first place (performance)\n\t\t\t\tif (elem.clientWidth < elem.scrollWidth || elem.clientHeight < elem.scrollHeight) {\n\t\t\t\t\tvar elemCSS = _css(elem);\n\t\t\t\t\tif (\n\t\t\t\t\t\telem.clientWidth < elem.scrollWidth && (elemCSS.overflowX == 'auto' || elemCSS.overflowX == 'scroll') ||\n\t\t\t\t\t\telem.clientHeight < elem.scrollHeight && (elemCSS.overflowY == 'auto' || elemCSS.overflowY == 'scroll')\n\t\t\t\t\t) {\n\t\t\t\t\t\tif (!elem || !elem.getBoundingClientRect || elem === document.body) return win;\n\n\t\t\t\t\t\tif (gotSelf || includeSelf) return elem;\n\t\t\t\t\t\tgotSelf = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t/* jshint boss:true */\n\t\t\t} while (elem = elem.parentNode);\n\n\t\t\treturn win;\n\t\t},\n\n\t\t_autoScroll = _throttle(function (/**Event*/evt, /**Object*/options, /**HTMLElement*/rootEl, /**Boolean*/isFallback) {\n\t\t\t// Bug: https://bugzilla.mozilla.org/show_bug.cgi?id=505521\n\t\t\tif (options.scroll) {\n\t\t\t\tvar _this = rootEl ? rootEl[expando] : window,\n\t\t\t\t\tsens = options.scrollSensitivity,\n\t\t\t\t\tspeed = options.scrollSpeed,\n\n\t\t\t\t\tx = evt.clientX,\n\t\t\t\t\ty = evt.clientY,\n\n\t\t\t\t\twinWidth = window.innerWidth,\n\t\t\t\t\twinHeight = window.innerHeight,\n\n\t\t\t\t\tscrollThisInstance = false;\n\n\t\t\t\t// Detect scrollEl\n\t\t\t\tif (scrollParentEl !== rootEl) {\n\t\t\t\t\t_clearAutoScrolls();\n\n\t\t\t\t\tscrollEl = options.scroll;\n\t\t\t\t\tscrollCustomFn = options.scrollFn;\n\n\t\t\t\t\tif (scrollEl === true) {\n\t\t\t\t\t\tscrollEl = _getParentAutoScrollElement(rootEl, true);\n\t\t\t\t\t\tscrollParentEl = scrollEl;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\n\t\t\t\tvar layersOut = 0;\n\t\t\t\tvar currentParent = scrollEl;\n\t\t\t\tdo {\n\t\t\t\t\tvar\tel = currentParent,\n\t\t\t\t\t\trect = _getRect(el),\n\n\t\t\t\t\t\ttop = rect.top,\n\t\t\t\t\t\tbottom = rect.bottom,\n\t\t\t\t\t\tleft = rect.left,\n\t\t\t\t\t\tright = rect.right,\n\n\t\t\t\t\t\twidth = rect.width,\n\t\t\t\t\t\theight = rect.height,\n\n\t\t\t\t\t\tscrollWidth,\n\t\t\t\t\t\tscrollHeight,\n\n\t\t\t\t\t\tcss,\n\n\t\t\t\t\t\tvx,\n\t\t\t\t\t\tvy,\n\n\t\t\t\t\t\tcanScrollX,\n\t\t\t\t\t\tcanScrollY,\n\n\t\t\t\t\t\tscrollPosX,\n\t\t\t\t\t\tscrollPosY;\n\n\n\t\t\t\t\tif (el !== win) {\n\t\t\t\t\t\tscrollWidth = el.scrollWidth;\n\t\t\t\t\t\tscrollHeight = el.scrollHeight;\n\n\t\t\t\t\t\tcss = _css(el);\n\n\t\t\t\t\t\tcanScrollX = width < scrollWidth && (css.overflowX === 'auto' || css.overflowX === 'scroll');\n\t\t\t\t\t\tcanScrollY = height < scrollHeight && (css.overflowY === 'auto' || css.overflowY === 'scroll');\n\n\t\t\t\t\t\tscrollPosX = el.scrollLeft;\n\t\t\t\t\t\tscrollPosY = el.scrollTop;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tscrollWidth = document.documentElement.scrollWidth;\n\t\t\t\t\t\tscrollHeight = document.documentElement.scrollHeight;\n\n\t\t\t\t\t\tcss = _css(document.documentElement);\n\n\t\t\t\t\t\tcanScrollX = width < scrollWidth && (css.overflowX === 'auto' || css.overflowX === 'scroll' || css.overflowX === 'visible');\n\t\t\t\t\t\tcanScrollY = height < scrollHeight && (css.overflowY === 'auto' || css.overflowY === 'scroll' || css.overflowY === 'visible');\n\n\t\t\t\t\t\tscrollPosX = document.documentElement.scrollLeft;\n\t\t\t\t\t\tscrollPosY = document.documentElement.scrollTop;\n\t\t\t\t\t}\n\n\t\t\t\t\tvx = canScrollX && (abs(right - x) <= sens && (scrollPosX + width) < scrollWidth) - (abs(left - x) <= sens && !!scrollPosX);\n\n\t\t\t\t\tvy = canScrollY && (abs(bottom - y) <= sens && (scrollPosY + height) < scrollHeight) - (abs(top - y) <= sens && !!scrollPosY);\n\n\n\t\t\t\t\tif (!autoScrolls[layersOut]) {\n\t\t\t\t\t\tfor (var i = 0; i <= layersOut; i++) {\n\t\t\t\t\t\t\tif (!autoScrolls[i]) {\n\t\t\t\t\t\t\t\tautoScrolls[i] = {};\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (autoScrolls[layersOut].vx != vx || autoScrolls[layersOut].vy != vy || autoScrolls[layersOut].el !== el) {\n\t\t\t\t\t\tautoScrolls[layersOut].el = el;\n\t\t\t\t\t\tautoScrolls[layersOut].vx = vx;\n\t\t\t\t\t\tautoScrolls[layersOut].vy = vy;\n\n\t\t\t\t\t\tclearInterval(autoScrolls[layersOut].pid);\n\n\t\t\t\t\t\tif (el && (vx != 0 || vy != 0)) {\n\t\t\t\t\t\t\tscrollThisInstance = true;\n\t\t\t\t\t\t\t/* jshint loopfunc:true */\n\t\t\t\t\t\t\tautoScrolls[layersOut].pid = setInterval((function () {\n\t\t\t\t\t\t\t\t// emulate drag over during autoscroll (fallback), emulating native DnD behaviour\n\t\t\t\t\t\t\t\tif (isFallback && this.layer === 0) {\n\t\t\t\t\t\t\t\t\tSortable.active._emulateDragOver(true);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tvar scrollOffsetY = autoScrolls[this.layer].vy ? autoScrolls[this.layer].vy * speed : 0;\n\t\t\t\t\t\t\t\tvar scrollOffsetX = autoScrolls[this.layer].vx ? autoScrolls[this.layer].vx * speed : 0;\n\n\t\t\t\t\t\t\t\tif ('function' === typeof(scrollCustomFn)) {\n\t\t\t\t\t\t\t\t\tif (scrollCustomFn.call(_this, scrollOffsetX, scrollOffsetY, evt, touchEvt, autoScrolls[this.layer].el) !== 'continue') {\n\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (autoScrolls[this.layer].el === win) {\n\t\t\t\t\t\t\t\t\twin.scrollTo(win.pageXOffset + scrollOffsetX, win.pageYOffset + scrollOffsetY);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tautoScrolls[this.layer].el.scrollTop += scrollOffsetY;\n\t\t\t\t\t\t\t\t\tautoScrolls[this.layer].el.scrollLeft += scrollOffsetX;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}).bind({layer: layersOut}), 24);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tlayersOut++;\n\t\t\t\t} while (options.bubbleScroll && currentParent !== win && (currentParent = _getParentAutoScrollElement(currentParent, false)));\n\t\t\t\tscrolling = scrollThisInstance; // in case another function catches scrolling as false in between when it is not\n\t\t\t}\n\t\t}, 30),\n\n\t\t_clearAutoScrolls = function () {\n\t\t\tautoScrolls.forEach(function(autoScroll) {\n\t\t\t\tclearInterval(autoScroll.pid);\n\t\t\t});\n\t\t\tautoScrolls = [];\n\t\t},\n\n\t\t_prepareGroup = function (options) {\n\t\t\tfunction toFn(value, pull) {\n\t\t\t\treturn function(to, from, dragEl, evt) {\n\t\t\t\t\tvar sameGroup = to.options.group.name &&\n\t\t\t\t\t\t\t\t\tfrom.options.group.name &&\n\t\t\t\t\t\t\t\t\tto.options.group.name === from.options.group.name;\n\n\t\t\t\t\tif (value == null && (pull || sameGroup)) {\n\t\t\t\t\t\t// Default pull value\n\t\t\t\t\t\t// Default pull and put value if same group\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t} else if (value == null || value === false) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t} else if (pull && value === 'clone') {\n\t\t\t\t\t\treturn value;\n\t\t\t\t\t} else if (typeof value === 'function') {\n\t\t\t\t\t\treturn toFn(value(to, from, dragEl, evt), pull)(to, from, dragEl, evt);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar otherGroup = (pull ? to : from).options.group.name;\n\n\t\t\t\t\t\treturn (value === true ||\n\t\t\t\t\t\t(typeof value === 'string' && value === otherGroup) ||\n\t\t\t\t\t\t(value.join && value.indexOf(otherGroup) > -1));\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tvar group = {};\n\t\t\tvar originalGroup = options.group;\n\n\t\t\tif (!originalGroup || typeof originalGroup != 'object') {\n\t\t\t\toriginalGroup = {name: originalGroup};\n\t\t\t}\n\n\t\t\tgroup.name = originalGroup.name;\n\t\t\tgroup.checkPull = toFn(originalGroup.pull, true);\n\t\t\tgroup.checkPut = toFn(originalGroup.put);\n\t\t\tgroup.revertClone = originalGroup.revertClone;\n\n\t\t\toptions.group = group;\n\t\t},\n\n\t\t_checkAlignment = function(evt) {\n\t\t\tif (!dragEl || !dragEl.parentNode) return;\n\t\t\tdragEl.parentNode[expando] && dragEl.parentNode[expando]._computeIsAligned(evt);\n\t\t},\n\n\t\t_isTrueParentSortable = function(el, target) {\n\t\t\tvar trueParent = target;\n\t\t\twhile (!trueParent[expando]) {\n\t\t\t\ttrueParent = trueParent.parentNode;\n\t\t\t}\n\n\t\t\treturn el === trueParent;\n\t\t},\n\n\t\t_artificalBubble = function(sortable, originalEvt, method) {\n\t\t\t// Artificial IE bubbling\n\t\t\tvar nextParent = sortable.parentNode;\n\t\t\twhile (nextParent && !nextParent[expando]) {\n\t\t\t\tnextParent = nextParent.parentNode;\n\t\t\t}\n\n\t\t\tif (nextParent) {\n\t\t\t\tnextParent[expando][method](_extend(originalEvt, {\n\t\t\t\t\tartificialBubble: true\n\t\t\t\t}));\n\t\t\t}\n\t\t},\n\n\t\t_hideGhostForTarget = function() {\n\t\t\tif (!supportCssPointerEvents && ghostEl) {\n\t\t\t\t_css(ghostEl, 'display', 'none');\n\t\t\t}\n\t\t},\n\n\t\t_unhideGhostForTarget = function() {\n\t\t\tif (!supportCssPointerEvents && ghostEl) {\n\t\t\t\t_css(ghostEl, 'display', '');\n\t\t\t}\n\t\t};\n\n\n\t// #1184 fix - Prevent click event on fallback if dragged but item not changed position\n\tdocument.addEventListener('click', function(evt) {\n\t\tif (ignoreNextClick) {\n\t\t\tevt.preventDefault();\n\t\t\tevt.stopPropagation && evt.stopPropagation();\n\t\t\tevt.stopImmediatePropagation && evt.stopImmediatePropagation();\n\t\t\tignoreNextClick = false;\n\t\t\treturn false;\n\t\t}\n\t}, true);\n\n\tvar nearestEmptyInsertDetectEvent = function(evt) {\n\t\tevt = evt.touches ? evt.touches[0] : evt;\n\t\tif (dragEl) {\n\t\t\tvar nearest = _detectNearestEmptySortable(evt.clientX, evt.clientY);\n\n\t\t\tif (nearest) {\n\t\t\t\tnearest[expando]._onDragOver({\n\t\t\t\t\tclientX: evt.clientX,\n\t\t\t\t\tclientY: evt.clientY,\n\t\t\t\t\ttarget: nearest,\n\t\t\t\t\trootEl: nearest\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t};\n\t// We do not want this to be triggered if completed (bubbling canceled), so only define it here\n\t_on(document, 'dragover', nearestEmptyInsertDetectEvent);\n\t_on(document, 'mousemove', nearestEmptyInsertDetectEvent);\n\t_on(document, 'touchmove', nearestEmptyInsertDetectEvent);\n\n\t/**\n\t * @class  Sortable\n\t * @param  {HTMLElement}  el\n\t * @param  {Object}       [options]\n\t */\n\tfunction Sortable(el, options) {\n\t\tif (!(el && el.nodeType && el.nodeType === 1)) {\n\t\t\tthrow 'Sortable: `el` must be HTMLElement, not ' + {}.toString.call(el);\n\t\t}\n\n\t\tthis.el = el; // root element\n\t\tthis.options = options = _extend({}, options);\n\n\n\t\t// Export instance\n\t\tel[expando] = this;\n\n\t\t// Default options\n\t\tvar defaults = {\n\t\t\tgroup: null,\n\t\t\tsort: true,\n\t\t\tdisabled: false,\n\t\t\tstore: null,\n\t\t\thandle: null,\n\t\t\tscroll: true,\n\t\t\tscrollSensitivity: 30,\n\t\t\tscrollSpeed: 10,\n\t\t\tbubbleScroll: true,\n\t\t\tdraggable: /[uo]l/i.test(el.nodeName) ? '>li' : '>*',\n\t\t\tswapThreshold: 1, // percentage; 0 <= x <= 1\n\t\t\tinvertSwap: false, // invert always\n\t\t\tinvertedSwapThreshold: null, // will be set to same as swapThreshold if default\n\t\t\tremoveCloneOnHide: true,\n\t\t\tdirection: function() {\n\t\t\t\treturn _detectDirection(el, this.options);\n\t\t\t},\n\t\t\tghostClass: 'sortable-ghost',\n\t\t\tchosenClass: 'sortable-chosen',\n\t\t\tdragClass: 'sortable-drag',\n\t\t\tignore: 'a, img',\n\t\t\tfilter: null,\n\t\t\tpreventOnFilter: true,\n\t\t\tanimation: 0,\n\t\t\teasing: null,\n\t\t\tsetData: function (dataTransfer, dragEl) {\n\t\t\t\tdataTransfer.setData('Text', dragEl.textContent);\n\t\t\t},\n\t\t\tdropBubble: false,\n\t\t\tdragoverBubble: false,\n\t\t\tdataIdAttr: 'data-id',\n\t\t\tdelay: 0,\n\t\t\ttouchStartThreshold: parseInt(window.devicePixelRatio, 10) || 1,\n\t\t\tforceFallback: false,\n\t\t\tfallbackClass: 'sortable-fallback',\n\t\t\tfallbackOnBody: false,\n\t\t\tfallbackTolerance: 0,\n\t\t\tfallbackOffset: {x: 0, y: 0},\n\t\t\tsupportPointer: Sortable.supportPointer !== false && (\n\t\t\t\t('PointerEvent' in window) ||\n\t\t\t\twindow.navigator && ('msPointerEnabled' in window.navigator) // microsoft\n\t\t\t),\n\t\t\temptyInsertThreshold: 5\n\t\t};\n\n\n\t\t// Set default options\n\t\tfor (var name in defaults) {\n\t\t\t!(name in options) && (options[name] = defaults[name]);\n\t\t}\n\n\t\t_prepareGroup(options);\n\n\t\t// Bind all private methods\n\t\tfor (var fn in this) {\n\t\t\tif (fn.charAt(0) === '_' && typeof this[fn] === 'function') {\n\t\t\t\tthis[fn] = this[fn].bind(this);\n\t\t\t}\n\t\t}\n\n\t\t// Setup drag mode\n\t\tthis.nativeDraggable = options.forceFallback ? false : supportDraggable;\n\n\t\t// Bind events\n\t\tif (options.supportPointer) {\n\t\t\t_on(el, 'pointerdown', this._onTapStart);\n\t\t} else {\n\t\t\t_on(el, 'mousedown', this._onTapStart);\n\t\t\t_on(el, 'touchstart', this._onTapStart);\n\t\t}\n\n\t\tif (this.nativeDraggable) {\n\t\t\t_on(el, 'dragover', this);\n\t\t\t_on(el, 'dragenter', this);\n\t\t}\n\n\t\tsortables.push(this.el);\n\n\t\t// Restore sorting\n\t\toptions.store && options.store.get && this.sort(options.store.get(this) || []);\n\t}\n\n\tSortable.prototype = /** @lends Sortable.prototype */ {\n\t\tconstructor: Sortable,\n\n\t\t_computeIsAligned: function(evt) {\n\t\t\tvar target;\n\n\t\t\tif (ghostEl && !supportCssPointerEvents) {\n\t\t\t\t_hideGhostForTarget();\n\t\t\t\ttarget = document.elementFromPoint(evt.clientX, evt.clientY);\n\t\t\t\t_unhideGhostForTarget();\n\t\t\t} else {\n\t\t\t\ttarget = evt.target;\n\t\t\t}\n\n\t\t\ttarget = _closest(target, this.options.draggable, this.el, false);\n\t\t\tif (_alignedSilent) return;\n\t\t\tif (!dragEl || dragEl.parentNode !== this.el) return;\n\n\t\t\tvar children = this.el.children;\n\t\t\tfor (var i = 0; i < children.length; i++) {\n\t\t\t\t// Don't change for target in case it is changed to aligned before onDragOver is fired\n\t\t\t\tif (_closest(children[i], this.options.draggable, this.el, false) && children[i] !== target) {\n\t\t\t\t\tchildren[i].sortableMouseAligned = _isClientInRowColumn(evt.clientX, evt.clientY, children[i], this._getDirection(evt, null), this.options);\n\t\t\t\t}\n\t\t\t}\n\t\t\t// Used for nulling last target when not in element, nothing to do with checking if aligned\n\t\t\tif (!_closest(target, this.options.draggable, this.el, true)) {\n\t\t\t\tlastTarget = null;\n\t\t\t}\n\n\t\t\t_alignedSilent = true;\n\t\t\tsetTimeout(function() {\n\t\t\t\t_alignedSilent = false;\n\t\t\t}, 30);\n\n\t\t},\n\n\t\t_getDirection: function(evt, target) {\n\t\t\treturn (typeof this.options.direction === 'function') ? this.options.direction.call(this, evt, target, dragEl) : this.options.direction;\n\t\t},\n\n\t\t_onTapStart: function (/** Event|TouchEvent */evt) {\n\t\t\tif (!evt.cancelable) return;\n\t\t\tvar _this = this,\n\t\t\t\tel = this.el,\n\t\t\t\toptions = this.options,\n\t\t\t\tpreventOnFilter = options.preventOnFilter,\n\t\t\t\ttype = evt.type,\n\t\t\t\ttouch = evt.touches && evt.touches[0],\n\t\t\t\ttarget = (touch || evt).target,\n\t\t\t\toriginalTarget = evt.target.shadowRoot && ((evt.path && evt.path[0]) || (evt.composedPath && evt.composedPath()[0])) || target,\n\t\t\t\tfilter = options.filter,\n\t\t\t\tstartIndex;\n\n\t\t\t_saveInputCheckedState(el);\n\n\n\t\t\t// IE: Calls events in capture mode if event element is nested. This ensures only correct element's _onTapStart goes through.\n\t\t\t// This process is also done in _onDragOver\n\t\t\tif (IE11OrLess && !evt.artificialBubble && !_isTrueParentSortable(el, target)) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Don't trigger start event when an element is been dragged, otherwise the evt.oldindex always wrong when set option.group.\n\t\t\tif (dragEl) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (/mousedown|pointerdown/.test(type) && evt.button !== 0 || options.disabled) {\n\t\t\t\treturn; // only left button and enabled\n\t\t\t}\n\n\t\t\t// cancel dnd if original target is content editable\n\t\t\tif (originalTarget.isContentEditable) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\ttarget = _closest(target, options.draggable, el, false);\n\n\t\t\tif (!target) {\n\t\t\t\tif (IE11OrLess) {\n\t\t\t\t\t_artificalBubble(el, evt, '_onTapStart');\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (lastDownEl === target) {\n\t\t\t\t// Ignoring duplicate `down`\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Get the index of the dragged element within its parent\n\t\t\tstartIndex = _index(target, options.draggable);\n\n\t\t\t// Check filter\n\t\t\tif (typeof filter === 'function') {\n\t\t\t\tif (filter.call(this, evt, target, this)) {\n\t\t\t\t\t_dispatchEvent(_this, originalTarget, 'filter', target, el, el, startIndex);\n\t\t\t\t\tpreventOnFilter && evt.cancelable && evt.preventDefault();\n\t\t\t\t\treturn; // cancel dnd\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (filter) {\n\t\t\t\tfilter = filter.split(',').some(function (criteria) {\n\t\t\t\t\tcriteria = _closest(originalTarget, criteria.trim(), el, false);\n\n\t\t\t\t\tif (criteria) {\n\t\t\t\t\t\t_dispatchEvent(_this, criteria, 'filter', target, el, el, startIndex);\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif (filter) {\n\t\t\t\t\tpreventOnFilter && evt.cancelable && evt.preventDefault();\n\t\t\t\t\treturn; // cancel dnd\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (options.handle && !_closest(originalTarget, options.handle, el, false)) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Prepare `dragstart`\n\t\t\tthis._prepareDragStart(evt, touch, target, startIndex);\n\t\t},\n\n\n\t\t_handleAutoScroll: function(evt, fallback) {\n\t\t\tif (!dragEl || !this.options.scroll) return;\n\t\t\tvar x = evt.clientX,\n\t\t\t\ty = evt.clientY,\n\n\t\t\t\telem = document.elementFromPoint(x, y),\n\t\t\t\t_this = this;\n\n\t\t\t// IE does not seem to have native autoscroll,\n\t\t\t// Edge's autoscroll seems too conditional,\n\t\t\t// Firefox and Chrome are good\n\t\t\tif (fallback || Edge || IE11OrLess) {\n\t\t\t\t_autoScroll(evt, _this.options, elem, fallback);\n\n\t\t\t\t// Listener for pointer element change\n\t\t\t\tvar ogElemScroller = _getParentAutoScrollElement(elem, true);\n\t\t\t\tif (\n\t\t\t\t\tscrolling &&\n\t\t\t\t\t(\n\t\t\t\t\t\t!pointerElemChangedInterval ||\n\t\t\t\t\t\tx !== lastPointerElemX ||\n\t\t\t\t\t\ty !== lastPointerElemY\n\t\t\t\t\t)\n\t\t\t\t) {\n\n\t\t\t\t\tpointerElemChangedInterval && clearInterval(pointerElemChangedInterval);\n\t\t\t\t\t// Detect for pointer elem change, emulating native DnD behaviour\n\t\t\t\t\tpointerElemChangedInterval = setInterval(function() {\n\t\t\t\t\t\tif (!dragEl) return;\n\t\t\t\t\t\t// could also check if scroll direction on newElem changes due to parent autoscrolling\n\t\t\t\t\t\tvar newElem = _getParentAutoScrollElement(document.elementFromPoint(x, y), true);\n\t\t\t\t\t\tif (newElem !== ogElemScroller) {\n\t\t\t\t\t\t\togElemScroller = newElem;\n\t\t\t\t\t\t\t_clearAutoScrolls();\n\t\t\t\t\t\t\t_autoScroll(evt, _this.options, ogElemScroller, fallback);\n\t\t\t\t\t\t}\n\t\t\t\t\t}, 10);\n\t\t\t\t\tlastPointerElemX = x;\n\t\t\t\t\tlastPointerElemY = y;\n\t\t\t\t}\n\n\t\t\t} else {\n\t\t\t\t// if DnD is enabled (and browser has good autoscrolling), first autoscroll will already scroll, so get parent autoscroll of first autoscroll\n\t\t\t\tif (!_this.options.bubbleScroll || _getParentAutoScrollElement(elem, true) === window) {\n\t\t\t\t\t_clearAutoScrolls();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t_autoScroll(evt, _this.options, _getParentAutoScrollElement(elem, false), false);\n\t\t\t}\n\t\t},\n\n\t\t_prepareDragStart: function (/** Event */evt, /** Touch */touch, /** HTMLElement */target, /** Number */startIndex) {\n\t\t\tvar _this = this,\n\t\t\t\tel = _this.el,\n\t\t\t\toptions = _this.options,\n\t\t\t\townerDocument = el.ownerDocument,\n\t\t\t\tdragStartFn;\n\n\t\t\tif (target && !dragEl && (target.parentNode === el)) {\n\t\t\t\trootEl = el;\n\t\t\t\tdragEl = target;\n\t\t\t\tparentEl = dragEl.parentNode;\n\t\t\t\tnextEl = dragEl.nextSibling;\n\t\t\t\tlastDownEl = target;\n\t\t\t\tactiveGroup = options.group;\n\t\t\t\toldIndex = startIndex;\n\n\t\t\t\ttapEvt = {\n\t\t\t\t\ttarget: dragEl,\n\t\t\t\t\tclientX: (touch || evt).clientX,\n\t\t\t\t\tclientY: (touch || evt).clientY\n\t\t\t\t};\n\n\t\t\t\tthis._lastX = (touch || evt).clientX;\n\t\t\t\tthis._lastY = (touch || evt).clientY;\n\n\t\t\t\tdragEl.style['will-change'] = 'all';\n\t\t\t\t// undo animation if needed\n\t\t\t\tdragEl.style.transition = '';\n\t\t\t\tdragEl.style.transform = '';\n\n\t\t\t\tdragStartFn = function () {\n\t\t\t\t\t// Delayed drag has been triggered\n\t\t\t\t\t// we can re-enable the events: touchmove/mousemove\n\t\t\t\t\t_this._disableDelayedDrag();\n\n\t\t\t\t\t// Make the element draggable\n\t\t\t\t\tdragEl.draggable = _this.nativeDraggable;\n\n\t\t\t\t\t// Bind the events: dragstart/dragend\n\t\t\t\t\t_this._triggerDragStart(evt, touch);\n\n\t\t\t\t\t// Drag start event\n\t\t\t\t\t_dispatchEvent(_this, rootEl, 'choose', dragEl, rootEl, rootEl, oldIndex);\n\n\t\t\t\t\t// Chosen item\n\t\t\t\t\t_toggleClass(dragEl, options.chosenClass, true);\n\t\t\t\t};\n\n\t\t\t\t// Disable \"draggable\"\n\t\t\t\toptions.ignore.split(',').forEach(function (criteria) {\n\t\t\t\t\t_find(dragEl, criteria.trim(), _disableDraggable);\n\t\t\t\t});\n\n\t\t\t\tif (options.supportPointer) {\n\t\t\t\t\t_on(ownerDocument, 'pointerup', _this._onDrop);\n\t\t\t\t} else {\n\t\t\t\t\t_on(ownerDocument, 'mouseup', _this._onDrop);\n\t\t\t\t\t_on(ownerDocument, 'touchend', _this._onDrop);\n\t\t\t\t\t_on(ownerDocument, 'touchcancel', _this._onDrop);\n\t\t\t\t}\n\n\t\t\t\tif (options.delay) {\n\t\t\t\t\t// If the user moves the pointer or let go the click or touch\n\t\t\t\t\t// before the delay has been reached:\n\t\t\t\t\t// disable the delayed drag\n\t\t\t\t\t_on(ownerDocument, 'mouseup', _this._disableDelayedDrag);\n\t\t\t\t\t_on(ownerDocument, 'touchend', _this._disableDelayedDrag);\n\t\t\t\t\t_on(ownerDocument, 'touchcancel', _this._disableDelayedDrag);\n\t\t\t\t\t_on(ownerDocument, 'mousemove', _this._delayedDragTouchMoveHandler);\n\t\t\t\t\t_on(ownerDocument, 'touchmove', _this._delayedDragTouchMoveHandler);\n\t\t\t\t\toptions.supportPointer && _on(ownerDocument, 'pointermove', _this._delayedDragTouchMoveHandler);\n\n\t\t\t\t\t_this._dragStartTimer = setTimeout(dragStartFn, options.delay);\n\t\t\t\t} else {\n\t\t\t\t\tdragStartFn();\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t_delayedDragTouchMoveHandler: function (/** TouchEvent|PointerEvent **/e) {\n\t\t\tvar touch = e.touches ? e.touches[0] : e;\n\t\t\tif (min(abs(touch.clientX - this._lastX), abs(touch.clientY - this._lastY))\n\t\t\t\t\t>= this.options.touchStartThreshold\n\t\t\t) {\n\t\t\t\tthis._disableDelayedDrag();\n\t\t\t}\n\t\t},\n\n\t\t_disableDelayedDrag: function () {\n\t\t\tvar ownerDocument = this.el.ownerDocument;\n\n\t\t\tclearTimeout(this._dragStartTimer);\n\t\t\t_off(ownerDocument, 'mouseup', this._disableDelayedDrag);\n\t\t\t_off(ownerDocument, 'touchend', this._disableDelayedDrag);\n\t\t\t_off(ownerDocument, 'touchcancel', this._disableDelayedDrag);\n\t\t\t_off(ownerDocument, 'mousemove', this._delayedDragTouchMoveHandler);\n\t\t\t_off(ownerDocument, 'touchmove', this._delayedDragTouchMoveHandler);\n\t\t\t_off(ownerDocument, 'pointermove', this._delayedDragTouchMoveHandler);\n\t\t},\n\n\t\t_triggerDragStart: function (/** Event */evt, /** Touch */touch) {\n\t\t\ttouch = touch || (evt.pointerType == 'touch' ? evt : null);\n\n\t\t\tif (!this.nativeDraggable || touch) {\n\t\t\t\tif (this.options.supportPointer) {\n\t\t\t\t\t_on(document, 'pointermove', this._onTouchMove);\n\t\t\t\t} else if (touch) {\n\t\t\t\t\t_on(document, 'touchmove', this._onTouchMove);\n\t\t\t\t} else {\n\t\t\t\t\t_on(document, 'mousemove', this._onTouchMove);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t_on(dragEl, 'dragend', this);\n\t\t\t\t_on(rootEl, 'dragstart', this._onDragStart);\n\t\t\t}\n\n\t\t\ttry {\n\t\t\t\tif (document.selection) {\n\t\t\t\t\t// Timeout neccessary for IE9\n\t\t\t\t\t_nextTick(function () {\n\t\t\t\t\t\tdocument.selection.empty();\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\twindow.getSelection().removeAllRanges();\n\t\t\t\t}\n\t\t\t} catch (err) {\n\t\t\t}\n\t\t},\n\n\t\t_dragStarted: function (fallback) {\n\t\t\tawaitingDragStarted = false;\n\t\t\tif (rootEl && dragEl) {\n\t\t\t\tif (this.nativeDraggable) {\n\t\t\t\t\t_on(document, 'dragover', this._handleAutoScroll);\n\t\t\t\t\t_on(document, 'dragover', _checkAlignment);\n\t\t\t\t}\n\t\t\t\tvar options = this.options;\n\n\t\t\t\t// Apply effect\n\t\t\t\t!fallback && _toggleClass(dragEl, options.dragClass, false);\n\t\t\t\t_toggleClass(dragEl, options.ghostClass, true);\n\n\t\t\t\t// In case dragging an animated element\n\t\t\t\t_css(dragEl, 'transform', '');\n\n\t\t\t\tSortable.active = this;\n\n\t\t\t\tfallback && this._appendGhost();\n\n\t\t\t\t// Drag start event\n\t\t\t\t_dispatchEvent(this, rootEl, 'start', dragEl, rootEl, rootEl, oldIndex);\n\t\t\t} else {\n\t\t\t\tthis._nulling();\n\t\t\t}\n\t\t},\n\n\t\t_emulateDragOver: function (bypassLastTouchCheck) {\n\t\t\tif (touchEvt) {\n\t\t\t\tif (this._lastX === touchEvt.clientX && this._lastY === touchEvt.clientY && !bypassLastTouchCheck) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis._lastX = touchEvt.clientX;\n\t\t\t\tthis._lastY = touchEvt.clientY;\n\n\t\t\t\t_hideGhostForTarget();\n\n\t\t\t\tvar target = document.elementFromPoint(touchEvt.clientX, touchEvt.clientY);\n\t\t\t\tvar parent = target;\n\n\t\t\t\twhile (target && target.shadowRoot) {\n\t\t\t\t\ttarget = target.shadowRoot.elementFromPoint(touchEvt.clientX, touchEvt.clientY);\n\t\t\t\t\tparent = target;\n\t\t\t\t}\n\n\t\t\t\tif (parent) {\n\t\t\t\t\tdo {\n\t\t\t\t\t\tif (parent[expando]) {\n\t\t\t\t\t\t\tvar inserted;\n\n\t\t\t\t\t\t\tinserted = parent[expando]._onDragOver({\n\t\t\t\t\t\t\t\tclientX: touchEvt.clientX,\n\t\t\t\t\t\t\t\tclientY: touchEvt.clientY,\n\t\t\t\t\t\t\t\ttarget: target,\n\t\t\t\t\t\t\t\trootEl: parent\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\tif (inserted && !this.options.dragoverBubble) {\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\ttarget = parent; // store last element\n\t\t\t\t\t}\n\t\t\t\t\t/* jshint boss:true */\n\t\t\t\t\twhile (parent = parent.parentNode);\n\t\t\t\t}\n\t\t\t\tdragEl.parentNode[expando]._computeIsAligned(touchEvt);\n\n\t\t\t\t_unhideGhostForTarget();\n\t\t\t}\n\t\t},\n\n\n\t\t_onTouchMove: function (/**TouchEvent*/evt) {\n\t\t\tif (tapEvt) {\n\t\t\t\tvar\toptions = this.options,\n\t\t\t\t\tfallbackTolerance = options.fallbackTolerance,\n\t\t\t\t\tfallbackOffset = options.fallbackOffset,\n\t\t\t\t\ttouch = evt.touches ? evt.touches[0] : evt,\n\t\t\t\t\tmatrix = ghostEl && _matrix(ghostEl),\n\t\t\t\t\tscaleX = ghostEl && matrix && matrix.a,\n\t\t\t\t\tscaleY = ghostEl && matrix && matrix.d,\n\t\t\t\t\tdx = ((touch.clientX - tapEvt.clientX) + fallbackOffset.x) / (scaleX ? scaleX : 1),\n\t\t\t\t\tdy = ((touch.clientY - tapEvt.clientY) + fallbackOffset.y) / (scaleY ? scaleY : 1),\n\t\t\t\t\ttranslate3d = evt.touches ? 'translate3d(' + dx + 'px,' + dy + 'px,0)' : 'translate(' + dx + 'px,' + dy + 'px)';\n\n\n\t\t\t\t// only set the status to dragging, when we are actually dragging\n\t\t\t\tif (!Sortable.active && !awaitingDragStarted) {\n\t\t\t\t\tif (fallbackTolerance &&\n\t\t\t\t\t\tmin(abs(touch.clientX - this._lastX), abs(touch.clientY - this._lastY)) < fallbackTolerance\n\t\t\t\t\t) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tthis._onDragStart(evt, true);\n\t\t\t\t}\n\n\t\t\t\tthis._handleAutoScroll(touch, true);\n\n\n\t\t\t\tmoved = true;\n\t\t\t\ttouchEvt = touch;\n\n\n\t\t\t\t_css(ghostEl, 'webkitTransform', translate3d);\n\t\t\t\t_css(ghostEl, 'mozTransform', translate3d);\n\t\t\t\t_css(ghostEl, 'msTransform', translate3d);\n\t\t\t\t_css(ghostEl, 'transform', translate3d);\n\n\t\t\t\tevt.cancelable && evt.preventDefault();\n\t\t\t}\n\t\t},\n\n\t\t_appendGhost: function () {\n\t\t\tif (!ghostEl) {\n\t\t\t\tvar rect = _getRect(dragEl, this.options.fallbackOnBody ? document.body : rootEl, true),\n\t\t\t\t\tcss = _css(dragEl),\n\t\t\t\t\toptions = this.options;\n\n\t\t\t\tghostEl = dragEl.cloneNode(true);\n\n\t\t\t\t_toggleClass(ghostEl, options.ghostClass, false);\n\t\t\t\t_toggleClass(ghostEl, options.fallbackClass, true);\n\t\t\t\t_toggleClass(ghostEl, options.dragClass, true);\n\n\t\t\t\t_css(ghostEl, 'box-sizing', 'border-box');\n\t\t\t\t_css(ghostEl, 'margin', 0);\n\t\t\t\t_css(ghostEl, 'top', rect.top);\n\t\t\t\t_css(ghostEl, 'left', rect.left);\n\t\t\t\t_css(ghostEl, 'width', rect.width);\n\t\t\t\t_css(ghostEl, 'height', rect.height);\n\t\t\t\t_css(ghostEl, 'opacity', '0.8');\n\t\t\t\t_css(ghostEl, 'position', 'fixed');\n\t\t\t\t_css(ghostEl, 'zIndex', '100000');\n\t\t\t\t_css(ghostEl, 'pointerEvents', 'none');\n\n\t\t\t\toptions.fallbackOnBody && document.body.appendChild(ghostEl) || rootEl.appendChild(ghostEl);\n\t\t\t}\n\t\t},\n\n\t\t_onDragStart: function (/**Event*/evt, /**boolean*/fallback) {\n\t\t\tvar _this = this;\n\t\t\tvar dataTransfer = evt.dataTransfer;\n\t\t\tvar options = _this.options;\n\n\t\t\t// Setup clone\n\t\t\tcloneEl = _clone(dragEl);\n\n\t\t\tcloneEl.draggable = false;\n\t\t\tcloneEl.style['will-change'] = '';\n\n\t\t\tthis._hideClone();\n\n\t\t\t_toggleClass(cloneEl, _this.options.chosenClass, false);\n\n\n\t\t\t// #1143: IFrame support workaround\n\t\t\t_this._cloneId = _nextTick(function () {\n\t\t\t\tif (!_this.options.removeCloneOnHide) {\n\t\t\t\t\trootEl.insertBefore(cloneEl, dragEl);\n\t\t\t\t}\n\t\t\t\t_dispatchEvent(_this, rootEl, 'clone', dragEl);\n\t\t\t});\n\n\n\t\t\t!fallback && _toggleClass(dragEl, options.dragClass, true);\n\n\t\t\t// Set proper drop events\n\t\t\tif (fallback) {\n\t\t\t\tignoreNextClick = true;\n\t\t\t\t_this._loopId = setInterval(_this._emulateDragOver, 50);\n\t\t\t} else {\n\t\t\t\t// Undo what was set in _prepareDragStart before drag started\n\t\t\t\t_off(document, 'mouseup', _this._onDrop);\n\t\t\t\t_off(document, 'touchend', _this._onDrop);\n\t\t\t\t_off(document, 'touchcancel', _this._onDrop);\n\n\t\t\t\tif (dataTransfer) {\n\t\t\t\t\tdataTransfer.effectAllowed = 'move';\n\t\t\t\t\toptions.setData && options.setData.call(_this, dataTransfer, dragEl);\n\t\t\t\t}\n\n\t\t\t\t_on(document, 'drop', _this);\n\n\t\t\t\t// #1276 fix:\n\t\t\t\t_css(dragEl, 'transform', 'translateZ(0)');\n\t\t\t}\n\n\t\t\tawaitingDragStarted = true;\n\n\t\t\t_this._dragStartId = _nextTick(_this._dragStarted.bind(_this, fallback));\n\t\t\t_on(document, 'selectstart', _this);\n\t\t},\n\n\t\t// Returns true - if no further action is needed (either inserted or another condition)\n\t\t_onDragOver: function (/**Event*/evt) {\n\t\t\tvar el = this.el,\n\t\t\t\ttarget = evt.target,\n\t\t\t\tdragRect,\n\t\t\t\ttargetRect,\n\t\t\t\trevert,\n\t\t\t\toptions = this.options,\n\t\t\t\tgroup = options.group,\n\t\t\t\tactiveSortable = Sortable.active,\n\t\t\t\tisOwner = (activeGroup === group),\n\t\t\t\tcanSort = options.sort,\n\t\t\t\t_this = this;\n\n\t\t\tif (_silent) return;\n\n\t\t\t// IE event order fix\n\t\t\tif (IE11OrLess && !evt.rootEl && !evt.artificialBubble && !_isTrueParentSortable(el, target)) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Return invocation when no further action is needed in another sortable\n\t\t\tfunction completed() {\n\t\t\t\tif (activeSortable) {\n\t\t\t\t\t// Set ghost class to new sortable's ghost class\n\t\t\t\t\t_toggleClass(dragEl, putSortable ? putSortable.options.ghostClass : activeSortable.options.ghostClass, false);\n\t\t\t\t\t_toggleClass(dragEl, options.ghostClass, true);\n\t\t\t\t}\n\n\t\t\t\tif (putSortable !== _this && _this !== Sortable.active) {\n\t\t\t\t\tputSortable = _this;\n\t\t\t\t} else if (_this === Sortable.active) {\n\t\t\t\t\tputSortable = null;\n\t\t\t\t}\n\n\n\t\t\t\t// Null lastTarget if it is not inside a previously swapped element\n\t\t\t\tif ((target === dragEl && !dragEl.animated) || (target === el && !target.animated)) {\n\t\t\t\t\tlastTarget = null;\n\t\t\t\t}\n\t\t\t\t// no bubbling and not fallback\n\t\t\t\tif (!options.dragoverBubble && !evt.rootEl && target !== document) {\n\t\t\t\t\t_this._handleAutoScroll(evt);\n\t\t\t\t\tdragEl.parentNode[expando]._computeIsAligned(evt);\n\t\t\t\t}\n\n\t\t\t\t!options.dragoverBubble && evt.stopPropagation && evt.stopPropagation();\n\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\t// Call when dragEl has been inserted\n\t\t\tfunction changed() {\n\t\t\t\t_dispatchEvent(_this, rootEl, 'change', target, el, rootEl, oldIndex, _index(dragEl, options.draggable), evt);\n\t\t\t}\n\n\n\t\t\tif (evt.preventDefault !== void 0) {\n\t\t\t\tevt.cancelable && evt.preventDefault();\n\t\t\t}\n\n\n\t\t\tmoved = true;\n\n\t\t\ttarget = _closest(target, options.draggable, el, true);\n\n\t\t\t// target is dragEl or target is animated\n\t\t\tif (!!_closest(evt.target, null, dragEl, true) || target.animated) {\n\t\t\t\treturn completed();\n\t\t\t}\n\n\t\t\tif (target !== dragEl) {\n\t\t\t\tignoreNextClick = false;\n\t\t\t}\n\n\t\t\tif (activeSortable && !options.disabled &&\n\t\t\t\t(isOwner\n\t\t\t\t\t? canSort || (revert = !rootEl.contains(dragEl)) // Reverting item into the original list\n\t\t\t\t\t: (\n\t\t\t\t\t\tputSortable === this ||\n\t\t\t\t\t\t(\n\t\t\t\t\t\t\t(this.lastPutMode = activeGroup.checkPull(this, activeSortable, dragEl, evt)) &&\n\t\t\t\t\t\t\tgroup.checkPut(this, activeSortable, dragEl, evt)\n\t\t\t\t\t\t)\n\t\t\t\t\t)\n\t\t\t\t)\n\t\t\t) {\n\t\t\t\tvar axis = this._getDirection(evt, target);\n\n\t\t\t\tdragRect = _getRect(dragEl);\n\n\t\t\t\tif (revert) {\n\t\t\t\t\tthis._hideClone();\n\t\t\t\t\tparentEl = rootEl; // actualization\n\n\t\t\t\t\tif (nextEl) {\n\t\t\t\t\t\trootEl.insertBefore(dragEl, nextEl);\n\t\t\t\t\t} else {\n\t\t\t\t\t\trootEl.appendChild(dragEl);\n\t\t\t\t\t}\n\n\t\t\t\t\treturn completed();\n\t\t\t\t}\n\n\t\t\t\tif ((el.children.length === 0) || (el.children[0] === ghostEl) ||\n\t\t\t\t\t_ghostIsLast(evt, axis, el) && !dragEl.animated\n\t\t\t\t) {\n\t\t\t\t\t//assign target only if condition is true\n\t\t\t\t\tif (el.children.length !== 0 && el.children[0] !== ghostEl && el === evt.target) {\n\t\t\t\t\t\ttarget = _lastChild(el);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (target) {\n\t\t\t\t\t\ttargetRect = _getRect(target);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (isOwner) {\n\t\t\t\t\t\tactiveSortable._hideClone();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tactiveSortable._showClone(this);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (_onMove(rootEl, el, dragEl, dragRect, target, targetRect, evt, !!target) !== false) {\n\t\t\t\t\t\tel.appendChild(dragEl);\n\t\t\t\t\t\tparentEl = el; // actualization\n\t\t\t\t\t\trealDragElRect = null;\n\n\t\t\t\t\t\tchanged();\n\t\t\t\t\t\tthis._animate(dragRect, dragEl);\n\t\t\t\t\t\ttarget && this._animate(targetRect, target);\n\t\t\t\t\t\treturn completed();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (target && target !== dragEl && target.parentNode === el) {\n\t\t\t\t\tvar direction = 0,\n\t\t\t\t\t\ttargetBeforeFirstSwap,\n\t\t\t\t\t\taligned = target.sortableMouseAligned,\n\t\t\t\t\t\tdifferentLevel = dragEl.parentNode !== el,\n\t\t\t\t\t\tscrolledPastTop = _isScrolledPast(target, axis === 'vertical' ? 'top' : 'left');\n\n\t\t\t\t\tif (lastTarget !== target) {\n\t\t\t\t\t\tlastMode = null;\n\t\t\t\t\t\ttargetBeforeFirstSwap = _getRect(target)[axis === 'vertical' ? 'top' : 'left'];\n\t\t\t\t\t\tpastFirstInvertThresh = false;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Reference: https://www.lucidchart.com/documents/view/10fa0e93-e362-4126-aca2-b709ee56bd8b/0\n\t\t\t\t\tif (\n\t\t\t\t\t\t_isElInRowColumn(dragEl, target, axis) && aligned ||\n\t\t\t\t\t\tdifferentLevel ||\n\t\t\t\t\t\tscrolledPastTop ||\n\t\t\t\t\t\toptions.invertSwap ||\n\t\t\t\t\t\tlastMode === 'insert' ||\n\t\t\t\t\t\t// Needed, in the case that we are inside target and inserted because not aligned... aligned will stay false while inside\n\t\t\t\t\t\t// and lastMode will change to 'insert', but we must swap\n\t\t\t\t\t\tlastMode === 'swap'\n\t\t\t\t\t) {\n\t\t\t\t\t\t// New target that we will be inside\n\t\t\t\t\t\tif (lastMode !== 'swap') {\n\t\t\t\t\t\t\tisCircumstantialInvert = options.invertSwap || differentLevel || scrolling || scrolledPastTop;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tdirection = _getSwapDirection(evt, target, axis,\n\t\t\t\t\t\t\toptions.swapThreshold, options.invertedSwapThreshold == null ? options.swapThreshold : options.invertedSwapThreshold,\n\t\t\t\t\t\t\tisCircumstantialInvert,\n\t\t\t\t\t\t\tlastTarget === target);\n\t\t\t\t\t\tlastMode = 'swap';\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// Insert at position\n\t\t\t\t\t\tdirection = _getInsertDirection(target, options);\n\t\t\t\t\t\tlastMode = 'insert';\n\t\t\t\t\t}\n\t\t\t\t\tif (direction === 0) return completed();\n\n\t\t\t\t\trealDragElRect = null;\n\t\t\t\t\tlastTarget = target;\n\n\t\t\t\t\tlastDirection = direction;\n\n\t\t\t\t\ttargetRect = _getRect(target);\n\n\t\t\t\t\tvar nextSibling = target.nextElementSibling,\n\t\t\t\t\t\tafter = false;\n\n\t\t\t\t\tafter = direction === 1;\n\n\t\t\t\t\tvar moveVector = _onMove(rootEl, el, dragEl, dragRect, target, targetRect, evt, after);\n\n\t\t\t\t\tif (moveVector !== false) {\n\t\t\t\t\t\tif (moveVector === 1 || moveVector === -1) {\n\t\t\t\t\t\t\tafter = (moveVector === 1);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t_silent = true;\n\t\t\t\t\t\tsetTimeout(_unsilent, 30);\n\n\t\t\t\t\t\tif (isOwner) {\n\t\t\t\t\t\t\tactiveSortable._hideClone();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tactiveSortable._showClone(this);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (after && !nextSibling) {\n\t\t\t\t\t\t\tel.appendChild(dragEl);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ttarget.parentNode.insertBefore(dragEl, after ? nextSibling : target);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tparentEl = dragEl.parentNode; // actualization\n\n\t\t\t\t\t\t// must be done before animation\n\t\t\t\t\t\tif (targetBeforeFirstSwap !== undefined && !isCircumstantialInvert) {\n\t\t\t\t\t\t\ttargetMoveDistance = abs(targetBeforeFirstSwap - _getRect(target)[axis === 'vertical' ? 'top' : 'left']);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tchanged();\n\t\t\t\t\t\t!differentLevel && this._animate(targetRect, target);\n\t\t\t\t\t\tthis._animate(dragRect, dragEl);\n\n\t\t\t\t\t\treturn completed();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (el.contains(dragEl)) {\n\t\t\t\t\treturn completed();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (IE11OrLess && !evt.rootEl) {\n\t\t\t\t_artificalBubble(el, evt, '_onDragOver');\n\t\t\t}\n\n\t\t\treturn false;\n\t\t},\n\n\t\t_animate: function (prevRect, target) {\n\t\t\tvar ms = this.options.animation;\n\n\t\t\tif (ms) {\n\t\t\t\tvar currentRect = _getRect(target);\n\n\t\t\t\tif (target === dragEl) {\n\t\t\t\t\trealDragElRect = currentRect;\n\t\t\t\t}\n\n\t\t\t\tif (prevRect.nodeType === 1) {\n\t\t\t\t\tprevRect = _getRect(prevRect);\n\t\t\t\t}\n\n\t\t\t\t// Check if actually moving position\n\t\t\t\tif ((prevRect.left + prevRect.width / 2) !== (currentRect.left + currentRect.width / 2)\n\t\t\t\t\t|| (prevRect.top + prevRect.height / 2) !== (currentRect.top + currentRect.height / 2)\n\t\t\t\t) {\n\t\t\t\t\tvar matrix = _matrix(this.el),\n\t\t\t\t\t\tscaleX = matrix && matrix.a,\n\t\t\t\t\t\tscaleY = matrix && matrix.d;\n\n\t\t\t\t\t_css(target, 'transition', 'none');\n\t\t\t\t\t_css(target, 'transform', 'translate3d('\n\t\t\t\t\t\t+ (prevRect.left - currentRect.left) / (scaleX ? scaleX : 1) + 'px,'\n\t\t\t\t\t\t+ (prevRect.top - currentRect.top) / (scaleY ? scaleY : 1) + 'px,0)'\n\t\t\t\t\t);\n\n\t\t\t\t\tforRepaintDummy = target.offsetWidth; // repaint\n\t\t\t\t\t_css(target, 'transition', 'transform ' + ms + 'ms' + (this.options.easing ? ' ' + this.options.easing : ''));\n\t\t\t\t\t_css(target, 'transform', 'translate3d(0,0,0)');\n\t\t\t\t}\n\n\t\t\t\t(typeof target.animated === 'number') && clearTimeout(target.animated);\n\t\t\t\ttarget.animated = setTimeout(function () {\n\t\t\t\t\t_css(target, 'transition', '');\n\t\t\t\t\t_css(target, 'transform', '');\n\t\t\t\t\ttarget.animated = false;\n\t\t\t\t}, ms);\n\t\t\t}\n\t\t},\n\n\t\t_offUpEvents: function () {\n\t\t\tvar ownerDocument = this.el.ownerDocument;\n\n\t\t\t_off(document, 'touchmove', this._onTouchMove);\n\t\t\t_off(document, 'pointermove', this._onTouchMove);\n\t\t\t_off(ownerDocument, 'mouseup', this._onDrop);\n\t\t\t_off(ownerDocument, 'touchend', this._onDrop);\n\t\t\t_off(ownerDocument, 'pointerup', this._onDrop);\n\t\t\t_off(ownerDocument, 'touchcancel', this._onDrop);\n\t\t\t_off(document, 'selectstart', this);\n\t\t},\n\n\t\t_onDrop: function (/**Event*/evt) {\n\t\t\tvar el = this.el,\n\t\t\t\toptions = this.options;\n\t\t\tawaitingDragStarted = false;\n\t\t\tscrolling = false;\n\t\t\tisCircumstantialInvert = false;\n\t\t\tpastFirstInvertThresh = false;\n\n\t\t\tclearInterval(this._loopId);\n\n\t\t\tclearInterval(pointerElemChangedInterval);\n\t\t\t_clearAutoScrolls();\n\t\t\t_cancelThrottle();\n\n\t\t\tclearTimeout(this._dragStartTimer);\n\n\t\t\t_cancelNextTick(this._cloneId);\n\t\t\t_cancelNextTick(this._dragStartId);\n\n\t\t\t// Unbind events\n\t\t\t_off(document, 'mousemove', this._onTouchMove);\n\n\n\t\t\tif (this.nativeDraggable) {\n\t\t\t\t_off(document, 'drop', this);\n\t\t\t\t_off(el, 'dragstart', this._onDragStart);\n\t\t\t\t_off(document, 'dragover', this._handleAutoScroll);\n\t\t\t\t_off(document, 'dragover', _checkAlignment);\n\t\t\t}\n\n\t\t\tthis._offUpEvents();\n\n\t\t\tif (evt) {\n\t\t\t\tif (moved) {\n\t\t\t\t\tevt.cancelable && evt.preventDefault();\n\t\t\t\t\t!options.dropBubble && evt.stopPropagation();\n\t\t\t\t}\n\n\t\t\t\tghostEl && ghostEl.parentNode && ghostEl.parentNode.removeChild(ghostEl);\n\n\t\t\t\tif (rootEl === parentEl || (putSortable && putSortable.lastPutMode !== 'clone')) {\n\t\t\t\t\t// Remove clone\n\t\t\t\t\tcloneEl && cloneEl.parentNode && cloneEl.parentNode.removeChild(cloneEl);\n\t\t\t\t}\n\n\t\t\t\tif (dragEl) {\n\t\t\t\t\tif (this.nativeDraggable) {\n\t\t\t\t\t\t_off(dragEl, 'dragend', this);\n\t\t\t\t\t}\n\n\t\t\t\t\t_disableDraggable(dragEl);\n\t\t\t\t\tdragEl.style['will-change'] = '';\n\n\t\t\t\t\t// Remove class's\n\t\t\t\t\t_toggleClass(dragEl, putSortable ? putSortable.options.ghostClass : this.options.ghostClass, false);\n\t\t\t\t\t_toggleClass(dragEl, this.options.chosenClass, false);\n\n\t\t\t\t\t// Drag stop event\n\t\t\t\t\t_dispatchEvent(this, rootEl, 'unchoose', dragEl, parentEl, rootEl, oldIndex, null, evt);\n\n\t\t\t\t\tif (rootEl !== parentEl) {\n\t\t\t\t\t\tnewIndex = _index(dragEl, options.draggable);\n\n\t\t\t\t\t\tif (newIndex >= 0) {\n\t\t\t\t\t\t\t// Add event\n\t\t\t\t\t\t\t_dispatchEvent(null, parentEl, 'add', dragEl, parentEl, rootEl, oldIndex, newIndex, evt);\n\n\t\t\t\t\t\t\t// Remove event\n\t\t\t\t\t\t\t_dispatchEvent(this, rootEl, 'remove', dragEl, parentEl, rootEl, oldIndex, newIndex, evt);\n\n\t\t\t\t\t\t\t// drag from one list and drop into another\n\t\t\t\t\t\t\t_dispatchEvent(null, parentEl, 'sort', dragEl, parentEl, rootEl, oldIndex, newIndex, evt);\n\t\t\t\t\t\t\t_dispatchEvent(this, rootEl, 'sort', dragEl, parentEl, rootEl, oldIndex, newIndex, evt);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tputSortable && putSortable.save();\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tif (dragEl.nextSibling !== nextEl) {\n\t\t\t\t\t\t\t// Get the index of the dragged element within its parent\n\t\t\t\t\t\t\tnewIndex = _index(dragEl, options.draggable);\n\n\t\t\t\t\t\t\tif (newIndex >= 0) {\n\t\t\t\t\t\t\t\t// drag & drop within the same list\n\t\t\t\t\t\t\t\t_dispatchEvent(this, rootEl, 'update', dragEl, parentEl, rootEl, oldIndex, newIndex, evt);\n\t\t\t\t\t\t\t\t_dispatchEvent(this, rootEl, 'sort', dragEl, parentEl, rootEl, oldIndex, newIndex, evt);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (Sortable.active) {\n\t\t\t\t\t\t/* jshint eqnull:true */\n\t\t\t\t\t\tif (newIndex == null || newIndex === -1) {\n\t\t\t\t\t\t\tnewIndex = oldIndex;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t_dispatchEvent(this, rootEl, 'end', dragEl, parentEl, rootEl, oldIndex, newIndex, evt);\n\n\t\t\t\t\t\t// Save sorting\n\t\t\t\t\t\tthis.save();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t}\n\t\t\tthis._nulling();\n\t\t},\n\n\t\t_nulling: function() {\n\t\t\trootEl =\n\t\t\tdragEl =\n\t\t\tparentEl =\n\t\t\tghostEl =\n\t\t\tnextEl =\n\t\t\tcloneEl =\n\t\t\tlastDownEl =\n\n\t\t\tscrollEl =\n\t\t\tscrollParentEl =\n\t\t\tautoScrolls.length =\n\n\t\t\tpointerElemChangedInterval =\n\t\t\tlastPointerElemX =\n\t\t\tlastPointerElemY =\n\n\t\t\ttapEvt =\n\t\t\ttouchEvt =\n\n\t\t\tmoved =\n\t\t\tnewIndex =\n\t\t\toldIndex =\n\n\t\t\tlastTarget =\n\t\t\tlastDirection =\n\n\t\t\tforRepaintDummy =\n\t\t\trealDragElRect =\n\n\t\t\tputSortable =\n\t\t\tactiveGroup =\n\t\t\tSortable.active = null;\n\n\t\t\tsavedInputChecked.forEach(function (el) {\n\t\t\t\tel.checked = true;\n\t\t\t});\n\n\t\t\tsavedInputChecked.length = 0;\n\t\t},\n\n\t\thandleEvent: function (/**Event*/evt) {\n\t\t\tswitch (evt.type) {\n\t\t\t\tcase 'drop':\n\t\t\t\tcase 'dragend':\n\t\t\t\t\tthis._onDrop(evt);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'dragenter':\n\t\t\t\tcase 'dragover':\n\t\t\t\t\tif (dragEl) {\n\t\t\t\t\t\tthis._onDragOver(evt);\n\t\t\t\t\t\t_globalDragOver(evt);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'selectstart':\n\t\t\t\t\tevt.preventDefault();\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t},\n\n\n\t\t/**\n\t\t * Serializes the item into an array of string.\n\t\t * @returns {String[]}\n\t\t */\n\t\ttoArray: function () {\n\t\t\tvar order = [],\n\t\t\t\tel,\n\t\t\t\tchildren = this.el.children,\n\t\t\t\ti = 0,\n\t\t\t\tn = children.length,\n\t\t\t\toptions = this.options;\n\n\t\t\tfor (; i < n; i++) {\n\t\t\t\tel = children[i];\n\t\t\t\tif (_closest(el, options.draggable, this.el, false)) {\n\t\t\t\t\torder.push(el.getAttribute(options.dataIdAttr) || _generateId(el));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn order;\n\t\t},\n\n\n\t\t/**\n\t\t * Sorts the elements according to the array.\n\t\t * @param  {String[]}  order  order of the items\n\t\t */\n\t\tsort: function (order) {\n\t\t\tvar items = {}, rootEl = this.el;\n\n\t\t\tthis.toArray().forEach(function (id, i) {\n\t\t\t\tvar el = rootEl.children[i];\n\n\t\t\t\tif (_closest(el, this.options.draggable, rootEl, false)) {\n\t\t\t\t\titems[id] = el;\n\t\t\t\t}\n\t\t\t}, this);\n\n\t\t\torder.forEach(function (id) {\n\t\t\t\tif (items[id]) {\n\t\t\t\t\trootEl.removeChild(items[id]);\n\t\t\t\t\trootEl.appendChild(items[id]);\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\n\t\t/**\n\t\t * Save the current sorting\n\t\t */\n\t\tsave: function () {\n\t\t\tvar store = this.options.store;\n\t\t\tstore && store.set && store.set(this);\n\t\t},\n\n\n\t\t/**\n\t\t * For each element in the set, get the first element that matches the selector by testing the element itself and traversing up through its ancestors in the DOM tree.\n\t\t * @param   {HTMLElement}  el\n\t\t * @param   {String}       [selector]  default: `options.draggable`\n\t\t * @returns {HTMLElement|null}\n\t\t */\n\t\tclosest: function (el, selector) {\n\t\t\treturn _closest(el, selector || this.options.draggable, this.el, false);\n\t\t},\n\n\n\t\t/**\n\t\t * Set/get option\n\t\t * @param   {string} name\n\t\t * @param   {*}      [value]\n\t\t * @returns {*}\n\t\t */\n\t\toption: function (name, value) {\n\t\t\tvar options = this.options;\n\n\t\t\tif (value === void 0) {\n\t\t\t\treturn options[name];\n\t\t\t} else {\n\t\t\t\toptions[name] = value;\n\n\t\t\t\tif (name === 'group') {\n\t\t\t\t\t_prepareGroup(options);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\n\t\t/**\n\t\t * Destroy\n\t\t */\n\t\tdestroy: function () {\n\t\t\tvar el = this.el;\n\n\t\t\tel[expando] = null;\n\n\t\t\t_off(el, 'mousedown', this._onTapStart);\n\t\t\t_off(el, 'touchstart', this._onTapStart);\n\t\t\t_off(el, 'pointerdown', this._onTapStart);\n\n\t\t\tif (this.nativeDraggable) {\n\t\t\t\t_off(el, 'dragover', this);\n\t\t\t\t_off(el, 'dragenter', this);\n\t\t\t}\n\t\t\t// Remove draggable attributes\n\t\t\tArray.prototype.forEach.call(el.querySelectorAll('[draggable]'), function (el) {\n\t\t\t\tel.removeAttribute('draggable');\n\t\t\t});\n\n\t\t\tthis._onDrop();\n\n\t\t\tsortables.splice(sortables.indexOf(this.el), 1);\n\n\t\t\tthis.el = el = null;\n\t\t},\n\n\t\t_hideClone: function() {\n\t\t\tif (!cloneEl.cloneHidden) {\n\t\t\t\t_css(cloneEl, 'display', 'none');\n\t\t\t\tcloneEl.cloneHidden = true;\n\t\t\t\tif (cloneEl.parentNode && this.options.removeCloneOnHide) {\n\t\t\t\t\tcloneEl.parentNode.removeChild(cloneEl);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t_showClone: function(putSortable) {\n\t\t\tif (putSortable.lastPutMode !== 'clone') {\n\t\t\t\tthis._hideClone();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (cloneEl.cloneHidden) {\n\t\t\t\t// show clone at dragEl or original position\n\t\t\t\tif (rootEl.contains(dragEl) && !this.options.group.revertClone) {\n\t\t\t\t\trootEl.insertBefore(cloneEl, dragEl);\n\t\t\t\t} else if (nextEl) {\n\t\t\t\t\trootEl.insertBefore(cloneEl, nextEl);\n\t\t\t\t} else {\n\t\t\t\t\trootEl.appendChild(cloneEl);\n\t\t\t\t}\n\n\t\t\t\tif (this.options.group.revertClone) {\n\t\t\t\t\tthis._animate(dragEl, cloneEl);\n\t\t\t\t}\n\t\t\t\t_css(cloneEl, 'display', '');\n\t\t\t\tcloneEl.cloneHidden = false;\n\t\t\t}\n\t\t}\n\t};\n\n\tfunction _closest(/**HTMLElement*/el, /**String*/selector, /**HTMLElement*/ctx, includeCTX) {\n\t\tif (el) {\n\t\t\tctx = ctx || document;\n\n\t\t\tdo {\n\t\t\t\tif (\n\t\t\t\t\tselector != null &&\n\t\t\t\t\t(\n\t\t\t\t\t\tselector[0] === '>' && el.parentNode === ctx && _matches(el, selector.substring(1)) ||\n\t\t\t\t\t\t_matches(el, selector)\n\t\t\t\t\t) ||\n\t\t\t\t\tincludeCTX && el === ctx\n\t\t\t\t) {\n\t\t\t\t\treturn el;\n\t\t\t\t}\n\n\t\t\t\tif (el === ctx) break;\n\t\t\t\t/* jshint boss:true */\n\t\t\t} while (el = _getParentOrHost(el));\n\t\t}\n\n\t\treturn null;\n\t}\n\n\n\tfunction _getParentOrHost(el) {\n\t\treturn (el.host && el !== document && el.host.nodeType)\n\t\t\t? el.host\n\t\t\t: el.parentNode;\n\t}\n\n\n\tfunction _globalDragOver(/**Event*/evt) {\n\t\tif (evt.dataTransfer) {\n\t\t\tevt.dataTransfer.dropEffect = 'move';\n\t\t}\n\t\tevt.cancelable && evt.preventDefault();\n\t}\n\n\n\tfunction _on(el, event, fn) {\n\t\tel.addEventListener(event, fn, captureMode);\n\t}\n\n\n\tfunction _off(el, event, fn) {\n\t\tel.removeEventListener(event, fn, captureMode);\n\t}\n\n\n\tfunction _toggleClass(el, name, state) {\n\t\tif (el && name) {\n\t\t\tif (el.classList) {\n\t\t\t\tel.classList[state ? 'add' : 'remove'](name);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tvar className = (' ' + el.className + ' ').replace(R_SPACE, ' ').replace(' ' + name + ' ', ' ');\n\t\t\t\tel.className = (className + (state ? ' ' + name : '')).replace(R_SPACE, ' ');\n\t\t\t}\n\t\t}\n\t}\n\n\n\tfunction _css(el, prop, val) {\n\t\tvar style = el && el.style;\n\n\t\tif (style) {\n\t\t\tif (val === void 0) {\n\t\t\t\tif (document.defaultView && document.defaultView.getComputedStyle) {\n\t\t\t\t\tval = document.defaultView.getComputedStyle(el, '');\n\t\t\t\t}\n\t\t\t\telse if (el.currentStyle) {\n\t\t\t\t\tval = el.currentStyle;\n\t\t\t\t}\n\n\t\t\t\treturn prop === void 0 ? val : val[prop];\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif (!(prop in style) && prop.indexOf('webkit') === -1) {\n\t\t\t\t\tprop = '-webkit-' + prop;\n\t\t\t\t}\n\n\t\t\t\tstyle[prop] = val + (typeof val === 'string' ? '' : 'px');\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction _matrix(el) {\n\t\tvar appliedTransforms = '';\n\t\tdo {\n\t\t\tvar transform = _css(el, 'transform');\n\n\t\t\tif (transform && transform !== 'none') {\n\t\t\t\tappliedTransforms = transform + ' ' + appliedTransforms;\n\t\t\t}\n\t\t\t/* jshint boss:true */\n\t\t} while (el = el.parentNode);\n\n\t\tif (window.DOMMatrix) {\n\t\t\treturn new DOMMatrix(appliedTransforms);\n\t\t} else if (window.WebKitCSSMatrix) {\n\t\t\treturn new WebKitCSSMatrix(appliedTransforms);\n\t\t} else if (window.CSSMatrix) {\n\t\t\treturn new CSSMatrix(appliedTransforms);\n\t\t}\n\t}\n\n\n\tfunction _find(ctx, tagName, iterator) {\n\t\tif (ctx) {\n\t\t\tvar list = ctx.getElementsByTagName(tagName), i = 0, n = list.length;\n\n\t\t\tif (iterator) {\n\t\t\t\tfor (; i < n; i++) {\n\t\t\t\t\titerator(list[i], i);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn list;\n\t\t}\n\n\t\treturn [];\n\t}\n\n\n\n\tfunction _dispatchEvent(sortable, rootEl, name, targetEl, toEl, fromEl, startIndex, newIndex, originalEvt) {\n\t\tsortable = (sortable || rootEl[expando]);\n\t\tvar evt,\n\t\t\toptions = sortable.options,\n\t\t\tonName = 'on' + name.charAt(0).toUpperCase() + name.substr(1);\n\t\t// Support for new CustomEvent feature\n\t\tif (window.CustomEvent && !IE11OrLess && !Edge) {\n\t\t\tevt = new CustomEvent(name, {\n\t\t\t\tbubbles: true,\n\t\t\t\tcancelable: true\n\t\t\t});\n\t\t} else {\n\t\t\tevt = document.createEvent('Event');\n\t\t\tevt.initEvent(name, true, true);\n\t\t}\n\n\t\tevt.to = toEl || rootEl;\n\t\tevt.from = fromEl || rootEl;\n\t\tevt.item = targetEl || rootEl;\n\t\tevt.clone = cloneEl;\n\n\t\tevt.oldIndex = startIndex;\n\t\tevt.newIndex = newIndex;\n\n\t\tevt.originalEvent = originalEvt;\n\n\t\tif (rootEl) {\n\t\t\trootEl.dispatchEvent(evt);\n\t        }\n\n\t\tif (options[onName]) {\n\t\t\toptions[onName].call(sortable, evt);\n\t\t}\n\t}\n\n\n\tfunction _onMove(fromEl, toEl, dragEl, dragRect, targetEl, targetRect, originalEvt, willInsertAfter) {\n\t\tvar evt,\n\t\t\tsortable = fromEl[expando],\n\t\t\tonMoveFn = sortable.options.onMove,\n\t\t\tretVal;\n\t\t// Support for new CustomEvent feature\n\t\tif (window.CustomEvent && !IE11OrLess && !Edge) {\n\t\t\tevt = new CustomEvent('move', {\n\t\t\t\tbubbles: true,\n\t\t\t\tcancelable: true\n\t\t\t});\n\t\t} else {\n\t\t\tevt = document.createEvent('Event');\n\t\t\tevt.initEvent('move', true, true);\n\t\t}\n\n\t\tevt.to = toEl;\n\t\tevt.from = fromEl;\n\t\tevt.dragged = dragEl;\n\t\tevt.draggedRect = dragRect;\n\t\tevt.related = targetEl || toEl;\n\t\tevt.relatedRect = targetRect || _getRect(toEl);\n\t\tevt.willInsertAfter = willInsertAfter;\n\n\t\tevt.originalEvent = originalEvt;\n\n\t\tfromEl.dispatchEvent(evt);\n\n\t\tif (onMoveFn) {\n\t\t\tretVal = onMoveFn.call(sortable, evt, originalEvt);\n\t\t}\n\n\t\treturn retVal;\n\t}\n\n\tfunction _disableDraggable(el) {\n\t\tel.draggable = false;\n\t}\n\n\tfunction _unsilent() {\n\t\t_silent = false;\n\t}\n\n\t/**\n\t * Gets nth child of el, ignoring hidden children, sortable's elements (does not ignore clone if it's visible)\n\t * and non-draggable elements\n\t * @param  {HTMLElement} el       The parent element\n\t * @param  {Number} childNum      The index of the child\n\t * @param  {Object} options       Parent Sortable's options\n\t * @return {HTMLElement}          The child at index childNum, or null if not found\n\t */\n\tfunction _getChild(el, childNum, options) {\n\t\tvar currentChild = 0,\n\t\t\ti = 0,\n\t\t\tchildren = el.children;\n\n\t\twhile (i < children.length) {\n\t\t\tif (\n\t\t\t\tchildren[i].style.display !== 'none' &&\n\t\t\t\tchildren[i] !== ghostEl &&\n\t\t\t\tchildren[i] !== dragEl &&\n\t\t\t\t_closest(children[i], options.draggable, el, false)\n\t\t\t) {\n\t\t\t\tif (currentChild === childNum) {\n\t\t\t\t\treturn children[i];\n\t\t\t\t}\n\t\t\t\tcurrentChild++;\n\t\t\t}\n\n\t\t\ti++;\n\t\t}\n\t\treturn null;\n\t}\n\n\t/**\n\t * Gets the last child in the el, ignoring ghostEl or invisible elements (clones)\n\t * @param  {HTMLElement} el       Parent element\n\t * @return {HTMLElement}          The last child, ignoring ghostEl\n\t */\n\tfunction _lastChild(el) {\n\t\tvar last = el.lastElementChild;\n\n\t\twhile (last === ghostEl || last.style.display === 'none') {\n\t\t\tlast = last.previousElementSibling;\n\n\t\t\tif (!last) break;\n\t\t}\n\n\t\treturn last || null;\n\t}\n\n\tfunction _ghostIsLast(evt, axis, el) {\n\t\tvar elRect = _getRect(_lastChild(el)),\n\t\t\tmouseOnAxis = axis === 'vertical' ? evt.clientY : evt.clientX,\n\t\t\tmouseOnOppAxis = axis === 'vertical' ? evt.clientX : evt.clientY,\n\t\t\ttargetS2 = axis === 'vertical' ? elRect.bottom : elRect.right,\n\t\t\ttargetS1Opp = axis === 'vertical' ? elRect.left : elRect.top,\n\t\t\ttargetS2Opp = axis === 'vertical' ? elRect.right : elRect.bottom,\n\t\t\tspacer = 10;\n\n\t\treturn (\n\t\t\taxis === 'vertical' ?\n\t\t\t\t(mouseOnOppAxis > targetS2Opp + spacer || mouseOnOppAxis <= targetS2Opp && mouseOnAxis > targetS2 && mouseOnOppAxis >= targetS1Opp) :\n\t\t\t\t(mouseOnAxis > targetS2 && mouseOnOppAxis > targetS1Opp || mouseOnAxis <= targetS2 && mouseOnOppAxis > targetS2Opp + spacer)\n\t\t);\n\t}\n\n\tfunction _getSwapDirection(evt, target, axis, swapThreshold, invertedSwapThreshold, invertSwap, isLastTarget) {\n\t\tvar targetRect = _getRect(target),\n\t\t\tmouseOnAxis = axis === 'vertical' ? evt.clientY : evt.clientX,\n\t\t\ttargetLength = axis === 'vertical' ? targetRect.height : targetRect.width,\n\t\t\ttargetS1 = axis === 'vertical' ? targetRect.top : targetRect.left,\n\t\t\ttargetS2 = axis === 'vertical' ? targetRect.bottom : targetRect.right,\n\t\t\tdragRect = _getRect(dragEl),\n\t\t\tinvert = false;\n\n\n\t\tif (!invertSwap) {\n\t\t\t// Never invert or create dragEl shadow when target movemenet causes mouse to move past the end of regular swapThreshold\n\t\t\tif (isLastTarget && targetMoveDistance < targetLength * swapThreshold) { // multiplied only by swapThreshold because mouse will already be inside target by (1 - threshold) * targetLength / 2\n\t\t\t\t// check if past first invert threshold on side opposite of lastDirection\n\t\t\t\tif (!pastFirstInvertThresh &&\n\t\t\t\t\t(lastDirection === 1 ?\n\t\t\t\t\t\t(\n\t\t\t\t\t\t\tmouseOnAxis > targetS1 + targetLength * invertedSwapThreshold / 2\n\t\t\t\t\t\t) :\n\t\t\t\t\t\t(\n\t\t\t\t\t\t\tmouseOnAxis < targetS2 - targetLength * invertedSwapThreshold / 2\n\t\t\t\t\t\t)\n\t\t\t\t\t)\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\t// past first invert threshold, do not restrict inverted threshold to dragEl shadow\n\t\t\t\t\tpastFirstInvertThresh = true;\n\t\t\t\t}\n\n\t\t\t\tif (!pastFirstInvertThresh) {\n\t\t\t\t\tvar dragS1 = axis === 'vertical' ? dragRect.top : dragRect.left,\n\t\t\t\t\t\tdragS2 = axis === 'vertical' ? dragRect.bottom : dragRect.right;\n\t\t\t\t\t// dragEl shadow (target move distance shadow)\n\t\t\t\t\tif (\n\t\t\t\t\t\tlastDirection === 1 ?\n\t\t\t\t\t\t(\n\t\t\t\t\t\t\tmouseOnAxis < targetS1 + targetMoveDistance // over dragEl shadow\n\t\t\t\t\t\t) :\n\t\t\t\t\t\t(\n\t\t\t\t\t\t\tmouseOnAxis > targetS2 - targetMoveDistance\n\t\t\t\t\t\t)\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn lastDirection * -1;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tinvert = true;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// Regular\n\t\t\t\tif (\n\t\t\t\t\tmouseOnAxis > targetS1 + (targetLength * (1 - swapThreshold) / 2) &&\n\t\t\t\t\tmouseOnAxis < targetS2 - (targetLength * (1 - swapThreshold) / 2)\n\t\t\t\t) {\n\t\t\t\t\treturn ((mouseOnAxis > targetS1 + targetLength / 2) ? -1 : 1);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tinvert = invert || invertSwap;\n\n\t\tif (invert) {\n\t\t\t// Invert of regular\n\t\t\tif (\n\t\t\t\tmouseOnAxis < targetS1 + (targetLength * invertedSwapThreshold / 2) ||\n\t\t\t\tmouseOnAxis > targetS2 - (targetLength * invertedSwapThreshold / 2)\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn ((mouseOnAxis > targetS1 + targetLength / 2) ? 1 : -1);\n\t\t\t}\n\t\t}\n\n\t\treturn 0;\n\t}\n\n\t/**\n\t * Gets the direction dragEl must be swapped relative to target in order to make it\n\t * seem that dragEl has been \"inserted\" into that element's position\n\t * @param  {HTMLElement} target       The target whose position dragEl is being inserted at\n\t * @param  {Object} options           options of the parent sortable\n\t * @return {Number}                   Direction dragEl must be swapped\n\t */\n\tfunction _getInsertDirection(target, options) {\n\t\tvar dragElIndex = _index(dragEl, options.draggable),\n\t\t\ttargetIndex = _index(target, options.draggable);\n\n\t\tif (dragElIndex < targetIndex) {\n\t\t\treturn 1;\n\t\t} else {\n\t\t\treturn -1;\n\t\t}\n\t}\n\n\n\t/**\n\t * Generate id\n\t * @param   {HTMLElement} el\n\t * @returns {String}\n\t * @private\n\t */\n\tfunction _generateId(el) {\n\t\tvar str = el.tagName + el.className + el.src + el.href + el.textContent,\n\t\t\ti = str.length,\n\t\t\tsum = 0;\n\n\t\twhile (i--) {\n\t\t\tsum += str.charCodeAt(i);\n\t\t}\n\n\t\treturn sum.toString(36);\n\t}\n\n\t/**\n\t * Returns the index of an element within its parent for a selected set of\n\t * elements\n\t * @param  {HTMLElement} el\n\t * @param  {selector} selector\n\t * @return {number}\n\t */\n\tfunction _index(el, selector) {\n\t\tvar index = 0;\n\n\t\tif (!el || !el.parentNode) {\n\t\t\treturn -1;\n\t\t}\n\n\t\twhile (el && (el = el.previousElementSibling)) {\n\t\t\tif ((el.nodeName.toUpperCase() !== 'TEMPLATE') && el !== cloneEl) {\n\t\t\t\tindex++;\n\t\t\t}\n\t\t}\n\n\t\treturn index;\n\t}\n\n\tfunction _matches(/**HTMLElement*/el, /**String*/selector) {\n\t\tif (el) {\n\t\t\ttry {\n\t\t\t\tif (el.matches) {\n\t\t\t\t\treturn el.matches(selector);\n\t\t\t\t} else if (el.msMatchesSelector) {\n\t\t\t\t\treturn el.msMatchesSelector(selector);\n\t\t\t\t} else if (el.webkitMatchesSelector) {\n\t\t\t\t\treturn el.webkitMatchesSelector(selector);\n\t\t\t\t}\n\t\t\t} catch(_) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tvar _throttleTimeout;\n\tfunction _throttle(callback, ms) {\n\t\treturn function () {\n\t\t\tif (!_throttleTimeout) {\n\t\t\t\tvar args = arguments,\n\t\t\t\t\t_this = this;\n\n\t\t\t\t_throttleTimeout = setTimeout(function () {\n\t\t\t\t\tif (args.length === 1) {\n\t\t\t\t\t\tcallback.call(_this, args[0]);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcallback.apply(_this, args);\n\t\t\t\t\t}\n\n\t\t\t\t\t_throttleTimeout = void 0;\n\t\t\t\t}, ms);\n\t\t\t}\n\t\t};\n\t}\n\n\tfunction _cancelThrottle() {\n\t\tclearTimeout(_throttleTimeout);\n\t\t_throttleTimeout = void 0;\n\t}\n\n\tfunction _extend(dst, src) {\n\t\tif (dst && src) {\n\t\t\tfor (var key in src) {\n\t\t\t\tif (src.hasOwnProperty(key)) {\n\t\t\t\t\tdst[key] = src[key];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn dst;\n\t}\n\n\tfunction _clone(el) {\n\t\tif (Polymer && Polymer.dom) {\n\t\t\treturn Polymer.dom(el).cloneNode(true);\n\t\t}\n\t\telse if ($) {\n\t\t\treturn $(el).clone(true)[0];\n\t\t}\n\t\telse {\n\t\t\treturn el.cloneNode(true);\n\t\t}\n\t}\n\n\tfunction _saveInputCheckedState(root) {\n\t\tsavedInputChecked.length = 0;\n\n\t\tvar inputs = root.getElementsByTagName('input');\n\t\tvar idx = inputs.length;\n\n\t\twhile (idx--) {\n\t\t\tvar el = inputs[idx];\n\t\t\tel.checked && savedInputChecked.push(el);\n\t\t}\n\t}\n\n\tfunction _nextTick(fn) {\n\t\treturn setTimeout(fn, 0);\n\t}\n\n\tfunction _cancelNextTick(id) {\n\t\treturn clearTimeout(id);\n\t}\n\n\n\t/**\n\t * Returns the \"bounding client rect\" of given element\n\t * @param  {HTMLElement} el                The element whose boundingClientRect is wanted\n\t * @param  {[HTMLElement]} container       the parent the element will be placed in\n\t * @param  {[Boolean]} adjustForTransform  Whether the rect should compensate for parent's transform\n\t * (used for fixed positioning on el)\n\t * @return {Object}                        The boundingClientRect of el\n\t */\n\tfunction _getRect(el, container, adjustForTransform) {\n\t\tif (!el.getBoundingClientRect && el !== win) return;\n\n\t\tvar elRect,\n\t\t\ttop,\n\t\t\tleft,\n\t\t\tbottom,\n\t\t\tright,\n\t\t\theight,\n\t\t\twidth;\n\n\t\tif (el !== win) {\n\t\t\telRect = el.getBoundingClientRect();\n\t\t\ttop = elRect.top;\n\t\t\tleft = elRect.left;\n\t\t\tbottom = elRect.bottom;\n\t\t\tright = elRect.right;\n\t\t\theight = elRect.height;\n\t\t\twidth = elRect.width;\n\t\t} else {\n\t\t\ttop = 0;\n\t\t\tleft = 0;\n\t\t\tbottom = window.innerHeight;\n\t\t\tright = window.innerWidth;\n\t\t\theight = window.innerHeight;\n\t\t\twidth = window.innerWidth;\n\t\t}\n\n\t\tif (adjustForTransform && el !== win) {\n\t\t\t// Adjust for translate()\n\t\t\tcontainer = container || el.parentNode;\n\n\t\t\t// solves #1123 (see: https://stackoverflow.com/a/37953806/6088312)\n\t\t\t// Not needed on <= IE11\n\t\t\tif (!IE11OrLess) {\n\t\t\t\tdo {\n\t\t\t\t\tif (container && container.getBoundingClientRect && _css(container, 'transform') !== 'none') {\n\t\t\t\t\t\tvar containerRect = container.getBoundingClientRect();\n\n\t\t\t\t\t\t// Set relative to edges of padding box of container\n\t\t\t\t\t\ttop -= containerRect.top + parseInt(_css(container, 'border-top-width'));\n\t\t\t\t\t\tleft -= containerRect.left + parseInt(_css(container, 'border-left-width'));\n\t\t\t\t\t\tbottom = top + elRect.height;\n\t\t\t\t\t\tright = left + elRect.width;\n\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\t/* jshint boss:true */\n\t\t\t\t} while (container = container.parentNode);\n\t\t\t}\n\n\t\t\t// Adjust for scale()\n\t\t\tvar matrix = _matrix(el),\n\t\t\t\tscaleX = matrix && matrix.a,\n\t\t\t\tscaleY = matrix && matrix.d;\n\n\t\t\tif (matrix) {\n\t\t\t\ttop /= scaleY;\n\t\t\t\tleft /= scaleX;\n\n\t\t\t\twidth /= scaleX;\n\t\t\t\theight /= scaleY;\n\n\t\t\t\tbottom = top + height;\n\t\t\t\tright = left + width;\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\ttop: top,\n\t\t\tleft: left,\n\t\t\tbottom: bottom,\n\t\t\tright: right,\n\t\t\twidth: width,\n\t\t\theight: height\n\t\t};\n\t}\n\n\n\t/**\n\t * Checks if a side of an element is scrolled past a side of it's parents\n\t * @param  {HTMLElement}  el       The element who's side being scrolled out of view is in question\n\t * @param  {String}       side     Side of the element in question ('top', 'left', 'right', 'bottom')\n\t * @return {Boolean}               Whether the element is overflowing the viewport on the given side of it's parent\n\t */\n\tfunction _isScrolledPast(el, side) {\n\t\tvar parent = _getParentAutoScrollElement(parent, true),\n\t\t\telSide = _getRect(el)[side];\n\n\t\t/* jshint boss:true */\n\t\twhile (parent) {\n\t\t\tvar parentSide = _getRect(parent)[side],\n\t\t\t\tvisible;\n\n\t\t\tif (side === 'top' || side === 'left') {\n\t\t\t\tvisible = elSide >= parentSide;\n\t\t\t} else {\n\t\t\t\tvisible = elSide <= parentSide;\n\t\t\t}\n\n\t\t\tif (!visible) return true;\n\n\t\t\tif (parent === win) break;\n\n\t\t\tparent = _getParentAutoScrollElement(parent, false);\n\t\t}\n\n\t\treturn false;\n\t}\n\n\t// Fixed #973:\n\t_on(document, 'touchmove', function(evt) {\n\t\tif ((Sortable.active || awaitingDragStarted) && evt.cancelable) {\n\t\t\tevt.preventDefault();\n\t\t}\n\t});\n\n\n\t// Export utils\n\tSortable.utils = {\n\t\ton: _on,\n\t\toff: _off,\n\t\tcss: _css,\n\t\tfind: _find,\n\t\tis: function (el, selector) {\n\t\t\treturn !!_closest(el, selector, el, false);\n\t\t},\n\t\textend: _extend,\n\t\tthrottle: _throttle,\n\t\tclosest: _closest,\n\t\ttoggleClass: _toggleClass,\n\t\tclone: _clone,\n\t\tindex: _index,\n\t\tnextTick: _nextTick,\n\t\tcancelNextTick: _cancelNextTick,\n\t\tdetectDirection: _detectDirection,\n\t\tgetChild: _getChild\n\t};\n\n\n\t/**\n\t * Create sortable instance\n\t * @param {HTMLElement}  el\n\t * @param {Object}      [options]\n\t */\n\tSortable.create = function (el, options) {\n\t\treturn new Sortable(el, options);\n\t};\n\n\n\t// Export\n\tSortable.version = '1.8.3';\n\treturn Sortable;\n});\n", "'use strict';\n\nfunction _interopDefault (ex) { return (ex && (typeof ex === 'object') && 'default' in ex) ? ex['default'] : ex; }\n\nvar Sortable = _interopDefault(require('sortablejs'));\n\nfunction $(expr, con) {\n    return typeof expr === 'string' ?\n        (con || document).querySelector(expr) :\n        expr || null;\n}\n\n$.each = (expr, con) => {\n    return typeof expr === 'string' ?\n        Array.from((con || document).querySelectorAll(expr)) :\n        expr || null;\n};\n\n$.create = (tag, o) => {\n    let element = document.createElement(tag);\n\n    for (let i in o) {\n        let val = o[i];\n\n        if (i === 'inside') {\n            $(val).appendChild(element);\n        } else\n        if (i === 'around') {\n            let ref = $(val);\n            ref.parentNode.insertBefore(element, ref);\n            element.appendChild(ref);\n        } else\n        if (i === 'styles') {\n            if (typeof val === 'object') {\n                Object.keys(val).map(prop => {\n                    element.style[prop] = val[prop];\n                });\n            }\n        } else\n        if (i in element) {\n            element[i] = val;\n        } else {\n            element.setAttribute(i, val);\n        }\n    }\n\n    return element;\n};\n\n$.on = (element, event, selector, callback) => {\n    if (!callback) {\n        callback = selector;\n        $.bind(element, event, callback);\n    } else {\n        $.delegate(element, event, selector, callback);\n    }\n};\n\n$.off = (element, event, handler) => {\n    element.removeEventListener(event, handler);\n};\n\n$.bind = (element, event, callback) => {\n    event.split(/\\s+/).forEach(function (event) {\n        element.addEventListener(event, callback);\n    });\n};\n\n$.delegate = (element, event, selector, callback) => {\n    element.addEventListener(event, function (e) {\n        const delegatedTarget = e.target.closest(selector);\n        if (delegatedTarget) {\n            e.delegatedTarget = delegatedTarget;\n            callback.call(this, e, delegatedTarget);\n        }\n    });\n};\n\n$.unbind = (element, o) => {\n    if (element) {\n        for (let event in o) {\n            let callback = o[event];\n\n            event.split(/\\s+/).forEach(function (event) {\n                element.removeEventListener(event, callback);\n            });\n        }\n    }\n};\n\n$.fire = (target, type, properties) => {\n    let evt = document.createEvent('HTMLEvents');\n\n    evt.initEvent(type, true, true);\n\n    for (let j in properties) {\n        evt[j] = properties[j];\n    }\n\n    return target.dispatchEvent(evt);\n};\n\n$.data = (element, attrs) => { // eslint-disable-line\n    if (!attrs) {\n        return element.dataset;\n    }\n\n    for (const attr in attrs) {\n        element.dataset[attr] = attrs[attr];\n    }\n};\n\n$.style = (elements, styleMap) => { // eslint-disable-line\n\n    if (typeof styleMap === 'string') {\n        return $.getStyle(elements, styleMap);\n    }\n\n    if (!Array.isArray(elements)) {\n        elements = [elements];\n    }\n\n    elements.map(element => {\n        for (const prop in styleMap) {\n            element.style[prop] = styleMap[prop];\n        }\n    });\n};\n\n$.removeStyle = (elements, styleProps) => {\n    if (!Array.isArray(elements)) {\n        elements = [elements];\n    }\n\n    if (!Array.isArray(styleProps)) {\n        styleProps = [styleProps];\n    }\n\n    elements.map(element => {\n        for (const prop of styleProps) {\n            element.style[prop] = '';\n        }\n    });\n};\n\n$.getStyle = (element, prop) => {\n    if (!prop) {\n        return getComputedStyle(element);\n    }\n\n    let val = getComputedStyle(element)[prop];\n\n    if (['width', 'height'].includes(prop)) {\n        val = parseFloat(val);\n    }\n\n    return val;\n};\n\n$.closest = (selector, element) => {\n    if (!element) return null;\n\n    if (element.matches(selector)) {\n        return element;\n    }\n\n    return $.closest(selector, element.parentNode);\n};\n\n$.inViewport = (el, parentEl) => {\n    const {\n        top,\n        left,\n        bottom,\n        right\n    } = el.getBoundingClientRect();\n    const {\n        top: pTop,\n        left: pLeft,\n        bottom: pBottom,\n        right: pRight\n    } = parentEl.getBoundingClientRect();\n\n    return top >= pTop && left >= pLeft && bottom <= pBottom && right <= pRight;\n};\n\n$.scrollTop = function scrollTop(element, pixels) {\n    requestAnimationFrame(() => {\n        element.scrollTop = pixels;\n    });\n};\n\n$.scrollbarSize = function scrollbarSize() {\n    if (!$.scrollBarSizeValue) {\n        $.scrollBarSizeValue = getScrollBarSize();\n    }\n    return $.scrollBarSizeValue;\n};\n\nfunction getScrollBarSize() {\n    // assume scrollbar width and height would be the same\n\n    // Create the measurement node\n    const scrollDiv = document.createElement('div');\n    $.style(scrollDiv, {\n        width: '100px',\n        height: '100px',\n        overflow: 'scroll',\n        position: 'absolute',\n        top: '-9999px'\n    });\n    document.body.appendChild(scrollDiv);\n\n    // Get the scrollbar width\n    const scrollbarWidth = scrollDiv.offsetWidth - scrollDiv.clientWidth;\n\n    // Delete the DIV\n    document.body.removeChild(scrollDiv);\n\n    return scrollbarWidth;\n}\n\n$.hasVerticalOverflow = function (element) {\n    return element.scrollHeight > element.offsetHeight + 10;\n};\n\n$.hasHorizontalOverflow = function (element) {\n    return element.scrollWidth > element.offsetWidth + 10;\n};\n\n$.measureTextWidth = function (text) {\n    const div = document.createElement('div');\n    div.style.position = 'absolute';\n    div.style.visibility = 'hidden';\n    div.style.height = 'auto';\n    div.style.width = 'auto';\n    div.style.whiteSpace = 'nowrap';\n    div.innerText = text;\n    document.body.appendChild(div);\n    return div.clientWidth + 1;\n};\n\n/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return value != null && (type == 'object' || type == 'function');\n}\n\nvar isObject_1 = isObject;\n\nvar commonjsGlobal = typeof window !== 'undefined' ? window : typeof global !== 'undefined' ? global : typeof self !== 'undefined' ? self : {};\n\nfunction commonjsRequire () {\n\tthrow new Error('Dynamic requires are not currently supported by rollup-plugin-commonjs');\n}\n\nfunction unwrapExports (x) {\n\treturn x && x.__esModule && Object.prototype.hasOwnProperty.call(x, 'default') ? x['default'] : x;\n}\n\nfunction createCommonjsModule(fn, module) {\n\treturn module = { exports: {} }, fn(module, module.exports), module.exports;\n}\n\n/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof commonjsGlobal == 'object' && commonjsGlobal && commonjsGlobal.Object === Object && commonjsGlobal;\n\nvar _freeGlobal = freeGlobal;\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = _freeGlobal || freeSelf || Function('return this')();\n\nvar _root = root;\n\n/**\n * Gets the timestamp of the number of milliseconds that have elapsed since\n * the Unix epoch (1 January 1970 00:00:00 UTC).\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Date\n * @returns {number} Returns the timestamp.\n * @example\n *\n * _.defer(function(stamp) {\n *   console.log(_.now() - stamp);\n * }, _.now());\n * // => Logs the number of milliseconds it took for the deferred invocation.\n */\nvar now = function() {\n  return _root.Date.now();\n};\n\nvar now_1 = now;\n\n/** Built-in value references. */\nvar Symbol = _root.Symbol;\n\nvar _Symbol = Symbol;\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/** Built-in value references. */\nvar symToStringTag = _Symbol ? _Symbol.toStringTag : undefined;\n\n/**\n * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the raw `toStringTag`.\n */\nfunction getRawTag(value) {\n  var isOwn = hasOwnProperty.call(value, symToStringTag),\n      tag = value[symToStringTag];\n\n  try {\n    value[symToStringTag] = undefined;\n  } catch (e) {}\n\n  var result = nativeObjectToString.call(value);\n  {\n    if (isOwn) {\n      value[symToStringTag] = tag;\n    } else {\n      delete value[symToStringTag];\n    }\n  }\n  return result;\n}\n\nvar _getRawTag = getRawTag;\n\n/** Used for built-in method references. */\nvar objectProto$1 = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString$1 = objectProto$1.toString;\n\n/**\n * Converts `value` to a string using `Object.prototype.toString`.\n *\n * @private\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n */\nfunction objectToString(value) {\n  return nativeObjectToString$1.call(value);\n}\n\nvar _objectToString = objectToString;\n\n/** `Object#toString` result references. */\nvar nullTag = '[object Null]',\n    undefinedTag = '[object Undefined]';\n\n/** Built-in value references. */\nvar symToStringTag$1 = _Symbol ? _Symbol.toStringTag : undefined;\n\n/**\n * The base implementation of `getTag` without fallbacks for buggy environments.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nfunction baseGetTag(value) {\n  if (value == null) {\n    return value === undefined ? undefinedTag : nullTag;\n  }\n  return (symToStringTag$1 && symToStringTag$1 in Object(value))\n    ? _getRawTag(value)\n    : _objectToString(value);\n}\n\nvar _baseGetTag = baseGetTag;\n\n/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return value != null && typeof value == 'object';\n}\n\nvar isObjectLike_1 = isObjectLike;\n\n/** `Object#toString` result references. */\nvar symbolTag = '[object Symbol]';\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike_1(value) && _baseGetTag(value) == symbolTag);\n}\n\nvar isSymbol_1 = isSymbol;\n\n/** Used as references for various `Number` constants. */\nvar NAN = 0 / 0;\n\n/** Used to match leading and trailing whitespace. */\nvar reTrim = /^\\s+|\\s+$/g;\n\n/** Used to detect bad signed hexadecimal string values. */\nvar reIsBadHex = /^[-+]0x[0-9a-f]+$/i;\n\n/** Used to detect binary string values. */\nvar reIsBinary = /^0b[01]+$/i;\n\n/** Used to detect octal string values. */\nvar reIsOctal = /^0o[0-7]+$/i;\n\n/** Built-in method references without a dependency on `root`. */\nvar freeParseInt = parseInt;\n\n/**\n * Converts `value` to a number.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to process.\n * @returns {number} Returns the number.\n * @example\n *\n * _.toNumber(3.2);\n * // => 3.2\n *\n * _.toNumber(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toNumber(Infinity);\n * // => Infinity\n *\n * _.toNumber('3.2');\n * // => 3.2\n */\nfunction toNumber(value) {\n  if (typeof value == 'number') {\n    return value;\n  }\n  if (isSymbol_1(value)) {\n    return NAN;\n  }\n  if (isObject_1(value)) {\n    var other = typeof value.valueOf == 'function' ? value.valueOf() : value;\n    value = isObject_1(other) ? (other + '') : other;\n  }\n  if (typeof value != 'string') {\n    return value === 0 ? value : +value;\n  }\n  value = value.replace(reTrim, '');\n  var isBinary = reIsBinary.test(value);\n  return (isBinary || reIsOctal.test(value))\n    ? freeParseInt(value.slice(2), isBinary ? 2 : 8)\n    : (reIsBadHex.test(value) ? NAN : +value);\n}\n\nvar toNumber_1 = toNumber;\n\n/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max,\n    nativeMin = Math.min;\n\n/**\n * Creates a debounced function that delays invoking `func` until after `wait`\n * milliseconds have elapsed since the last time the debounced function was\n * invoked. The debounced function comes with a `cancel` method to cancel\n * delayed `func` invocations and a `flush` method to immediately invoke them.\n * Provide `options` to indicate whether `func` should be invoked on the\n * leading and/or trailing edge of the `wait` timeout. The `func` is invoked\n * with the last arguments provided to the debounced function. Subsequent\n * calls to the debounced function return the result of the last `func`\n * invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the debounced function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.debounce` and `_.throttle`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to debounce.\n * @param {number} [wait=0] The number of milliseconds to delay.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=false]\n *  Specify invoking on the leading edge of the timeout.\n * @param {number} [options.maxWait]\n *  The maximum time `func` is allowed to be delayed before it's invoked.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new debounced function.\n * @example\n *\n * // Avoid costly calculations while the window size is in flux.\n * jQuery(window).on('resize', _.debounce(calculateLayout, 150));\n *\n * // Invoke `sendMail` when clicked, debouncing subsequent calls.\n * jQuery(element).on('click', _.debounce(sendMail, 300, {\n *   'leading': true,\n *   'trailing': false\n * }));\n *\n * // Ensure `batchLog` is invoked once after 1 second of debounced calls.\n * var debounced = _.debounce(batchLog, 250, { 'maxWait': 1000 });\n * var source = new EventSource('/stream');\n * jQuery(source).on('message', debounced);\n *\n * // Cancel the trailing debounced invocation.\n * jQuery(window).on('popstate', debounced.cancel);\n */\nfunction debounce(func, wait, options) {\n  var lastArgs,\n      lastThis,\n      maxWait,\n      result,\n      timerId,\n      lastCallTime,\n      lastInvokeTime = 0,\n      leading = false,\n      maxing = false,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  wait = toNumber_1(wait) || 0;\n  if (isObject_1(options)) {\n    leading = !!options.leading;\n    maxing = 'maxWait' in options;\n    maxWait = maxing ? nativeMax(toNumber_1(options.maxWait) || 0, wait) : maxWait;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n\n  function invokeFunc(time) {\n    var args = lastArgs,\n        thisArg = lastThis;\n\n    lastArgs = lastThis = undefined;\n    lastInvokeTime = time;\n    result = func.apply(thisArg, args);\n    return result;\n  }\n\n  function leadingEdge(time) {\n    // Reset any `maxWait` timer.\n    lastInvokeTime = time;\n    // Start the timer for the trailing edge.\n    timerId = setTimeout(timerExpired, wait);\n    // Invoke the leading edge.\n    return leading ? invokeFunc(time) : result;\n  }\n\n  function remainingWait(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime,\n        timeWaiting = wait - timeSinceLastCall;\n\n    return maxing\n      ? nativeMin(timeWaiting, maxWait - timeSinceLastInvoke)\n      : timeWaiting;\n  }\n\n  function shouldInvoke(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime;\n\n    // Either this is the first call, activity has stopped and we're at the\n    // trailing edge, the system time has gone backwards and we're treating\n    // it as the trailing edge, or we've hit the `maxWait` limit.\n    return (lastCallTime === undefined || (timeSinceLastCall >= wait) ||\n      (timeSinceLastCall < 0) || (maxing && timeSinceLastInvoke >= maxWait));\n  }\n\n  function timerExpired() {\n    var time = now_1();\n    if (shouldInvoke(time)) {\n      return trailingEdge(time);\n    }\n    // Restart the timer.\n    timerId = setTimeout(timerExpired, remainingWait(time));\n  }\n\n  function trailingEdge(time) {\n    timerId = undefined;\n\n    // Only invoke if we have `lastArgs` which means `func` has been\n    // debounced at least once.\n    if (trailing && lastArgs) {\n      return invokeFunc(time);\n    }\n    lastArgs = lastThis = undefined;\n    return result;\n  }\n\n  function cancel() {\n    if (timerId !== undefined) {\n      clearTimeout(timerId);\n    }\n    lastInvokeTime = 0;\n    lastArgs = lastCallTime = lastThis = timerId = undefined;\n  }\n\n  function flush() {\n    return timerId === undefined ? result : trailingEdge(now_1());\n  }\n\n  function debounced() {\n    var time = now_1(),\n        isInvoking = shouldInvoke(time);\n\n    lastArgs = arguments;\n    lastThis = this;\n    lastCallTime = time;\n\n    if (isInvoking) {\n      if (timerId === undefined) {\n        return leadingEdge(lastCallTime);\n      }\n      if (maxing) {\n        // Handle invocations in a tight loop.\n        timerId = setTimeout(timerExpired, wait);\n        return invokeFunc(lastCallTime);\n      }\n    }\n    if (timerId === undefined) {\n      timerId = setTimeout(timerExpired, wait);\n    }\n    return result;\n  }\n  debounced.cancel = cancel;\n  debounced.flush = flush;\n  return debounced;\n}\n\nvar debounce_1 = debounce;\n\n/** Error message constants. */\nvar FUNC_ERROR_TEXT$1 = 'Expected a function';\n\n/**\n * Creates a throttled function that only invokes `func` at most once per\n * every `wait` milliseconds. The throttled function comes with a `cancel`\n * method to cancel delayed `func` invocations and a `flush` method to\n * immediately invoke them. Provide `options` to indicate whether `func`\n * should be invoked on the leading and/or trailing edge of the `wait`\n * timeout. The `func` is invoked with the last arguments provided to the\n * throttled function. Subsequent calls to the throttled function return the\n * result of the last `func` invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the throttled function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.throttle` and `_.debounce`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to throttle.\n * @param {number} [wait=0] The number of milliseconds to throttle invocations to.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=true]\n *  Specify invoking on the leading edge of the timeout.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new throttled function.\n * @example\n *\n * // Avoid excessively updating the position while scrolling.\n * jQuery(window).on('scroll', _.throttle(updatePosition, 100));\n *\n * // Invoke `renewToken` when the click event is fired, but not more than once every 5 minutes.\n * var throttled = _.throttle(renewToken, 300000, { 'trailing': false });\n * jQuery(element).on('click', throttled);\n *\n * // Cancel the trailing throttled invocation.\n * jQuery(window).on('popstate', throttled.cancel);\n */\nfunction throttle(func, wait, options) {\n  var leading = true,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT$1);\n  }\n  if (isObject_1(options)) {\n    leading = 'leading' in options ? !!options.leading : leading;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n  return debounce_1(func, wait, {\n    'leading': leading,\n    'maxWait': wait,\n    'trailing': trailing\n  });\n}\n\nvar throttle_1 = throttle;\n\n/** `Object#toString` result references. */\nvar asyncTag = '[object AsyncFunction]',\n    funcTag = '[object Function]',\n    genTag = '[object GeneratorFunction]',\n    proxyTag = '[object Proxy]';\n\n/**\n * Checks if `value` is classified as a `Function` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a function, else `false`.\n * @example\n *\n * _.isFunction(_);\n * // => true\n *\n * _.isFunction(/abc/);\n * // => false\n */\nfunction isFunction(value) {\n  if (!isObject_1(value)) {\n    return false;\n  }\n  // The use of `Object#toString` avoids issues with the `typeof` operator\n  // in Safari 9 which returns 'object' for typed arrays and other constructors.\n  var tag = _baseGetTag(value);\n  return tag == funcTag || tag == genTag || tag == asyncTag || tag == proxyTag;\n}\n\nvar isFunction_1 = isFunction;\n\n/** Used to detect overreaching core-js shims. */\nvar coreJsData = _root['__core-js_shared__'];\n\nvar _coreJsData = coreJsData;\n\n/** Used to detect methods masquerading as native. */\nvar maskSrcKey = (function() {\n  var uid = /[^.]+$/.exec(_coreJsData && _coreJsData.keys && _coreJsData.keys.IE_PROTO || '');\n  return uid ? ('Symbol(src)_1.' + uid) : '';\n}());\n\n/**\n * Checks if `func` has its source masked.\n *\n * @private\n * @param {Function} func The function to check.\n * @returns {boolean} Returns `true` if `func` is masked, else `false`.\n */\nfunction isMasked(func) {\n  return !!maskSrcKey && (maskSrcKey in func);\n}\n\nvar _isMasked = isMasked;\n\n/** Used for built-in method references. */\nvar funcProto = Function.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/**\n * Converts `func` to its source code.\n *\n * @private\n * @param {Function} func The function to convert.\n * @returns {string} Returns the source code.\n */\nfunction toSource(func) {\n  if (func != null) {\n    try {\n      return funcToString.call(func);\n    } catch (e) {}\n    try {\n      return (func + '');\n    } catch (e) {}\n  }\n  return '';\n}\n\nvar _toSource = toSource;\n\n/**\n * Used to match `RegExp`\n * [syntax characters](http://ecma-international.org/ecma-262/7.0/#sec-patterns).\n */\nvar reRegExpChar = /[\\\\^$.*+?()[\\]{}|]/g;\n\n/** Used to detect host constructors (Safari). */\nvar reIsHostCtor = /^\\[object .+?Constructor\\]$/;\n\n/** Used for built-in method references. */\nvar funcProto$1 = Function.prototype,\n    objectProto$2 = Object.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString$1 = funcProto$1.toString;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty$1 = objectProto$2.hasOwnProperty;\n\n/** Used to detect if a method is native. */\nvar reIsNative = RegExp('^' +\n  funcToString$1.call(hasOwnProperty$1).replace(reRegExpChar, '\\\\$&')\n  .replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g, '$1.*?') + '$'\n);\n\n/**\n * The base implementation of `_.isNative` without bad shim checks.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a native function,\n *  else `false`.\n */\nfunction baseIsNative(value) {\n  if (!isObject_1(value) || _isMasked(value)) {\n    return false;\n  }\n  var pattern = isFunction_1(value) ? reIsNative : reIsHostCtor;\n  return pattern.test(_toSource(value));\n}\n\nvar _baseIsNative = baseIsNative;\n\n/**\n * Gets the value at `key` of `object`.\n *\n * @private\n * @param {Object} [object] The object to query.\n * @param {string} key The key of the property to get.\n * @returns {*} Returns the property value.\n */\nfunction getValue(object, key) {\n  return object == null ? undefined : object[key];\n}\n\nvar _getValue = getValue;\n\n/**\n * Gets the native function at `key` of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {string} key The key of the method to get.\n * @returns {*} Returns the function if it's native, else `undefined`.\n */\nfunction getNative(object, key) {\n  var value = _getValue(object, key);\n  return _baseIsNative(value) ? value : undefined;\n}\n\nvar _getNative = getNative;\n\n/* Built-in method references that are verified to be native. */\nvar nativeCreate = _getNative(Object, 'create');\n\nvar _nativeCreate = nativeCreate;\n\n/**\n * Removes all key-value entries from the hash.\n *\n * @private\n * @name clear\n * @memberOf Hash\n */\nfunction hashClear() {\n  this.__data__ = _nativeCreate ? _nativeCreate(null) : {};\n  this.size = 0;\n}\n\nvar _hashClear = hashClear;\n\n/**\n * Removes `key` and its value from the hash.\n *\n * @private\n * @name delete\n * @memberOf Hash\n * @param {Object} hash The hash to modify.\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction hashDelete(key) {\n  var result = this.has(key) && delete this.__data__[key];\n  this.size -= result ? 1 : 0;\n  return result;\n}\n\nvar _hashDelete = hashDelete;\n\n/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/** Used for built-in method references. */\nvar objectProto$3 = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty$2 = objectProto$3.hasOwnProperty;\n\n/**\n * Gets the hash value for `key`.\n *\n * @private\n * @name get\n * @memberOf Hash\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction hashGet(key) {\n  var data = this.__data__;\n  if (_nativeCreate) {\n    var result = data[key];\n    return result === HASH_UNDEFINED ? undefined : result;\n  }\n  return hasOwnProperty$2.call(data, key) ? data[key] : undefined;\n}\n\nvar _hashGet = hashGet;\n\n/** Used for built-in method references. */\nvar objectProto$4 = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty$3 = objectProto$4.hasOwnProperty;\n\n/**\n * Checks if a hash value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf Hash\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction hashHas(key) {\n  var data = this.__data__;\n  return _nativeCreate ? (data[key] !== undefined) : hasOwnProperty$3.call(data, key);\n}\n\nvar _hashHas = hashHas;\n\n/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED$1 = '__lodash_hash_undefined__';\n\n/**\n * Sets the hash `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf Hash\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the hash instance.\n */\nfunction hashSet(key, value) {\n  var data = this.__data__;\n  this.size += this.has(key) ? 0 : 1;\n  data[key] = (_nativeCreate && value === undefined) ? HASH_UNDEFINED$1 : value;\n  return this;\n}\n\nvar _hashSet = hashSet;\n\n/**\n * Creates a hash object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction Hash(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `Hash`.\nHash.prototype.clear = _hashClear;\nHash.prototype['delete'] = _hashDelete;\nHash.prototype.get = _hashGet;\nHash.prototype.has = _hashHas;\nHash.prototype.set = _hashSet;\n\nvar _Hash = Hash;\n\n/**\n * Removes all key-value entries from the list cache.\n *\n * @private\n * @name clear\n * @memberOf ListCache\n */\nfunction listCacheClear() {\n  this.__data__ = [];\n  this.size = 0;\n}\n\nvar _listCacheClear = listCacheClear;\n\n/**\n * Performs a\n * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * comparison between two values to determine if they are equivalent.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n * @example\n *\n * var object = { 'a': 1 };\n * var other = { 'a': 1 };\n *\n * _.eq(object, object);\n * // => true\n *\n * _.eq(object, other);\n * // => false\n *\n * _.eq('a', 'a');\n * // => true\n *\n * _.eq('a', Object('a'));\n * // => false\n *\n * _.eq(NaN, NaN);\n * // => true\n */\nfunction eq(value, other) {\n  return value === other || (value !== value && other !== other);\n}\n\nvar eq_1 = eq;\n\n/**\n * Gets the index at which the `key` is found in `array` of key-value pairs.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} key The key to search for.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction assocIndexOf(array, key) {\n  var length = array.length;\n  while (length--) {\n    if (eq_1(array[length][0], key)) {\n      return length;\n    }\n  }\n  return -1;\n}\n\nvar _assocIndexOf = assocIndexOf;\n\n/** Used for built-in method references. */\nvar arrayProto = Array.prototype;\n\n/** Built-in value references. */\nvar splice = arrayProto.splice;\n\n/**\n * Removes `key` and its value from the list cache.\n *\n * @private\n * @name delete\n * @memberOf ListCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction listCacheDelete(key) {\n  var data = this.__data__,\n      index = _assocIndexOf(data, key);\n\n  if (index < 0) {\n    return false;\n  }\n  var lastIndex = data.length - 1;\n  if (index == lastIndex) {\n    data.pop();\n  } else {\n    splice.call(data, index, 1);\n  }\n  --this.size;\n  return true;\n}\n\nvar _listCacheDelete = listCacheDelete;\n\n/**\n * Gets the list cache value for `key`.\n *\n * @private\n * @name get\n * @memberOf ListCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction listCacheGet(key) {\n  var data = this.__data__,\n      index = _assocIndexOf(data, key);\n\n  return index < 0 ? undefined : data[index][1];\n}\n\nvar _listCacheGet = listCacheGet;\n\n/**\n * Checks if a list cache value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf ListCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction listCacheHas(key) {\n  return _assocIndexOf(this.__data__, key) > -1;\n}\n\nvar _listCacheHas = listCacheHas;\n\n/**\n * Sets the list cache `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf ListCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the list cache instance.\n */\nfunction listCacheSet(key, value) {\n  var data = this.__data__,\n      index = _assocIndexOf(data, key);\n\n  if (index < 0) {\n    ++this.size;\n    data.push([key, value]);\n  } else {\n    data[index][1] = value;\n  }\n  return this;\n}\n\nvar _listCacheSet = listCacheSet;\n\n/**\n * Creates an list cache object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction ListCache(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `ListCache`.\nListCache.prototype.clear = _listCacheClear;\nListCache.prototype['delete'] = _listCacheDelete;\nListCache.prototype.get = _listCacheGet;\nListCache.prototype.has = _listCacheHas;\nListCache.prototype.set = _listCacheSet;\n\nvar _ListCache = ListCache;\n\n/* Built-in method references that are verified to be native. */\nvar Map = _getNative(_root, 'Map');\n\nvar _Map = Map;\n\n/**\n * Removes all key-value entries from the map.\n *\n * @private\n * @name clear\n * @memberOf MapCache\n */\nfunction mapCacheClear() {\n  this.size = 0;\n  this.__data__ = {\n    'hash': new _Hash,\n    'map': new (_Map || _ListCache),\n    'string': new _Hash\n  };\n}\n\nvar _mapCacheClear = mapCacheClear;\n\n/**\n * Checks if `value` is suitable for use as unique object key.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is suitable, else `false`.\n */\nfunction isKeyable(value) {\n  var type = typeof value;\n  return (type == 'string' || type == 'number' || type == 'symbol' || type == 'boolean')\n    ? (value !== '__proto__')\n    : (value === null);\n}\n\nvar _isKeyable = isKeyable;\n\n/**\n * Gets the data for `map`.\n *\n * @private\n * @param {Object} map The map to query.\n * @param {string} key The reference key.\n * @returns {*} Returns the map data.\n */\nfunction getMapData(map, key) {\n  var data = map.__data__;\n  return _isKeyable(key)\n    ? data[typeof key == 'string' ? 'string' : 'hash']\n    : data.map;\n}\n\nvar _getMapData = getMapData;\n\n/**\n * Removes `key` and its value from the map.\n *\n * @private\n * @name delete\n * @memberOf MapCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction mapCacheDelete(key) {\n  var result = _getMapData(this, key)['delete'](key);\n  this.size -= result ? 1 : 0;\n  return result;\n}\n\nvar _mapCacheDelete = mapCacheDelete;\n\n/**\n * Gets the map value for `key`.\n *\n * @private\n * @name get\n * @memberOf MapCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction mapCacheGet(key) {\n  return _getMapData(this, key).get(key);\n}\n\nvar _mapCacheGet = mapCacheGet;\n\n/**\n * Checks if a map value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf MapCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction mapCacheHas(key) {\n  return _getMapData(this, key).has(key);\n}\n\nvar _mapCacheHas = mapCacheHas;\n\n/**\n * Sets the map `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf MapCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the map cache instance.\n */\nfunction mapCacheSet(key, value) {\n  var data = _getMapData(this, key),\n      size = data.size;\n\n  data.set(key, value);\n  this.size += data.size == size ? 0 : 1;\n  return this;\n}\n\nvar _mapCacheSet = mapCacheSet;\n\n/**\n * Creates a map cache object to store key-value pairs.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction MapCache(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `MapCache`.\nMapCache.prototype.clear = _mapCacheClear;\nMapCache.prototype['delete'] = _mapCacheDelete;\nMapCache.prototype.get = _mapCacheGet;\nMapCache.prototype.has = _mapCacheHas;\nMapCache.prototype.set = _mapCacheSet;\n\nvar _MapCache = MapCache;\n\n/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED$2 = '__lodash_hash_undefined__';\n\n/**\n * Adds `value` to the array cache.\n *\n * @private\n * @name add\n * @memberOf SetCache\n * @alias push\n * @param {*} value The value to cache.\n * @returns {Object} Returns the cache instance.\n */\nfunction setCacheAdd(value) {\n  this.__data__.set(value, HASH_UNDEFINED$2);\n  return this;\n}\n\nvar _setCacheAdd = setCacheAdd;\n\n/**\n * Checks if `value` is in the array cache.\n *\n * @private\n * @name has\n * @memberOf SetCache\n * @param {*} value The value to search for.\n * @returns {number} Returns `true` if `value` is found, else `false`.\n */\nfunction setCacheHas(value) {\n  return this.__data__.has(value);\n}\n\nvar _setCacheHas = setCacheHas;\n\n/**\n *\n * Creates an array cache object to store unique values.\n *\n * @private\n * @constructor\n * @param {Array} [values] The values to cache.\n */\nfunction SetCache(values) {\n  var index = -1,\n      length = values == null ? 0 : values.length;\n\n  this.__data__ = new _MapCache;\n  while (++index < length) {\n    this.add(values[index]);\n  }\n}\n\n// Add methods to `SetCache`.\nSetCache.prototype.add = SetCache.prototype.push = _setCacheAdd;\nSetCache.prototype.has = _setCacheHas;\n\nvar _SetCache = SetCache;\n\n/**\n * The base implementation of `_.findIndex` and `_.findLastIndex` without\n * support for iteratee shorthands.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {Function} predicate The function invoked per iteration.\n * @param {number} fromIndex The index to search from.\n * @param {boolean} [fromRight] Specify iterating from right to left.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction baseFindIndex(array, predicate, fromIndex, fromRight) {\n  var length = array.length,\n      index = fromIndex + (fromRight ? 1 : -1);\n\n  while ((fromRight ? index-- : ++index < length)) {\n    if (predicate(array[index], index, array)) {\n      return index;\n    }\n  }\n  return -1;\n}\n\nvar _baseFindIndex = baseFindIndex;\n\n/**\n * The base implementation of `_.isNaN` without support for number objects.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is `NaN`, else `false`.\n */\nfunction baseIsNaN(value) {\n  return value !== value;\n}\n\nvar _baseIsNaN = baseIsNaN;\n\n/**\n * A specialized version of `_.indexOf` which performs strict equality\n * comparisons of values, i.e. `===`.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} value The value to search for.\n * @param {number} fromIndex The index to search from.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction strictIndexOf(array, value, fromIndex) {\n  var index = fromIndex - 1,\n      length = array.length;\n\n  while (++index < length) {\n    if (array[index] === value) {\n      return index;\n    }\n  }\n  return -1;\n}\n\nvar _strictIndexOf = strictIndexOf;\n\n/**\n * The base implementation of `_.indexOf` without `fromIndex` bounds checks.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} value The value to search for.\n * @param {number} fromIndex The index to search from.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction baseIndexOf(array, value, fromIndex) {\n  return value === value\n    ? _strictIndexOf(array, value, fromIndex)\n    : _baseFindIndex(array, _baseIsNaN, fromIndex);\n}\n\nvar _baseIndexOf = baseIndexOf;\n\n/**\n * A specialized version of `_.includes` for arrays without support for\n * specifying an index to search from.\n *\n * @private\n * @param {Array} [array] The array to inspect.\n * @param {*} target The value to search for.\n * @returns {boolean} Returns `true` if `target` is found, else `false`.\n */\nfunction arrayIncludes(array, value) {\n  var length = array == null ? 0 : array.length;\n  return !!length && _baseIndexOf(array, value, 0) > -1;\n}\n\nvar _arrayIncludes = arrayIncludes;\n\n/**\n * This function is like `arrayIncludes` except that it accepts a comparator.\n *\n * @private\n * @param {Array} [array] The array to inspect.\n * @param {*} target The value to search for.\n * @param {Function} comparator The comparator invoked per element.\n * @returns {boolean} Returns `true` if `target` is found, else `false`.\n */\nfunction arrayIncludesWith(array, value, comparator) {\n  var index = -1,\n      length = array == null ? 0 : array.length;\n\n  while (++index < length) {\n    if (comparator(value, array[index])) {\n      return true;\n    }\n  }\n  return false;\n}\n\nvar _arrayIncludesWith = arrayIncludesWith;\n\n/**\n * Checks if a `cache` value for `key` exists.\n *\n * @private\n * @param {Object} cache The cache to query.\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction cacheHas(cache, key) {\n  return cache.has(key);\n}\n\nvar _cacheHas = cacheHas;\n\n/* Built-in method references that are verified to be native. */\nvar Set = _getNative(_root, 'Set');\n\nvar _Set = Set;\n\n/**\n * This method returns `undefined`.\n *\n * @static\n * @memberOf _\n * @since 2.3.0\n * @category Util\n * @example\n *\n * _.times(2, _.noop);\n * // => [undefined, undefined]\n */\nfunction noop() {\n  // No operation performed.\n}\n\nvar noop_1 = noop;\n\n/**\n * Converts `set` to an array of its values.\n *\n * @private\n * @param {Object} set The set to convert.\n * @returns {Array} Returns the values.\n */\nfunction setToArray(set) {\n  var index = -1,\n      result = Array(set.size);\n\n  set.forEach(function(value) {\n    result[++index] = value;\n  });\n  return result;\n}\n\nvar _setToArray = setToArray;\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0;\n\n/**\n * Creates a set object of `values`.\n *\n * @private\n * @param {Array} values The values to add to the set.\n * @returns {Object} Returns the new set.\n */\nvar createSet = !(_Set && (1 / _setToArray(new _Set([,-0]))[1]) == INFINITY) ? noop_1 : function(values) {\n  return new _Set(values);\n};\n\nvar _createSet = createSet;\n\n/** Used as the size to enable large array optimizations. */\nvar LARGE_ARRAY_SIZE = 200;\n\n/**\n * The base implementation of `_.uniqBy` without support for iteratee shorthands.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {Function} [iteratee] The iteratee invoked per element.\n * @param {Function} [comparator] The comparator invoked per element.\n * @returns {Array} Returns the new duplicate free array.\n */\nfunction baseUniq(array, iteratee, comparator) {\n  var index = -1,\n      includes = _arrayIncludes,\n      length = array.length,\n      isCommon = true,\n      result = [],\n      seen = result;\n\n  if (comparator) {\n    isCommon = false;\n    includes = _arrayIncludesWith;\n  }\n  else if (length >= LARGE_ARRAY_SIZE) {\n    var set = iteratee ? null : _createSet(array);\n    if (set) {\n      return _setToArray(set);\n    }\n    isCommon = false;\n    includes = _cacheHas;\n    seen = new _SetCache;\n  }\n  else {\n    seen = iteratee ? [] : result;\n  }\n  outer:\n  while (++index < length) {\n    var value = array[index],\n        computed = iteratee ? iteratee(value) : value;\n\n    value = (comparator || value !== 0) ? value : 0;\n    if (isCommon && computed === computed) {\n      var seenIndex = seen.length;\n      while (seenIndex--) {\n        if (seen[seenIndex] === computed) {\n          continue outer;\n        }\n      }\n      if (iteratee) {\n        seen.push(computed);\n      }\n      result.push(value);\n    }\n    else if (!includes(seen, computed, comparator)) {\n      if (seen !== result) {\n        seen.push(computed);\n      }\n      result.push(value);\n    }\n  }\n  return result;\n}\n\nvar _baseUniq = baseUniq;\n\n/**\n * Creates a duplicate-free version of an array, using\n * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * for equality comparisons, in which only the first occurrence of each element\n * is kept. The order of result values is determined by the order they occur\n * in the array.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Array\n * @param {Array} array The array to inspect.\n * @returns {Array} Returns the new duplicate free array.\n * @example\n *\n * _.uniq([2, 1, 2]);\n * // => [2, 1]\n */\nfunction uniq(array) {\n  return (array && array.length) ? _baseUniq(array) : [];\n}\n\nvar uniq_1 = uniq;\n\nfunction camelCaseToDash(str) {\n    return str.replace(/([A-Z])/g, (g) => `-${g[0].toLowerCase()}`);\n}\n\nfunction makeDataAttributeString(props) {\n    const keys = Object.keys(props);\n\n    return keys\n        .map((key) => {\n            const _key = camelCaseToDash(key);\n            const val = props[key];\n\n            if (val === undefined) return '';\n            return `data-${_key}=\"${val}\" `;\n        })\n        .join('')\n        .trim();\n}\n\nfunction copyTextToClipboard(text) {\n    // https://stackoverflow.com/a/30810322/5353542\n    var textArea = document.createElement('textarea');\n\n    //\n    // *** This styling is an extra step which is likely not required. ***\n    //\n    // Why is it here? To ensure:\n    // 1. the element is able to have focus and selection.\n    // 2. if element was to flash render it has minimal visual impact.\n    // 3. less flakyness with selection and copying which **might** occur if\n    //    the textarea element is not visible.\n    //\n    // The likelihood is the element won't even render, not even a flash,\n    // so some of these are just precautions. However in IE the element\n    // is visible whilst the popup box asking the user for permission for\n    // the web page to copy to the clipboard.\n    //\n\n    // Place in top-left corner of screen regardless of scroll position.\n    textArea.style.position = 'fixed';\n    textArea.style.top = 0;\n    textArea.style.left = 0;\n\n    // Ensure it has a small width and height. Setting to 1px / 1em\n    // doesn't work as this gives a negative w/h on some browsers.\n    textArea.style.width = '2em';\n    textArea.style.height = '2em';\n\n    // We don't need padding, reducing the size if it does flash render.\n    textArea.style.padding = 0;\n\n    // Clean up any borders.\n    textArea.style.border = 'none';\n    textArea.style.outline = 'none';\n    textArea.style.boxShadow = 'none';\n\n    // Avoid flash of white box if rendered for any reason.\n    textArea.style.background = 'transparent';\n\n    textArea.value = text;\n\n    document.body.appendChild(textArea);\n\n    textArea.select();\n\n    try {\n        document.execCommand('copy');\n    } catch (err) {\n        console.log('Oops, unable to copy');\n    }\n\n    document.body.removeChild(textArea);\n}\n\nfunction isNumeric(val) {\n    return !isNaN(val);\n}\n\nlet throttle$1 = throttle_1;\n\nlet debounce$1 = debounce_1;\n\nfunction nextTick(fn, context = null) {\n    return (...args) => {\n        return new Promise(resolve => {\n            const execute = () => {\n                const out = fn.apply(context, args);\n                resolve(out);\n            };\n            setTimeout(execute);\n        });\n    };\n}\nfunction linkProperties(target, source, properties) {\n    const props = properties.reduce((acc, prop) => {\n        acc[prop] = {\n            get() {\n                return source[prop];\n            }\n        };\n        return acc;\n    }, {});\n    Object.defineProperties(target, props);\n}\nfunction isSet(val) {\n    return val !== undefined || val !== null;\n}\n\nfunction notSet(val) {\n    return !isSet(val);\n}\n\nfunction isNumber(val) {\n    return !isNaN(val);\n}\n\nfunction ensureArray(val) {\n    if (!Array.isArray(val)) {\n        return [val];\n    }\n    return val;\n}\n\nfunction uniq$1(arr) {\n    return uniq_1(arr);\n}\n\nfunction numberSortAsc(a, b) {\n    return a - b;\n}\nfunction stripHTML(html) {\n    return html.replace(/<[^>]*>/g, '');\n}\nfunction format(str, args) {\n    if (!str) return str;\n\n    Object.keys(args).forEach(arg => {\n        let regex = new RegExp(`{(${arg})}`, 'g');\n        str = str.replace(regex, args[arg]);\n    });\n\n    return str;\n}\n\nclass DataManager {\n    constructor(options) {\n        this.options = options;\n        this.sortRows = nextTick(this.sortRows, this);\n        this.switchColumn = nextTick(this.switchColumn, this);\n        this.removeColumn = nextTick(this.removeColumn, this);\n        this.options.filterRows = nextTick(this.options.filterRows, this);\n    }\n\n    init(data, columns) {\n        if (!data) {\n            data = this.options.data;\n        }\n        if (columns) {\n            this.options.columns = columns;\n        }\n\n        this.data = data;\n\n        this.rowCount = 0;\n        this.columns = [];\n        this.rows = [];\n\n        this.prepareColumns();\n        this.prepareRows();\n        this.prepareTreeRows();\n        this.prepareRowView();\n        this.prepareNumericColumns();\n    }\n\n    // computed property\n    get currentSort() {\n        const col = this.columns.find(col => col.sortOrder !== 'none');\n        return col || {\n            colIndex: -1,\n            sortOrder: 'none'\n        };\n    }\n\n    prepareColumns() {\n        this.columns = [];\n        this.validateColumns();\n        this.prepareDefaultColumns();\n        this.prepareHeader();\n    }\n\n    prepareDefaultColumns() {\n        if (this.options.checkboxColumn && !this.hasColumnById('_checkbox')) {\n            const cell = {\n                id: '_checkbox',\n                content: this.getCheckboxHTML(),\n                editable: false,\n                resizable: false,\n                sortable: false,\n                focusable: false,\n                dropdown: false,\n                width: 32\n            };\n            this.columns.push(cell);\n        }\n\n        if (this.options.serialNoColumn && !this.hasColumnById('_rowIndex')) {\n            let cell = {\n                id: '_rowIndex',\n                content: '',\n                align: 'center',\n                editable: false,\n                resizable: false,\n                focusable: false,\n                dropdown: false\n            };\n\n            this.columns.push(cell);\n        }\n    }\n\n    prepareHeader() {\n        let columns = this.columns.concat(this.options.columns);\n        const baseCell = {\n            isHeader: 1,\n            editable: true,\n            sortable: true,\n            resizable: true,\n            focusable: true,\n            dropdown: true,\n            width: null,\n            format: (value) => {\n                if (value === null || value === undefined) {\n                    return '';\n                }\n                return value + '';\n            }\n        };\n\n        this.columns = columns\n            .map((cell, i) => this.prepareCell(cell, i))\n            .map(col => Object.assign({}, baseCell, col))\n            .map(col => {\n                col.content = col.content || col.name || '';\n                col.id = col.id || col.content;\n                return col;\n            });\n    }\n\n    prepareCell(content, i) {\n        const cell = {\n            content: '',\n            sortOrder: 'none',\n            colIndex: i,\n            column: this.columns[i]\n        };\n\n        if (content !== null && typeof content === 'object') {\n            // passed as column/header\n            Object.assign(cell, content);\n        } else {\n            cell.content = content;\n        }\n\n        return cell;\n    }\n\n    prepareNumericColumns() {\n        const row0 = this.getRow(0);\n        if (!row0) return;\n        this.columns = this.columns.map((column, i) => {\n\n            const cellValue = row0[i].content;\n            if (!column.align && isNumeric(cellValue)) {\n                column.align = 'right';\n            }\n\n            return column;\n        });\n    }\n\n    prepareRows() {\n        this.validateData(this.data);\n\n        this.rows = this.data.map((d, i) => {\n            const index = this._getNextRowCount();\n\n            let row = [];\n            let meta = {\n                rowIndex: index\n            };\n\n            if (Array.isArray(d)) {\n                // row is an array\n                if (this.options.checkboxColumn) {\n                    row.push(this.getCheckboxHTML());\n                }\n                if (this.options.serialNoColumn) {\n                    row.push((index + 1) + '');\n                }\n                row = row.concat(d);\n\n                while (row.length < this.columns.length) {\n                    row.push('');\n                }\n\n            } else {\n                // row is an object\n                for (let col of this.columns) {\n                    if (col.id === '_checkbox') {\n                        row.push(this.getCheckboxHTML());\n                    } else if (col.id === '_rowIndex') {\n                        row.push((index + 1) + '');\n                    } else {\n                        row.push(d[col.id]);\n                    }\n                }\n\n                meta.indent = d.indent || 0;\n            }\n\n            return this.prepareRow(row, meta);\n        });\n    }\n\n    prepareTreeRows() {\n        this.rows.forEach((row, i) => {\n            if (isNumber(row.meta.indent)) {\n                // if (i === 36) debugger;\n                const nextRow = this.getRow(i + 1);\n                row.meta.isLeaf = !nextRow ||\n                    notSet(nextRow.meta.indent) ||\n                    nextRow.meta.indent <= row.meta.indent;\n                row.meta.isTreeNodeClose = false;\n            }\n        });\n    }\n\n    prepareRowView() {\n        // This is order in which rows will be rendered in the table.\n        // When sorting happens, only this.rowViewOrder will change\n        // and not the original this.rows\n        this.rowViewOrder = this.rows.map(row => row.meta.rowIndex);\n    }\n\n    prepareRow(row, meta) {\n        const baseRowCell = {\n            rowIndex: meta.rowIndex,\n            indent: meta.indent\n        };\n\n        row = row\n            .map((cell, i) => this.prepareCell(cell, i))\n            .map(cell => Object.assign({}, baseRowCell, cell));\n\n        // monkey patched in array object\n        row.meta = meta;\n        return row;\n    }\n\n    validateColumns() {\n        const columns = this.options.columns;\n        if (!Array.isArray(columns)) {\n            throw new DataError('`columns` must be an array');\n        }\n\n        columns.forEach((column, i) => {\n            if (typeof column !== 'string' && typeof column !== 'object') {\n                throw new DataError(`column \"${i}\" must be a string or an object`);\n            }\n        });\n    }\n\n    validateData(data) {\n        if (Array.isArray(data) &&\n            (data.length === 0 || Array.isArray(data[0]) || typeof data[0] === 'object')) {\n            return true;\n        }\n        throw new DataError('`data` must be an array of arrays or objects');\n    }\n\n    appendRows(rows) {\n        this.validateData(rows);\n\n        this.rows.push(...this.prepareRows(rows));\n    }\n\n    sortRows(colIndex, sortOrder = 'none') {\n        colIndex = +colIndex;\n\n        // reset sortOrder and update for colIndex\n        this.getColumns()\n            .map(col => {\n                if (col.colIndex === colIndex) {\n                    col.sortOrder = sortOrder;\n                } else {\n                    col.sortOrder = 'none';\n                }\n            });\n\n        this._sortRows(colIndex, sortOrder);\n    }\n\n    _sortRows(colIndex, sortOrder) {\n\n        if (this.currentSort.colIndex === colIndex) {\n            // reverse the array if only sortOrder changed\n            if (\n                (this.currentSort.sortOrder === 'asc' && sortOrder === 'desc') ||\n                (this.currentSort.sortOrder === 'desc' && sortOrder === 'asc')\n            ) {\n                this.reverseArray(this.rowViewOrder);\n                this.currentSort.sortOrder = sortOrder;\n                return;\n            }\n        }\n\n        this.rowViewOrder.sort((a, b) => {\n            const aIndex = a;\n            const bIndex = b;\n\n            let aContent = this.getCell(colIndex, a).content;\n            let bContent = this.getCell(colIndex, b).content;\n            aContent = aContent == null ? '' : aContent;\n            bContent = bContent == null ? '' : bContent;\n\n            if (sortOrder === 'none') {\n                return aIndex - bIndex;\n            } else if (sortOrder === 'asc') {\n                if (aContent < bContent) return -1;\n                if (aContent > bContent) return 1;\n                if (aContent === bContent) return 0;\n            } else if (sortOrder === 'desc') {\n                if (aContent < bContent) return 1;\n                if (aContent > bContent) return -1;\n                if (aContent === bContent) return 0;\n            }\n            return 0;\n        });\n\n        if (this.hasColumnById('_rowIndex')) {\n            // update row index\n            const srNoColIndex = this.getColumnIndexById('_rowIndex');\n            this.rows.forEach((row, index) => {\n                const viewIndex = this.rowViewOrder.indexOf(index);\n                const cell = row[srNoColIndex];\n                cell.content = (viewIndex + 1) + '';\n            });\n        }\n    }\n\n    reverseArray(array) {\n        let left = null;\n        let right = null;\n        let length = array.length;\n\n        for (left = 0, right = length - 1; left < right; left += 1, right -= 1) {\n            const temporary = array[left];\n\n            array[left] = array[right];\n            array[right] = temporary;\n        }\n    }\n\n    switchColumn(index1, index2) {\n        // update columns\n        const temp = this.columns[index1];\n        this.columns[index1] = this.columns[index2];\n        this.columns[index2] = temp;\n\n        this.columns[index1].colIndex = index1;\n        this.columns[index2].colIndex = index2;\n\n        // update rows\n        this.rows.forEach(row => {\n            const newCell1 = Object.assign({}, row[index1], {\n                colIndex: index2\n            });\n            const newCell2 = Object.assign({}, row[index2], {\n                colIndex: index1\n            });\n\n            row[index2] = newCell1;\n            row[index1] = newCell2;\n        });\n    }\n\n    removeColumn(index) {\n        index = +index;\n        const filter = cell => cell.colIndex !== index;\n        const map = (cell, i) => Object.assign({}, cell, {\n            colIndex: i\n        });\n        // update columns\n        this.columns = this.columns\n            .filter(filter)\n            .map(map);\n\n        // update rows\n        this.rows.forEach(row => {\n            // remove cell\n            row.splice(index, 1);\n            // update colIndex\n            row.forEach((cell, i) => {\n                cell.colIndex = i;\n            });\n        });\n    }\n\n    updateRow(row, rowIndex) {\n        if (row.length < this.columns.length) {\n            if (this.hasColumnById('_rowIndex')) {\n                const val = (rowIndex + 1) + '';\n\n                row = [val].concat(row);\n            }\n\n            if (this.hasColumnById('_checkbox')) {\n                const val = '<input type=\"checkbox\" />';\n\n                row = [val].concat(row);\n            }\n        }\n\n        const _row = this.prepareRow(row, {rowIndex});\n        const index = this.rows.findIndex(row => row[0].rowIndex === rowIndex);\n        this.rows[index] = _row;\n\n        return _row;\n    }\n\n    updateCell(colIndex, rowIndex, options) {\n        let cell;\n        if (typeof colIndex === 'object') {\n            // cell object was passed,\n            // must have colIndex, rowIndex\n            cell = colIndex;\n            colIndex = cell.colIndex;\n            rowIndex = cell.rowIndex;\n            // the object passed must be merged with original cell\n            options = cell;\n        }\n        cell = this.getCell(colIndex, rowIndex);\n\n        // mutate object directly\n        for (let key in options) {\n            const newVal = options[key];\n            if (newVal !== undefined) {\n                cell[key] = newVal;\n            }\n        }\n\n        return cell;\n    }\n\n    updateColumn(colIndex, keyValPairs) {\n        const column = this.getColumn(colIndex);\n        for (let key in keyValPairs) {\n            const newVal = keyValPairs[key];\n            if (newVal !== undefined) {\n                column[key] = newVal;\n            }\n        }\n        return column;\n    }\n\n    filterRows(filters) {\n        return this.options.filterRows(this.rows, filters)\n            .then(result => {\n                if (!result) {\n                    result = this.getAllRowIndices();\n                }\n\n                if (!result.then) {\n                    result = Promise.resolve(result);\n                }\n\n                return result.then(rowsToShow => {\n                    this._filteredRows = rowsToShow;\n\n                    const rowsToHide = this.getAllRowIndices()\n                        .filter(index => !rowsToShow.includes(index));\n\n                    return {\n                        rowsToHide,\n                        rowsToShow\n                    };\n                });\n            });\n    }\n\n    getFilteredRowIndices() {\n        return this._filteredRows || this.getAllRowIndices();\n    }\n\n    getAllRowIndices() {\n        return this.rows.map(row => row.meta.rowIndex);\n    }\n\n    getRowCount() {\n        return this.rowCount;\n    }\n\n    _getNextRowCount() {\n        const val = this.rowCount;\n\n        this.rowCount++;\n        return val;\n    }\n\n    getRows(start, end) {\n        return this.rows.slice(start, end);\n    }\n\n    getRowsForView(start, end) {\n        const rows = this.rowViewOrder.map(i => this.rows[i]);\n        return rows.slice(start, end);\n    }\n\n    getColumns(skipStandardColumns) {\n        let columns = this.columns;\n\n        if (skipStandardColumns) {\n            columns = columns.slice(this.getStandardColumnCount());\n        }\n\n        return columns;\n    }\n\n    getStandardColumnCount() {\n        if (this.options.checkboxColumn && this.options.serialNoColumn) {\n            return 2;\n        }\n\n        if (this.options.checkboxColumn || this.options.serialNoColumn) {\n            return 1;\n        }\n\n        return 0;\n    }\n\n    getColumnCount(skipStandardColumns) {\n        let val = this.columns.length;\n\n        if (skipStandardColumns) {\n            val = val - this.getStandardColumnCount();\n        }\n\n        return val;\n    }\n\n    getColumn(colIndex) {\n        colIndex = +colIndex;\n\n        if (colIndex < 0) {\n            // negative indexes\n            colIndex = this.columns.length + colIndex;\n        }\n\n        return this.columns.find(col => col.colIndex === colIndex);\n    }\n\n    getColumnById(id) {\n        return this.columns.find(col => col.id === id);\n    }\n\n    getRow(rowIndex) {\n        rowIndex = +rowIndex;\n        return this.rows[rowIndex];\n    }\n\n    getCell(colIndex, rowIndex) {\n        rowIndex = +rowIndex;\n        colIndex = +colIndex;\n        return this.getRow(rowIndex)[colIndex];\n    }\n\n    getChildren(parentRowIndex) {\n        parentRowIndex = +parentRowIndex;\n        const parentIndent = this.getRow(parentRowIndex).meta.indent;\n        const out = [];\n\n        for (let i = parentRowIndex + 1; i < this.rowCount; i++) {\n            const row = this.getRow(i);\n            if (isNaN(row.meta.indent)) continue;\n\n            if (row.meta.indent > parentIndent) {\n                out.push(i);\n            }\n\n            if (row.meta.indent === parentIndent) {\n                break;\n            }\n        }\n\n        return out;\n    }\n\n    getImmediateChildren(parentRowIndex) {\n        parentRowIndex = +parentRowIndex;\n        const parentIndent = this.getRow(parentRowIndex).meta.indent;\n        const out = [];\n        const childIndent = parentIndent + 1;\n\n        for (let i = parentRowIndex + 1; i < this.rowCount; i++) {\n            const row = this.getRow(i);\n            if (isNaN(row.meta.indent) || row.meta.indent > childIndent) continue;\n\n            if (row.meta.indent === childIndent) {\n                out.push(i);\n            }\n\n            if (row.meta.indent === parentIndent) {\n                break;\n            }\n        }\n\n        return out;\n    }\n\n    get() {\n        return {\n            columns: this.columns,\n            rows: this.rows\n        };\n    }\n\n    /**\n     * Returns the original data which was passed\n     * based on rowIndex\n     * @param {Number} rowIndex\n     * @returns Array|Object\n     * @memberof DataManager\n     */\n    getData(rowIndex) {\n        return this.data[rowIndex];\n    }\n\n    hasColumn(name) {\n        return Boolean(this.columns.find(col => col.content === name));\n    }\n\n    hasColumnById(id) {\n        return Boolean(this.columns.find(col => col.id === id));\n    }\n\n    getColumnIndex(name) {\n        return this.columns.findIndex(col => col.content === name);\n    }\n\n    getColumnIndexById(id) {\n        return this.columns.findIndex(col => col.id === id);\n    }\n\n    getCheckboxHTML() {\n        return '<input type=\"checkbox\" />';\n    }\n}\n\n// Custom Errors\nclass DataError extends TypeError {}\n\n/* eslint-disable max-len */\n\n// Icons from https://feathericons.com/\n\nlet icons = {\n    chevronDown: '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"feather feather-chevron-down\"><polyline points=\"6 9 12 15 18 9\"></polyline></svg>',\n    chevronRight: '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"feather feather-chevron-right\"><polyline points=\"9 18 15 12 9 6\"></polyline></svg>'\n};\n\nclass CellManager {\n    constructor(instance) {\n        this.instance = instance;\n        linkProperties(this, this.instance, [\n            'wrapper',\n            'options',\n            'style',\n            'header',\n            'bodyScrollable',\n            'columnmanager',\n            'rowmanager',\n            'datamanager',\n            'keyboard'\n        ]);\n\n        this.bindEvents();\n    }\n\n    bindEvents() {\n        this.bindFocusCell();\n        this.bindEditCell();\n        this.bindKeyboardSelection();\n        this.bindCopyCellContents();\n        this.bindMouseEvents();\n        this.bindTreeEvents();\n    }\n\n    bindFocusCell() {\n        this.bindKeyboardNav();\n    }\n\n    bindEditCell() {\n        this.$editingCell = null;\n\n        $.on(this.bodyScrollable, 'dblclick', '.dt-cell', (e, cell) => {\n            this.activateEditing(cell);\n        });\n\n        this.keyboard.on('enter', () => {\n            if (this.$focusedCell && !this.$editingCell) {\n                // enter keypress on focused cell\n                this.activateEditing(this.$focusedCell);\n            } else if (this.$editingCell) {\n                // enter keypress on editing cell\n                this.deactivateEditing();\n            }\n        });\n    }\n\n    bindKeyboardNav() {\n        const focusLastCell = (direction) => {\n            if (!this.$focusedCell || this.$editingCell) {\n                return false;\n            }\n\n            let $cell = this.$focusedCell;\n            const {\n                rowIndex,\n                colIndex\n            } = $.data($cell);\n\n            if (direction === 'left') {\n                $cell = this.getLeftMostCell$(rowIndex);\n            } else if (direction === 'right') {\n                $cell = this.getRightMostCell$(rowIndex);\n            } else if (direction === 'up') {\n                $cell = this.getTopMostCell$(colIndex);\n            } else if (direction === 'down') {\n                $cell = this.getBottomMostCell$(colIndex);\n            }\n\n            this.focusCell($cell);\n            return true;\n        };\n\n        ['left', 'right', 'up', 'down', 'tab', 'shift+tab']\n            .map(direction => this.keyboard.on(direction, () => this.focusCellInDirection(direction)));\n\n        ['left', 'right', 'up', 'down']\n            .map(direction => this.keyboard.on(`ctrl+${direction}`, () => focusLastCell(direction)));\n\n        this.keyboard.on('esc', () => {\n            this.deactivateEditing(false);\n            this.columnmanager.toggleFilter(false);\n        });\n\n        if (this.options.inlineFilters) {\n            this.keyboard.on('ctrl+f', (e) => {\n                const $cell = $.closest('.dt-cell', e.target);\n                const { colIndex } = $.data($cell);\n\n                this.activateFilter(colIndex);\n                return true;\n            });\n\n            $.on(this.header, 'focusin', '.dt-filter', () => {\n                this.unfocusCell(this.$focusedCell);\n            });\n        }\n    }\n\n    bindKeyboardSelection() {\n        const getNextSelectionCursor = (direction) => {\n            let $selectionCursor = this.getSelectionCursor();\n\n            if (direction === 'left') {\n                $selectionCursor = this.getLeftCell$($selectionCursor);\n            } else if (direction === 'right') {\n                $selectionCursor = this.getRightCell$($selectionCursor);\n            } else if (direction === 'up') {\n                $selectionCursor = this.getAboveCell$($selectionCursor);\n            } else if (direction === 'down') {\n                $selectionCursor = this.getBelowCell$($selectionCursor);\n            }\n\n            return $selectionCursor;\n        };\n\n        ['left', 'right', 'up', 'down']\n            .map(direction =>\n                this.keyboard.on(`shift+${direction}`, () => this.selectArea(getNextSelectionCursor(direction))));\n    }\n\n    bindCopyCellContents() {\n        this.keyboard.on('ctrl+c', () => {\n            const noOfCellsCopied = this.copyCellContents(this.$focusedCell, this.$selectionCursor);\n            const message = this.instance.translate('{count} cells copied', {\n                count: noOfCellsCopied\n            });\n\n            if (noOfCellsCopied) {\n                this.instance.showToastMessage(message, 2);\n            }\n        });\n\n        if (this.options.pasteFromClipboard) {\n            this.keyboard.on('ctrl+v', (e) => {\n                // hack\n                // https://stackoverflow.com/a/2177059/5353542\n                this.instance.pasteTarget.focus();\n\n                setTimeout(() => {\n                    const data = this.instance.pasteTarget.value;\n                    this.instance.pasteTarget.value = '';\n                    this.pasteContentInCell(data);\n                }, 10);\n\n                return false;\n            });\n        }\n    }\n\n    bindMouseEvents() {\n        let mouseDown = null;\n\n        $.on(this.bodyScrollable, 'mousedown', '.dt-cell', (e) => {\n            mouseDown = true;\n            this.focusCell($(e.delegatedTarget));\n        });\n\n        $.on(this.bodyScrollable, 'mouseup', () => {\n            mouseDown = false;\n        });\n\n        const selectArea = (e) => {\n            if (!mouseDown) return;\n            this.selectArea($(e.delegatedTarget));\n        };\n\n        $.on(this.bodyScrollable, 'mousemove', '.dt-cell', throttle$1(selectArea, 50));\n    }\n\n    bindTreeEvents() {\n        $.on(this.bodyScrollable, 'click', '.dt-tree-node__toggle', (e, $toggle) => {\n            const $cell = $.closest('.dt-cell', $toggle);\n            const { rowIndex } = $.data($cell);\n\n            if ($cell.classList.contains('dt-cell--tree-close')) {\n                this.rowmanager.openSingleNode(rowIndex);\n            } else {\n                this.rowmanager.closeSingleNode(rowIndex);\n            }\n        });\n    }\n\n    focusCell($cell, {\n        skipClearSelection = 0,\n        skipDOMFocus = 0,\n        skipScrollToCell = 0\n    } = {}) {\n        if (!$cell) return;\n\n        // don't focus if already editing cell\n        if ($cell === this.$editingCell) return;\n\n        const {\n            colIndex,\n            isHeader\n        } = $.data($cell);\n        if (isHeader) {\n            return;\n        }\n\n        const column = this.columnmanager.getColumn(colIndex);\n        if (column.focusable === false) {\n            return;\n        }\n\n        if (!skipScrollToCell) {\n            this.scrollToCell($cell);\n        }\n\n        this.deactivateEditing();\n        if (!skipClearSelection) {\n            this.clearSelection();\n        }\n\n        if (this.$focusedCell) {\n            this.$focusedCell.classList.remove('dt-cell--focus');\n        }\n\n        this.$focusedCell = $cell;\n        $cell.classList.add('dt-cell--focus');\n\n        if (!skipDOMFocus) {\n            // so that keyboard nav works\n            $cell.focus();\n        }\n\n        this.highlightRowColumnHeader($cell);\n    }\n\n    unfocusCell($cell) {\n        if (!$cell) return;\n\n        // remove cell border\n        $cell.classList.remove('dt-cell--focus');\n        this.$focusedCell = null;\n\n        // reset header background\n        if (this.lastHeaders) {\n            this.lastHeaders.forEach(header => header && header.classList.remove('dt-cell--highlight'));\n        }\n    }\n\n    highlightRowColumnHeader($cell) {\n        const {\n            colIndex,\n            rowIndex\n        } = $.data($cell);\n\n        const srNoColIndex = this.datamanager.getColumnIndexById('_rowIndex');\n        const colHeaderSelector = `.dt-cell--header-${colIndex}`;\n        const rowHeaderSelector = `.dt-cell--${srNoColIndex}-${rowIndex}`;\n\n        if (this.lastHeaders) {\n            this.lastHeaders.forEach(header => header && header.classList.remove('dt-cell--highlight'));\n        }\n\n        const colHeader = $(colHeaderSelector, this.wrapper);\n        const rowHeader = $(rowHeaderSelector, this.wrapper);\n\n        this.lastHeaders = [colHeader, rowHeader];\n        this.lastHeaders.forEach(header => header && header.classList.add('dt-cell--highlight'));\n    }\n\n    selectAreaOnClusterChanged() {\n        if (!(this.$focusedCell && this.$selectionCursor)) return;\n        const {\n            colIndex,\n            rowIndex\n        } = $.data(this.$selectionCursor);\n        const $cell = this.getCell$(colIndex, rowIndex);\n\n        if (!$cell || $cell === this.$selectionCursor) return;\n\n        // selectArea needs $focusedCell\n        const fCell = $.data(this.$focusedCell);\n        this.$focusedCell = this.getCell$(fCell.colIndex, fCell.rowIndex);\n\n        this.selectArea($cell);\n    }\n\n    focusCellOnClusterChanged() {\n        if (!this.$focusedCell) return;\n\n        const {\n            colIndex,\n            rowIndex\n        } = $.data(this.$focusedCell);\n        const $cell = this.getCell$(colIndex, rowIndex);\n\n        if (!$cell) return;\n        // this function is called after hyperlist renders the rows after scroll,\n        // focusCell calls clearSelection which resets the area selection\n        // so a flag to skip it\n        // we also skip DOM focus and scroll to cell\n        // because it fights with the user scroll\n        this.focusCell($cell, {\n            skipClearSelection: 1,\n            skipDOMFocus: 1,\n            skipScrollToCell: 1\n        });\n    }\n\n    selectArea($selectionCursor) {\n        if (!this.$focusedCell) return;\n\n        if (this._selectArea(this.$focusedCell, $selectionCursor)) {\n            // valid selection\n            this.$selectionCursor = $selectionCursor;\n        }\n    }\n\n    _selectArea($cell1, $cell2) {\n        if ($cell1 === $cell2) return false;\n\n        const cells = this.getCellsInRange($cell1, $cell2);\n        if (!cells) return false;\n\n        this.clearSelection();\n        this._selectedCells = cells.map(index => this.getCell$(...index));\n        requestAnimationFrame(() => {\n            this._selectedCells.map($cell => $cell.classList.add('dt-cell--highlight'));\n        });\n        return true;\n    }\n\n    getCellsInRange($cell1, $cell2) {\n        let colIndex1, rowIndex1, colIndex2, rowIndex2;\n\n        if (typeof $cell1 === 'number') {\n            [colIndex1, rowIndex1, colIndex2, rowIndex2] = arguments;\n        } else\n        if (typeof $cell1 === 'object') {\n            if (!($cell1 && $cell2)) {\n                return false;\n            }\n\n            const cell1 = $.data($cell1);\n            const cell2 = $.data($cell2);\n\n            colIndex1 = +cell1.colIndex;\n            rowIndex1 = +cell1.rowIndex;\n            colIndex2 = +cell2.colIndex;\n            rowIndex2 = +cell2.rowIndex;\n        }\n\n        if (rowIndex1 > rowIndex2) {\n            [rowIndex1, rowIndex2] = [rowIndex2, rowIndex1];\n        }\n\n        if (colIndex1 > colIndex2) {\n            [colIndex1, colIndex2] = [colIndex2, colIndex1];\n        }\n\n        if (this.isStandardCell(colIndex1) || this.isStandardCell(colIndex2)) {\n            return false;\n        }\n\n        const cells = [];\n        let colIndex = colIndex1;\n        let rowIndex = rowIndex1;\n        const rowIndices = [];\n\n        while (rowIndex <= rowIndex2) {\n            rowIndices.push(rowIndex);\n            rowIndex += 1;\n        }\n\n        rowIndices.map((rowIndex) => {\n            while (colIndex <= colIndex2) {\n                cells.push([colIndex, rowIndex]);\n                colIndex++;\n            }\n            colIndex = colIndex1;\n        });\n\n        return cells;\n    }\n\n    clearSelection() {\n        (this._selectedCells || [])\n            .forEach($cell => $cell.classList.remove('dt-cell--highlight'));\n\n        this._selectedCells = [];\n        this.$selectionCursor = null;\n    }\n\n    getSelectionCursor() {\n        return this.$selectionCursor || this.$focusedCell;\n    }\n\n    activateEditing($cell) {\n        this.focusCell($cell);\n        const {\n            rowIndex,\n            colIndex\n        } = $.data($cell);\n\n        const col = this.columnmanager.getColumn(colIndex);\n        if (col && (col.editable === false || col.focusable === false)) {\n            return;\n        }\n\n        const cell = this.getCell(colIndex, rowIndex);\n        if (cell && cell.editable === false) {\n            return;\n        }\n\n        if (this.$editingCell) {\n            const {\n                _rowIndex,\n                _colIndex\n            } = $.data(this.$editingCell);\n\n            if (rowIndex === _rowIndex && colIndex === _colIndex) {\n                // editing the same cell\n                return;\n            }\n        }\n\n        this.$editingCell = $cell;\n        $cell.classList.add('dt-cell--editing');\n\n        const $editCell = $('.dt-cell__edit', $cell);\n        $editCell.innerHTML = '';\n\n        const editor = this.getEditor(colIndex, rowIndex, cell.content, $editCell);\n\n        if (editor) {\n            this.currentCellEditor = editor;\n            // initialize editing input with cell value\n            editor.initValue(cell.content, rowIndex, col);\n        }\n    }\n\n    deactivateEditing(submitValue = true) {\n        if (submitValue) {\n            this.submitEditing();\n        }\n        // keep focus on the cell so that keyboard navigation works\n        if (this.$focusedCell) this.$focusedCell.focus();\n\n        if (!this.$editingCell) return;\n        this.$editingCell.classList.remove('dt-cell--editing');\n        this.$editingCell = null;\n    }\n\n    getEditor(colIndex, rowIndex, value, parent) {\n        const column = this.datamanager.getColumn(colIndex);\n        const row = this.datamanager.getRow(rowIndex);\n        const data = this.datamanager.getData(rowIndex);\n        let editor = this.options.getEditor ?\n            this.options.getEditor(colIndex, rowIndex, value, parent, column, row, data) :\n            this.getDefaultEditor(parent);\n\n        if (editor === false) {\n            // explicitly returned false\n            return false;\n        }\n        if (editor === undefined) {\n            // didn't return editor, fallback to default\n            editor = this.getDefaultEditor(parent);\n        }\n\n        return editor;\n    }\n\n    getDefaultEditor(parent) {\n        const $input = $.create('input', {\n            class: 'dt-input',\n            type: 'text',\n            inside: parent\n        });\n\n        return {\n            initValue(value) {\n                $input.focus();\n                $input.value = value;\n            },\n            getValue() {\n                return $input.value;\n            },\n            setValue(value) {\n                $input.value = value;\n            }\n        };\n    }\n\n    submitEditing() {\n        let promise = Promise.resolve();\n        if (!this.$editingCell) return promise;\n\n        const $cell = this.$editingCell;\n        const {\n            rowIndex,\n            colIndex\n        } = $.data($cell);\n        const col = this.datamanager.getColumn(colIndex);\n\n        if ($cell) {\n            const editor = this.currentCellEditor;\n\n            if (editor) {\n                let valuePromise = editor.getValue();\n\n                // convert to stubbed Promise\n                if (!valuePromise.then) {\n                    valuePromise = Promise.resolve(valuePromise);\n                }\n\n                promise = valuePromise.then((value) => {\n                    const oldValue = this.getCell(colIndex, rowIndex).content;\n\n                    if (oldValue === value) return false;\n\n                    const done = editor.setValue(value, rowIndex, col);\n\n                    // update cell immediately\n                    this.updateCell(colIndex, rowIndex, value);\n                    $cell.focus();\n\n                    if (done && done.then) {\n                        // revert to oldValue if promise fails\n                        done.catch((e) => {\n                            console.log(e);\n                            this.updateCell(colIndex, rowIndex, oldValue);\n                        });\n                    }\n                    return done;\n                });\n            }\n        }\n\n        this.currentCellEditor = null;\n        return promise;\n    }\n\n    copyCellContents($cell1, $cell2) {\n        if (!$cell2 && $cell1) {\n            // copy only focusedCell\n            const {\n                colIndex,\n                rowIndex\n            } = $.data($cell1);\n            const cell = this.getCell(colIndex, rowIndex);\n            copyTextToClipboard(cell.content);\n            return 1;\n        }\n        const cells = this.getCellsInRange($cell1, $cell2);\n\n        if (!cells) return 0;\n\n        const rows = cells\n            // get cell objects\n            .map(index => this.getCell(...index))\n            // convert to array of rows\n            .reduce((acc, curr) => {\n                const rowIndex = curr.rowIndex;\n\n                acc[rowIndex] = acc[rowIndex] || [];\n                acc[rowIndex].push(curr.content);\n\n                return acc;\n            }, []);\n\n        const values = rows\n            // join values by tab\n            .map(row => row.join('\\t'))\n            // join rows by newline\n            .join('\\n');\n\n        copyTextToClipboard(values);\n\n        // return no of cells copied\n        return rows.reduce((total, row) => total + row.length, 0);\n    }\n\n    pasteContentInCell(data) {\n        if (!this.$focusedCell) return;\n\n        const matrix = data\n            .split('\\n')\n            .map(row => row.split('\\t'))\n            .filter(row => row.length && row.every(it => it));\n\n        let { colIndex, rowIndex } = $.data(this.$focusedCell);\n\n        let focusedCell = {\n            colIndex: +colIndex,\n            rowIndex: +rowIndex\n        };\n\n        matrix.forEach((row, i) => {\n            let rowIndex = i + focusedCell.rowIndex;\n            row.forEach((cell, j) => {\n                let colIndex = j + focusedCell.colIndex;\n                this.updateCell(colIndex, rowIndex, cell);\n            });\n        });\n    }\n\n    activateFilter(colIndex) {\n        this.columnmanager.toggleFilter();\n        this.columnmanager.focusFilter(colIndex);\n\n        if (!this.columnmanager.isFilterShown) {\n            // put focus back on cell\n            this.$focusedCell && this.$focusedCell.focus();\n        }\n    }\n\n    updateCell(colIndex, rowIndex, value) {\n        const cell = this.datamanager.updateCell(colIndex, rowIndex, {\n            content: value\n        });\n        this.refreshCell(cell);\n    }\n\n    refreshCell(cell) {\n        const $cell = $(this.selector(cell.colIndex, cell.rowIndex), this.bodyScrollable);\n        $cell.innerHTML = this.getCellContent(cell);\n    }\n\n    toggleTreeButton(rowIndex, flag) {\n        const colIndex = this.columnmanager.getFirstColumnIndex();\n        const $cell = this.getCell$(colIndex, rowIndex);\n        if ($cell) {\n            $cell.classList[flag ? 'remove' : 'add']('dt-cell--tree-close');\n        }\n    }\n\n    isStandardCell(colIndex) {\n        // Standard cells are in Sr. No and Checkbox column\n        return colIndex < this.columnmanager.getFirstColumnIndex();\n    }\n\n    focusCellInDirection(direction) {\n        if (!this.$focusedCell || (this.$editingCell && ['left', 'right', 'up', 'down'].includes(direction))) {\n            return false;\n        } else if (this.$editingCell && ['tab', 'shift+tab'].includes(direction)) {\n            this.deactivateEditing();\n        }\n\n        let $cell = this.$focusedCell;\n\n        if (direction === 'left' || direction === 'shift+tab') {\n            $cell = this.getLeftCell$($cell);\n        } else if (direction === 'right' || direction === 'tab') {\n            $cell = this.getRightCell$($cell);\n        } else if (direction === 'up') {\n            $cell = this.getAboveCell$($cell);\n        } else if (direction === 'down') {\n            $cell = this.getBelowCell$($cell);\n        }\n\n        if (!$cell) {\n            return false;\n        }\n\n        const {\n            colIndex\n        } = $.data($cell);\n        const column = this.columnmanager.getColumn(colIndex);\n\n        if (!column.focusable) {\n            let $prevFocusedCell = this.$focusedCell;\n            this.unfocusCell($prevFocusedCell);\n            this.$focusedCell = $cell;\n            let ret = this.focusCellInDirection(direction);\n            if (!ret) {\n                this.focusCell($prevFocusedCell);\n            }\n            return ret;\n        }\n\n        this.focusCell($cell);\n        return true;\n    }\n\n    getCell$(colIndex, rowIndex) {\n        return $(this.selector(colIndex, rowIndex), this.bodyScrollable);\n    }\n\n    getAboveCell$($cell) {\n        const {\n            colIndex\n        } = $.data($cell);\n\n        let $aboveRow = $cell.parentElement.previousElementSibling;\n        while ($aboveRow && $aboveRow.classList.contains('dt-row--hide')) {\n            $aboveRow = $aboveRow.previousElementSibling;\n        }\n\n        if (!$aboveRow) return $cell;\n        return $(`.dt-cell--col-${colIndex}`, $aboveRow);\n    }\n\n    getBelowCell$($cell) {\n        const {\n            colIndex\n        } = $.data($cell);\n\n        let $belowRow = $cell.parentElement.nextElementSibling;\n        while ($belowRow && $belowRow.classList.contains('dt-row--hide')) {\n            $belowRow = $belowRow.nextElementSibling;\n        }\n\n        if (!$belowRow) return $cell;\n        return $(`.dt-cell--col-${colIndex}`, $belowRow);\n    }\n\n    getLeftCell$($cell) {\n        return $cell.previousElementSibling;\n    }\n\n    getRightCell$($cell) {\n        return $cell.nextElementSibling;\n    }\n\n    getLeftMostCell$(rowIndex) {\n        return this.getCell$(this.columnmanager.getFirstColumnIndex(), rowIndex);\n    }\n\n    getRightMostCell$(rowIndex) {\n        return this.getCell$(this.columnmanager.getLastColumnIndex(), rowIndex);\n    }\n\n    getTopMostCell$(colIndex) {\n        return this.getCell$(colIndex, this.rowmanager.getFirstRowIndex());\n    }\n\n    getBottomMostCell$(colIndex) {\n        return this.getCell$(colIndex, this.rowmanager.getLastRowIndex());\n    }\n\n    getCell(colIndex, rowIndex) {\n        return this.instance.datamanager.getCell(colIndex, rowIndex);\n    }\n\n    getRowHeight() {\n        return $.style($('.dt-row', this.bodyScrollable), 'height');\n    }\n\n    scrollToCell($cell) {\n        if ($.inViewport($cell, this.bodyScrollable)) return false;\n\n        const {\n            rowIndex\n        } = $.data($cell);\n        this.rowmanager.scrollToRow(rowIndex);\n        return false;\n    }\n\n    getRowCountPerPage() {\n        return Math.ceil(this.instance.getViewportHeight() / this.getRowHeight());\n    }\n\n    getCellHTML(cell) {\n        const {\n            rowIndex,\n            colIndex,\n            isHeader,\n            isFilter,\n            isTotalRow\n        } = cell;\n        const dataAttr = makeDataAttributeString({\n            rowIndex,\n            colIndex,\n            isHeader,\n            isFilter,\n            isTotalRow\n        });\n\n        const row = this.datamanager.getRow(rowIndex);\n\n        const isBodyCell = !(isHeader || isFilter || isTotalRow);\n\n        const className = [\n            'dt-cell',\n            'dt-cell--col-' + colIndex,\n            isBodyCell ? `dt-cell--${colIndex}-${rowIndex}` : '',\n            isBodyCell ? 'dt-cell--row-' + rowIndex : '',\n            isHeader ? 'dt-cell--header' : '',\n            isHeader ? `dt-cell--header-${colIndex}` : '',\n            isFilter ? 'dt-cell--filter' : '',\n            isBodyCell && (row && row.meta.isTreeNodeClose) ? 'dt-cell--tree-close' : ''\n        ].join(' ');\n\n        return `\n            <div class=\"${className}\" ${dataAttr} tabindex=\"0\">\n                ${this.getCellContent(cell)}\n            </div>\n        `;\n    }\n\n    getCellContent(cell) {\n        const {\n            isHeader,\n            isFilter,\n            colIndex\n        } = cell;\n\n        const editable = !isHeader && cell.editable !== false;\n        const editCellHTML = editable ? this.getEditCellHTML(colIndex) : '';\n\n        const sortable = isHeader && cell.sortable !== false;\n        const sortIndicator = sortable ?\n            `<span class=\"sort-indicator\">\n                ${this.options.sortIndicator[cell.sortOrder]}\n            </span>` :\n            '';\n\n        const resizable = isHeader && cell.resizable !== false;\n        const resizeColumn = resizable ? '<span class=\"dt-cell__resize-handle\"></span>' : '';\n\n        const hasDropdown = isHeader && cell.dropdown !== false;\n        const dropdown = hasDropdown ? this.columnmanager.getDropdownHTML() : '';\n\n        const customFormatter = cell.format || (cell.column && cell.column.format) || null;\n\n        let contentHTML;\n        if (isHeader || isFilter || !customFormatter) {\n            contentHTML = cell.content;\n        } else {\n            const row = this.datamanager.getRow(cell.rowIndex);\n            const data = this.datamanager.getData(cell.rowIndex);\n            contentHTML = customFormatter(cell.content, row, cell.column, data);\n        }\n\n        cell.html = contentHTML;\n\n        if (this.options.treeView && !(isHeader || isFilter) && cell.indent !== undefined) {\n            const nextRow = this.datamanager.getRow(cell.rowIndex + 1);\n            const addToggle = nextRow && nextRow.meta.indent > cell.indent;\n            const leftPadding = 20;\n            const unit = 'px';\n\n            // Add toggle and indent in the first column\n            const firstColumnIndex = this.datamanager.getColumnIndexById('_rowIndex') + 1;\n            if (firstColumnIndex === cell.colIndex) {\n                const padding = ((cell.indent || 0)) * leftPadding;\n                const toggleHTML = addToggle ?\n                    `<span class=\"dt-tree-node__toggle\" style=\"left: ${padding - leftPadding}${unit}\">\n                        <span class=\"icon-open\">${icons.chevronDown}</span>\n                        <span class=\"icon-close\">${icons.chevronRight}</span>\n                    </span>` : '';\n                contentHTML = `<span class=\"dt-tree-node\" style=\"padding-left: ${padding}${unit}\">\n                    ${toggleHTML}\n                    <span>${contentHTML}</span>\n                </span>`;\n            }\n        }\n\n        const className = [\n            'dt-cell__content',\n            isHeader ? `dt-cell__content--header-${colIndex}` : `dt-cell__content--col-${colIndex}`\n        ].join(' ');\n\n        return `\n            <div class=\"${className}\">\n                ${contentHTML}\n                ${sortIndicator}\n                ${resizeColumn}\n                ${dropdown}\n            </div>\n            ${editCellHTML}\n        `;\n    }\n\n    getEditCellHTML(colIndex) {\n        return `<div class=\"dt-cell__edit dt-cell__edit--col-${colIndex}\"></div>`;\n    }\n\n    selector(colIndex, rowIndex) {\n        return `.dt-cell--${colIndex}-${rowIndex}`;\n    }\n}\n\nclass ColumnManager {\n    constructor(instance) {\n        this.instance = instance;\n\n        linkProperties(this, this.instance, [\n            'options',\n            'fireEvent',\n            'header',\n            'datamanager',\n            'cellmanager',\n            'style',\n            'wrapper',\n            'rowmanager',\n            'bodyScrollable',\n            'bodyRenderer'\n        ]);\n\n        this.bindEvents();\n    }\n\n    renderHeader() {\n        this.header.innerHTML = '<div></div>';\n        this.refreshHeader();\n    }\n\n    refreshHeader() {\n        const columns = this.datamanager.getColumns();\n\n        // refresh html\n        $('div', this.header).innerHTML = this.getHeaderHTML(columns);\n\n        this.$filterRow = $('.dt-row-filter', this.header);\n        if (this.$filterRow) {\n            $.style(this.$filterRow, { display: 'none' });\n        }\n        // reset columnMap\n        this.$columnMap = [];\n        this.bindMoveColumn();\n    }\n\n    getHeaderHTML(columns) {\n        let html = this.rowmanager.getRowHTML(columns, {\n            isHeader: 1\n        });\n        if (this.options.inlineFilters) {\n            html += this.rowmanager.getRowHTML(columns, {\n                isFilter: 1\n            });\n        }\n        return html;\n    }\n\n    bindEvents() {\n        this.bindDropdown();\n        this.bindResizeColumn();\n        this.bindPerfectColumnWidth();\n        this.bindFilter();\n    }\n\n    bindDropdown() {\n        let toggleClass = '.dt-dropdown__toggle';\n        let dropdownClass = '.dt-dropdown__list';\n\n        // attach the dropdown list to container\n        this.instance.dropdownContainer.innerHTML = this.getDropdownListHTML();\n        this.$dropdownList = this.instance.dropdownContainer.firstElementChild;\n\n        $.on(this.header, 'click', toggleClass, e => {\n            this.openDropdown(e);\n        });\n\n        const deactivateDropdownOnBodyClick = (e) => {\n            const selector = [\n                toggleClass, toggleClass + ' *',\n                dropdownClass, dropdownClass + ' *'\n            ].join(',');\n            if (e.target.matches(selector)) return;\n            deactivateDropdown();\n        };\n        $.on(document.body, 'click', deactivateDropdownOnBodyClick);\n        document.addEventListener('scroll', deactivateDropdown, true);\n\n        this.instance.on('onDestroy', () => {\n            $.off(document.body, 'click', deactivateDropdownOnBodyClick);\n            $.off(document, 'scroll', deactivateDropdown);\n        });\n\n        $.on(this.$dropdownList, 'click', '.dt-dropdown__list-item', (e, $item) => {\n            if (!this._dropdownActiveColIndex) return;\n            const dropdownItems = this.options.headerDropdown;\n            const { index } = $.data($item);\n            const colIndex = this._dropdownActiveColIndex;\n            let callback = dropdownItems[index].action;\n\n            callback && callback.call(this.instance, this.getColumn(colIndex));\n            this.hideDropdown();\n        });\n\n        const _this = this;\n        function deactivateDropdown(e) {\n            _this.hideDropdown();\n        }\n\n        this.hideDropdown();\n    }\n\n    openDropdown(e) {\n        if (!this._dropdownWidth) {\n            $.style(this.$dropdownList, { display: '' });\n            this._dropdownWidth = $.style(this.$dropdownList, 'width');\n        }\n        $.style(this.$dropdownList, {\n            display: '',\n            left: (e.clientX - this._dropdownWidth + 4) + 'px',\n            top: (e.clientY + 4) + 'px'\n        });\n        const $cell = $.closest('.dt-cell', e.target);\n        const { colIndex } = $.data($cell);\n        this._dropdownActiveColIndex = colIndex;\n    }\n\n    hideDropdown() {\n        $.style(this.$dropdownList, {\n            display: 'none'\n        });\n        this._dropdownActiveColIndex = null;\n    }\n\n    bindResizeColumn() {\n        let isDragging = false;\n        let $resizingCell, startWidth, startX;\n\n        $.on(this.header, 'mousedown', '.dt-cell .dt-cell__resize-handle', (e, $handle) => {\n            document.body.classList.add('dt-resize');\n            const $cell = $handle.parentNode.parentNode;\n            $resizingCell = $cell;\n            const {\n                colIndex\n            } = $.data($resizingCell);\n            const col = this.getColumn(colIndex);\n\n            if (col && col.resizable === false) {\n                return;\n            }\n\n            isDragging = true;\n            startWidth = $.style($('.dt-cell__content', $resizingCell), 'width');\n            startX = e.pageX;\n        });\n\n        const onMouseup = (e) => {\n            document.body.classList.remove('dt-resize');\n            if (!$resizingCell) return;\n            isDragging = false;\n\n            const {\n                colIndex\n            } = $.data($resizingCell);\n            this.setColumnWidth(colIndex);\n            this.style.setBodyStyle();\n            $resizingCell = null;\n        };\n        $.on(document.body, 'mouseup', onMouseup);\n        this.instance.on('onDestroy', () => {\n            $.off(document.body, 'mouseup', onMouseup);\n        });\n\n        const onMouseMove = (e) => {\n            if (!isDragging) return;\n            let delta = e.pageX - startX;\n            if (this.options.direction === 'rtl') {\n                delta = -1 * delta;\n            }\n            const finalWidth = startWidth + delta;\n            const {\n                colIndex\n            } = $.data($resizingCell);\n\n            let columnMinWidth = this.options.minimumColumnWidth;\n            if (columnMinWidth > finalWidth) {\n                // don't resize past 30 pixels\n                return;\n            }\n            this.datamanager.updateColumn(colIndex, {\n                width: finalWidth\n            });\n            this.setColumnHeaderWidth(colIndex);\n        };\n        $.on(document.body, 'mousemove', onMouseMove);\n        this.instance.on('onDestroy', () => {\n            $.off(document.body, 'mousemove', onMouseMove);\n        });\n    }\n\n    bindPerfectColumnWidth() {\n        $.on(this.header, 'dblclick', '.dt-cell .dt-cell__resize-handle', (e, $handle) => {\n            const $cell = $handle.parentNode.parentNode;\n            const { colIndex } = $.data($cell);\n\n            let longestCell = this.bodyRenderer.visibleRows\n                .map(d => d[colIndex])\n                .reduce((acc, curr) => acc.content.length > curr.content.length ? acc : curr);\n\n            let $longestCellHTML = this.cellmanager.getCellHTML(longestCell);\n            let $div = document.createElement('div');\n            $div.innerHTML = $longestCellHTML;\n            let cellText = $div.querySelector('.dt-cell__content').textContent;\n\n            let {\n                borderLeftWidth,\n                borderRightWidth,\n                paddingLeft,\n                paddingRight\n            } = $.getStyle(this.bodyScrollable.querySelector('.dt-cell__content'));\n\n            let padding = [borderLeftWidth, borderRightWidth, paddingLeft, paddingRight]\n                .map(parseFloat)\n                .reduce((sum, val) => sum + val);\n\n            let width = $.measureTextWidth(cellText) + padding;\n            this.datamanager.updateColumn(colIndex, { width });\n            this.setColumnHeaderWidth(colIndex);\n            this.setColumnWidth(colIndex);\n        });\n    }\n\n    bindMoveColumn() {\n        if (this.options.disableReorderColumn) return;\n\n        const $parent = $('.dt-row', this.header);\n\n        this.sortable = Sortable.create($parent, {\n            onEnd: (e) => {\n                const {\n                    oldIndex,\n                    newIndex\n                } = e;\n                const $draggedCell = e.item;\n                const {\n                    colIndex\n                } = $.data($draggedCell);\n                if (+colIndex === newIndex) return;\n\n                this.switchColumn(oldIndex, newIndex);\n            },\n            preventOnFilter: false,\n            filter: '.dt-cell__resize-handle, .dt-dropdown',\n            chosenClass: 'dt-cell--dragging',\n            animation: 150\n        });\n    }\n\n    sortColumn(colIndex, nextSortOrder) {\n        this.instance.freeze();\n        this.sortRows(colIndex, nextSortOrder)\n            .then(() => {\n                this.refreshHeader();\n                return this.rowmanager.refreshRows();\n            })\n            .then(() => this.instance.unfreeze())\n            .then(() => {\n                this.fireEvent('onSortColumn', this.getColumn(colIndex));\n            });\n    }\n\n    removeColumn(colIndex) {\n        const removedCol = this.getColumn(colIndex);\n        this.instance.freeze();\n        this.datamanager.removeColumn(colIndex)\n            .then(() => {\n                this.refreshHeader();\n                return this.rowmanager.refreshRows();\n            })\n            .then(() => this.instance.unfreeze())\n            .then(() => {\n                this.fireEvent('onRemoveColumn', removedCol);\n            });\n    }\n\n    switchColumn(oldIndex, newIndex) {\n        this.instance.freeze();\n        this.datamanager.switchColumn(oldIndex, newIndex)\n            .then(() => {\n                this.refreshHeader();\n                return this.rowmanager.refreshRows();\n            })\n            .then(() => {\n                this.setColumnWidth(oldIndex);\n                this.setColumnWidth(newIndex);\n                this.instance.unfreeze();\n            })\n            .then(() => {\n                this.fireEvent('onSwitchColumn',\n                    this.getColumn(oldIndex), this.getColumn(newIndex)\n                );\n            });\n    }\n\n    toggleFilter(flag) {\n        if (!this.options.inlineFilters) return;\n\n        let showFilter;\n        if (flag === undefined) {\n            showFilter = !this.isFilterShown;\n        } else {\n            showFilter = flag;\n        }\n\n        if (showFilter) {\n            $.style(this.$filterRow, { display: '' });\n        } else {\n            $.style(this.$filterRow, { display: 'none' });\n        }\n\n        this.isFilterShown = showFilter;\n        this.style.setBodyStyle();\n    }\n\n    focusFilter(colIndex) {\n        if (!this.isFilterShown) return;\n\n        const $filterInput = $(`.dt-cell--col-${colIndex} .dt-filter`, this.$filterRow);\n        $filterInput.focus();\n    }\n\n    bindFilter() {\n        if (!this.options.inlineFilters) return;\n        const handler = e => {\n            this.applyFilter(this.getAppliedFilters());\n        };\n        $.on(this.header, 'keydown', '.dt-filter', debounce$1(handler, 300));\n    }\n\n    applyFilter(filters) {\n        this.datamanager.filterRows(filters)\n            .then(({\n                rowsToShow\n            }) => {\n                this.rowmanager.showRows(rowsToShow);\n            });\n    }\n\n    getAppliedFilters() {\n        const filters = {};\n        $.each('.dt-filter', this.header).map((input) => {\n            const value = input.value;\n            if (value) {\n                filters[input.dataset.colIndex] = value;\n            }\n        });\n        return filters;\n    }\n\n    applyDefaultSortOrder() {\n        // sort rows if any 1 column has a default sortOrder set\n        const columnsToSort = this.getColumns().filter(col => col.sortOrder !== 'none');\n\n        if (columnsToSort.length === 1) {\n            const column = columnsToSort[0];\n            this.sortColumn(column.colIndex, column.sortOrder);\n        }\n    }\n\n    sortRows(colIndex, sortOrder) {\n        return this.datamanager.sortRows(colIndex, sortOrder);\n    }\n\n    getColumn(colIndex) {\n        return this.datamanager.getColumn(colIndex);\n    }\n\n    getColumns() {\n        return this.datamanager.getColumns();\n    }\n\n    setColumnWidth(colIndex, width) {\n        colIndex = +colIndex;\n\n        let columnWidth = width || this.getColumn(colIndex).width;\n\n        const selector = [\n            `.dt-cell__content--col-${colIndex}`,\n            `.dt-cell__edit--col-${colIndex}`\n        ].join(', ');\n\n        const styles = {\n            width: columnWidth + 'px'\n        };\n\n        this.style.setStyle(selector, styles);\n    }\n\n    setColumnHeaderWidth(colIndex) {\n        colIndex = +colIndex;\n        this.$columnMap = this.$columnMap || [];\n        const selector = `.dt-cell__content--header-${colIndex}`;\n        const {\n            width\n        } = this.getColumn(colIndex);\n\n        let $column = this.$columnMap[colIndex];\n        if (!$column) {\n            $column = this.header.querySelector(selector);\n            this.$columnMap[colIndex] = $column;\n        }\n\n        $column.style.width = width + 'px';\n    }\n\n    getColumnMinWidth(colIndex) {\n        colIndex = +colIndex;\n        return this.getColumn(colIndex).minWidth || 24;\n    }\n\n    getFirstColumnIndex() {\n        return this.datamanager.getColumnIndexById('_rowIndex') + 1;\n    }\n\n    getHeaderCell$(colIndex) {\n        return $(`.dt-cell--header-${colIndex}`, this.header);\n    }\n\n    getLastColumnIndex() {\n        return this.datamanager.getColumnCount() - 1;\n    }\n\n    getDropdownHTML() {\n        const { dropdownButton } = this.options;\n\n        return `\n            <div class=\"dt-dropdown\">\n                <div class=\"dt-dropdown__toggle\">${dropdownButton}</div>\n            </div>\n      `;\n    }\n\n    getDropdownListHTML() {\n        const { headerDropdown: dropdownItems } = this.options;\n\n        return `\n            <div class=\"dt-dropdown__list\">\n            ${dropdownItems.map((d, i) => `\n                <div class=\"dt-dropdown__list-item\" data-index=\"${i}\">${d.label}</div>\n            `).join('')}\n            </div>\n        `;\n    }\n}\n\nclass RowManager {\n    constructor(instance) {\n        this.instance = instance;\n        linkProperties(this, this.instance, [\n            'options',\n            'fireEvent',\n            'wrapper',\n            'bodyScrollable',\n            'bodyRenderer',\n            'style'\n        ]);\n\n        this.bindEvents();\n        this.refreshRows = nextTick(this.refreshRows, this);\n    }\n\n    get datamanager() {\n        return this.instance.datamanager;\n    }\n\n    get cellmanager() {\n        return this.instance.cellmanager;\n    }\n\n    bindEvents() {\n        this.bindCheckbox();\n    }\n\n    bindCheckbox() {\n        if (!this.options.checkboxColumn) return;\n\n        // map of checked rows\n        this.checkMap = [];\n\n        $.on(this.wrapper, 'click', '.dt-cell--col-0 [type=\"checkbox\"]', (e, $checkbox) => {\n            const $cell = $checkbox.closest('.dt-cell');\n            const {\n                rowIndex,\n                isHeader\n            } = $.data($cell);\n            const checked = $checkbox.checked;\n\n            if (isHeader) {\n                this.checkAll(checked);\n            } else {\n                this.checkRow(rowIndex, checked);\n            }\n        });\n    }\n\n    refreshRows() {\n        this.instance.renderBody();\n        this.instance.setDimensions();\n    }\n\n    refreshRow(row, rowIndex) {\n        const _row = this.datamanager.updateRow(row, rowIndex);\n\n        _row.forEach(cell => {\n            this.cellmanager.refreshCell(cell);\n        });\n    }\n\n    getCheckedRows() {\n        if (!this.checkMap) {\n            return [];\n        }\n\n        let out = [];\n        for (let rowIndex in this.checkMap) {\n            const checked = this.checkMap[rowIndex];\n            if (checked === 1) {\n                out.push(rowIndex);\n            }\n        }\n\n        return out;\n    }\n\n    highlightCheckedRows() {\n        this.getCheckedRows()\n            .map(rowIndex => this.checkRow(rowIndex, true));\n    }\n\n    checkRow(rowIndex, toggle) {\n        const value = toggle ? 1 : 0;\n        const selector = rowIndex => `.dt-cell--0-${rowIndex} [type=\"checkbox\"]`;\n        // update internal map\n        this.checkMap[rowIndex] = value;\n        // set checkbox value explicitly\n        $.each(selector(rowIndex), this.bodyScrollable)\n            .map(input => {\n                input.checked = toggle;\n            });\n        // highlight row\n        this.highlightRow(rowIndex, toggle);\n        this.showCheckStatus();\n        this.fireEvent('onCheckRow', this.datamanager.getRow(rowIndex));\n    }\n\n    checkAll(toggle) {\n        const value = toggle ? 1 : 0;\n\n        // update internal map\n        if (toggle) {\n            this.checkMap = Array.from(Array(this.getTotalRows())).map(c => value);\n        } else {\n            this.checkMap = [];\n        }\n        // set checkbox value\n        $.each('.dt-cell--col-0 [type=\"checkbox\"]', this.bodyScrollable)\n            .map(input => {\n                input.checked = toggle;\n            });\n        // highlight all\n        this.highlightAll(toggle);\n        this.showCheckStatus();\n        this.fireEvent('onCheckRow');\n    }\n\n    showCheckStatus() {\n        if (!this.options.checkedRowStatus) return;\n        const checkedRows = this.getCheckedRows();\n        const count = checkedRows.length;\n        if (count > 0) {\n            let message = this.instance.translate('{count} rows selected', {\n                count: count\n            });\n            this.bodyRenderer.showToastMessage(message);\n        } else {\n            this.bodyRenderer.clearToastMessage();\n        }\n    }\n\n    highlightRow(rowIndex, toggle = true) {\n        const $row = this.getRow$(rowIndex);\n        if (!$row) return;\n\n        if (!toggle && this.bodyScrollable.classList.contains('dt-scrollable--highlight-all')) {\n            $row.classList.add('dt-row--unhighlight');\n            return;\n        }\n\n        if (toggle && $row.classList.contains('dt-row--unhighlight')) {\n            $row.classList.remove('dt-row--unhighlight');\n        }\n\n        this._highlightedRows = this._highlightedRows || {};\n\n        if (toggle) {\n            $row.classList.add('dt-row--highlight');\n            this._highlightedRows[rowIndex] = $row;\n        } else {\n            $row.classList.remove('dt-row--highlight');\n            delete this._highlightedRows[rowIndex];\n        }\n    }\n\n    highlightAll(toggle = true) {\n        if (toggle) {\n            this.bodyScrollable.classList.add('dt-scrollable--highlight-all');\n        } else {\n            this.bodyScrollable.classList.remove('dt-scrollable--highlight-all');\n            for (const rowIndex in this._highlightedRows) {\n                const $row = this._highlightedRows[rowIndex];\n                $row.classList.remove('dt-row--highlight');\n            }\n            this._highlightedRows = {};\n        }\n    }\n\n    showRows(rowIndices) {\n        rowIndices = ensureArray(rowIndices);\n        const rows = rowIndices.map(rowIndex => this.datamanager.getRow(rowIndex));\n        this.bodyRenderer.renderRows(rows);\n    }\n\n    showAllRows() {\n        const rowIndices = this.datamanager.getAllRowIndices();\n        this.showRows(rowIndices);\n    }\n\n    getChildrenToShowForNode(rowIndex) {\n        const row = this.datamanager.getRow(rowIndex);\n        row.meta.isTreeNodeClose = false;\n\n        return this.datamanager.getImmediateChildren(rowIndex);\n    }\n\n    openSingleNode(rowIndex) {\n        const childrenToShow = this.getChildrenToShowForNode(rowIndex);\n        const visibleRowIndices = this.bodyRenderer.visibleRowIndices;\n        const rowsToShow = uniq$1([...childrenToShow, ...visibleRowIndices]).sort(numberSortAsc);\n\n        this.showRows(rowsToShow);\n    }\n\n    getChildrenToHideForNode(rowIndex) {\n        const row = this.datamanager.getRow(rowIndex);\n        row.meta.isTreeNodeClose = true;\n\n        const rowsToHide = this.datamanager.getChildren(rowIndex);\n        rowsToHide.forEach(rowIndex => {\n            const row = this.datamanager.getRow(rowIndex);\n            if (!row.meta.isLeaf) {\n                row.meta.isTreeNodeClose = true;\n            }\n        });\n\n        return rowsToHide;\n    }\n\n    closeSingleNode(rowIndex) {\n        const rowsToHide = this.getChildrenToHideForNode(rowIndex);\n        const visibleRows = this.bodyRenderer.visibleRowIndices;\n        const rowsToShow = visibleRows\n            .filter(rowIndex => !rowsToHide.includes(rowIndex))\n            .sort(numberSortAsc);\n\n        this.showRows(rowsToShow);\n    }\n\n    expandAllNodes() {\n        let rows = this.datamanager.getRows();\n        let rootNodes = rows.filter(row => !row.meta.isLeaf);\n\n        const childrenToShow = rootNodes.map(row => this.getChildrenToShowForNode(row.meta.rowIndex)).flat();\n        const visibleRowIndices = this.bodyRenderer.visibleRowIndices;\n        const rowsToShow = uniq$1([...childrenToShow, ...visibleRowIndices]).sort(numberSortAsc);\n\n        this.showRows(rowsToShow);\n    }\n\n    collapseAllNodes() {\n        let rows = this.datamanager.getRows();\n        let rootNodes = rows.filter(row => row.meta.indent === 0);\n\n        const rowsToHide = rootNodes.map(row => this.getChildrenToHideForNode(row.meta.rowIndex)).flat();\n        const visibleRows = this.bodyRenderer.visibleRowIndices;\n        const rowsToShow = visibleRows\n            .filter(rowIndex => !rowsToHide.includes(rowIndex))\n            .sort(numberSortAsc);\n\n        this.showRows(rowsToShow);\n    }\n\n    setTreeDepth(depth) {\n        let rows = this.datamanager.getRows();\n\n        const rowsToOpen = rows.filter(row => row.meta.indent < depth);\n        const rowsToClose = rows.filter(row => row.meta.indent >= depth);\n        const rowsToHide = rowsToClose.filter(row => row.meta.indent > depth);\n\n        rowsToClose.forEach(row => {\n            if (!row.meta.isLeaf) {\n                row.meta.isTreeNodeClose = true;\n            }\n        });\n        rowsToOpen.forEach(row => {\n            if (!row.meta.isLeaf) {\n                row.meta.isTreeNodeClose = false;\n            }\n        });\n\n        const rowsToShow = rows\n            .filter(row => !rowsToHide.includes(row))\n            .map(row => row.meta.rowIndex)\n            .sort(numberSortAsc);\n        this.showRows(rowsToShow);\n    }\n\n    getRow$(rowIndex) {\n        return $(this.selector(rowIndex), this.bodyScrollable);\n    }\n\n    getTotalRows() {\n        return this.datamanager.getRowCount();\n    }\n\n    getFirstRowIndex() {\n        return 0;\n    }\n\n    getLastRowIndex() {\n        return this.datamanager.getRowCount() - 1;\n    }\n\n    scrollToRow(rowIndex) {\n        rowIndex = +rowIndex;\n        this._lastScrollTo = this._lastScrollTo || 0;\n        const $row = this.getRow$(rowIndex);\n        if ($.inViewport($row, this.bodyScrollable)) return;\n\n        const {\n            height\n        } = $row.getBoundingClientRect();\n        const {\n            top,\n            bottom\n        } = this.bodyScrollable.getBoundingClientRect();\n        const rowsInView = Math.floor((bottom - top) / height);\n\n        let offset = 0;\n        if (rowIndex > this._lastScrollTo) {\n            offset = height * ((rowIndex + 1) - rowsInView);\n        } else {\n            offset = height * ((rowIndex + 1) - 1);\n        }\n\n        this._lastScrollTo = rowIndex;\n        $.scrollTop(this.bodyScrollable, offset);\n    }\n\n    getRowHTML(row, props) {\n        const dataAttr = makeDataAttributeString(props);\n        let rowIdentifier = props.rowIndex;\n\n        if (props.isFilter) {\n            row = row.map(cell => (Object.assign({}, cell, {\n                content: this.getFilterInput({\n                    colIndex: cell.colIndex,\n                    name: cell.name\n                }),\n                isFilter: 1,\n                isHeader: undefined,\n                editable: false\n            })));\n\n            rowIdentifier = 'filter';\n        }\n\n        if (props.isHeader) {\n            rowIdentifier = 'header';\n        }\n\n        return `\n            <div class=\"dt-row dt-row-${rowIdentifier}\" ${dataAttr}>\n                ${row.map(cell => this.cellmanager.getCellHTML(cell)).join('')}\n            </div>\n        `;\n    }\n\n    getFilterInput(props) {\n        let title = `title=\"Filter based on ${props.name || 'Index'}\"`;\n        const dataAttr = makeDataAttributeString(props);\n        return `<input class=\"dt-filter dt-input\" type=\"text\" ${dataAttr} tabindex=\"1\" \n            ${props.colIndex === 0 ? 'disabled' : title} />`;\n    }\n\n    selector(rowIndex) {\n        return `.dt-row-${rowIndex}`;\n    }\n}\n\nvar hyperlist = createCommonjsModule(function (module, exports) {\n(function(f){{module.exports=f();}})(function(){return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof commonjsRequire==\"function\"&&commonjsRequire;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r);}return n[o].exports}var i=typeof commonjsRequire==\"function\"&&commonjsRequire;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(_dereq_,module,exports){\n\n// Default configuration.\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar defaultConfig = {\n  width: '100%',\n  height: '100%'\n};\n\n// Check for valid number.\nvar isNumber = function isNumber(input) {\n  return Number(input) === Number(input);\n};\n\n/**\n * Creates a HyperList instance that virtually scrolls very large amounts of\n * data effortlessly.\n */\n\nvar HyperList = function () {\n  _createClass(HyperList, null, [{\n    key: 'create',\n    value: function create(element, userProvidedConfig) {\n      return new HyperList(element, userProvidedConfig);\n    }\n\n    /**\n     * Merge given css style on an element\n     * @param {DOMElement} element\n     * @param {Object} style\n     */\n\n  }, {\n    key: 'mergeStyle',\n    value: function mergeStyle(element, style) {\n      for (var i in style) {\n        if (element.style[i] !== style[i]) {\n          element.style[i] = style[i];\n        }\n      }\n    }\n  }, {\n    key: 'getMaxBrowserHeight',\n    value: function getMaxBrowserHeight() {\n      // Create two elements, the wrapper is `1px` tall and is transparent and\n      // positioned at the top of the page. Inside that is an element that gets\n      // set to 1 billion pixels. Then reads the max height the browser can\n      // calculate.\n      var wrapper = document.createElement('div');\n      var fixture = document.createElement('div');\n\n      // As said above, these values get set to put the fixture elements into the\n      // right visual state.\n      HyperList.mergeStyle(wrapper, { position: 'absolute', height: '1px', opacity: 0 });\n      HyperList.mergeStyle(fixture, { height: '1e7px' });\n\n      // Add the fixture into the wrapper element.\n      wrapper.appendChild(fixture);\n\n      // Apply to the page, the values won't kick in unless this is attached.\n      document.body.appendChild(wrapper);\n\n      // Get the maximum element height in pixels.\n      var maxElementHeight = fixture.offsetHeight;\n\n      // Remove the element immediately after reading the value.\n      document.body.removeChild(wrapper);\n\n      return maxElementHeight;\n    }\n  }]);\n\n  function HyperList(element, userProvidedConfig) {\n    var _this = this;\n\n    _classCallCheck(this, HyperList);\n\n    this._config = {};\n    this._lastRepaint = null;\n    this._maxElementHeight = HyperList.getMaxBrowserHeight();\n\n    this.refresh(element, userProvidedConfig);\n\n    var config = this._config;\n\n    // Create internal render loop.\n    var render = function render() {\n      var scrollTop = _this._getScrollPosition();\n      var lastRepaint = _this._lastRepaint;\n\n      _this._renderAnimationFrame = window.requestAnimationFrame(render);\n\n      if (scrollTop === lastRepaint) {\n        return;\n      }\n\n      if (!lastRepaint || Math.abs(scrollTop - lastRepaint) > _this._averageHeight) {\n        var rendered = _this._renderChunk();\n\n        _this._lastRepaint = scrollTop;\n\n        if (rendered !== false && typeof config.afterRender === 'function') {\n          config.afterRender();\n        }\n      }\n    };\n\n    render();\n  }\n\n  _createClass(HyperList, [{\n    key: 'destroy',\n    value: function destroy() {\n      window.cancelAnimationFrame(this._renderAnimationFrame);\n    }\n  }, {\n    key: 'refresh',\n    value: function refresh(element, userProvidedConfig) {\n      var _this2 = this;\n\n      Object.assign(this._config, defaultConfig, userProvidedConfig);\n\n      if (!element || element.nodeType !== 1) {\n        throw new Error('HyperList requires a valid DOM Node container');\n      }\n\n      this._element = element;\n\n      var config = this._config;\n\n      var scroller = this._scroller || config.scroller || document.createElement(config.scrollerTagName || 'tr');\n\n      // Default configuration option `useFragment` to `true`.\n      if (typeof config.useFragment !== 'boolean') {\n        this._config.useFragment = true;\n      }\n\n      if (!config.generate) {\n        throw new Error('Missing required `generate` function');\n      }\n\n      if (!isNumber(config.total)) {\n        throw new Error('Invalid required `total` value, expected number');\n      }\n\n      if (!Array.isArray(config.itemHeight) && !isNumber(config.itemHeight)) {\n        throw new Error('\\n        Invalid required `itemHeight` value, expected number or array\\n      '.trim());\n      } else if (isNumber(config.itemHeight)) {\n        this._itemHeights = Array(config.total).fill(config.itemHeight);\n      } else {\n        this._itemHeights = config.itemHeight;\n      }\n\n      // Width and height should be coerced to string representations. Either in\n      // `%` or `px`.\n      Object.keys(defaultConfig).filter(function (prop) {\n        return prop in config;\n      }).forEach(function (prop) {\n        var value = config[prop];\n        var isValueNumber = isNumber(value);\n        var isValuePercent = isValueNumber ? false : value.slice(-1) === '%';\n\n        if (value && typeof value !== 'string' && typeof value !== 'number') {\n          var msg = 'Invalid optional `' + prop + '`, expected string or number';\n          throw new Error(msg);\n        } else if (isValueNumber) {\n          config[prop] = value + 'px';\n        }\n\n        if (prop !== 'height') {\n          return;\n        }\n\n        // Compute the containerHeight as number\n        var numberValue = isValueNumber ? value : parseInt(value.replace(/px|%/, ''), 10);\n\n        if (isValuePercent) {\n          _this2._containerHeight = window.innerHeight * numberValue / 100;\n        } else {\n          _this2._containerHeight = isNumber(value) ? value : numberValue;\n        }\n      });\n\n      // Decorate the container element with styles that will match\n      // the user supplied configuration.\n      var elementStyle = {\n        width: '' + config.width,\n        height: '' + config.height,\n        overflow: 'auto',\n        position: 'relative'\n      };\n\n      HyperList.mergeStyle(element, elementStyle);\n\n      var scrollerHeight = config.itemHeight * config.total;\n      var maxElementHeight = this._maxElementHeight;\n\n      if (scrollerHeight > maxElementHeight) {\n        console.warn(['HyperList: The maximum element height', maxElementHeight + 'px has', 'been exceeded; please reduce your item height.'].join(' '));\n      }\n\n      var scrollerStyle = {\n        opacity: '0',\n        position: 'absolute',\n        width: '1px',\n        height: scrollerHeight + 'px'\n      };\n\n      HyperList.mergeStyle(scroller, scrollerStyle);\n\n      // Only append the scroller element once.\n      if (!this._scroller) {\n        element.appendChild(scroller);\n      }\n\n      // Set the scroller instance.\n      this._scroller = scroller;\n      this._scrollHeight = this._computeScrollHeight();\n\n      // Reuse the item positions if refreshed, otherwise set to empty array.\n      this._itemPositions = this._itemPositions || Array(config.total).fill(0);\n\n      // Each index in the array should represent the position in the DOM.\n      this._computePositions(0);\n\n      // Render after refreshing. Force render if we're calling refresh manually.\n      this._renderChunk(this._lastRepaint !== null);\n\n      if (typeof config.afterRender === 'function') {\n        config.afterRender();\n      }\n    }\n  }, {\n    key: '_getRow',\n    value: function _getRow(i) {\n      var config = this._config;\n      var item = config.generate(i);\n      var height = item.height;\n\n      if (height !== undefined && isNumber(height)) {\n        item = item.element;\n\n        // The height isn't the same as predicted, compute positions again\n        if (height !== this._itemHeights) {\n          this._itemHeights[i] = height;\n          this._computePositions(i);\n          this._scrollHeight = this._computeScrollHeight(i);\n        }\n      } else {\n        height = this._itemHeights[i];\n      }\n\n      if (!item || item.nodeType !== 1) {\n        throw new Error('Generator did not return a DOM Node for index: ' + i);\n      }\n\n      var oldClass = item.getAttribute('class') || '';\n      item.setAttribute('class', oldClass + ' ' + (config.rowClassName || 'vrow'));\n\n      var top = this._itemPositions[i];\n\n      HyperList.mergeStyle(item, {\n        position: 'absolute',\n        top: top + 'px'\n      });\n\n      return item;\n    }\n  }, {\n    key: '_getScrollPosition',\n    value: function _getScrollPosition() {\n      var config = this._config;\n\n      if (typeof config.overrideScrollPosition === 'function') {\n        return config.overrideScrollPosition();\n      }\n\n      return this._element.scrollTop;\n    }\n  }, {\n    key: '_renderChunk',\n    value: function _renderChunk(force) {\n      var config = this._config;\n      var element = this._element;\n      var scrollTop = this._getScrollPosition();\n      var total = config.total;\n\n      var from = config.reverse ? this._getReverseFrom(scrollTop) : this._getFrom(scrollTop) - 1;\n\n      if (from < 0 || from - this._screenItemsLen < 0) {\n        from = 0;\n      }\n\n      if (!force && this._lastFrom === from) {\n        return false;\n      }\n\n      this._lastFrom = from;\n\n      var to = from + this._cachedItemsLen;\n\n      if (to > total || to + this._cachedItemsLen > total) {\n        to = total;\n      }\n\n      // Append all the new rows in a document fragment that we will later append\n      // to the parent node\n      var fragment = config.useFragment ? document.createDocumentFragment() : []\n      // Sometimes you'll pass fake elements to this tool and Fragments require\n      // real elements.\n\n\n      // The element that forces the container to scroll.\n      ;var scroller = this._scroller;\n\n      // Keep the scroller in the list of children.\n      fragment[config.useFragment ? 'appendChild' : 'push'](scroller);\n\n      for (var i = from; i < to; i++) {\n        var row = this._getRow(i);\n\n        fragment[config.useFragment ? 'appendChild' : 'push'](row);\n      }\n\n      if (config.applyPatch) {\n        return config.applyPatch(element, fragment);\n      }\n\n      element.innerHTML = '';\n      element.appendChild(fragment);\n    }\n  }, {\n    key: '_computePositions',\n    value: function _computePositions() {\n      var from = arguments.length <= 0 || arguments[0] === undefined ? 1 : arguments[0];\n\n      var config = this._config;\n      var total = config.total;\n      var reverse = config.reverse;\n\n      if (from < 1 && !reverse) {\n        from = 1;\n      }\n\n      for (var i = from; i < total; i++) {\n        if (reverse) {\n          if (i === 0) {\n            this._itemPositions[0] = this._scrollHeight - this._itemHeights[0];\n          } else {\n            this._itemPositions[i] = this._itemPositions[i - 1] - this._itemHeights[i];\n          }\n        } else {\n          this._itemPositions[i] = this._itemHeights[i - 1] + this._itemPositions[i - 1];\n        }\n      }\n    }\n  }, {\n    key: '_computeScrollHeight',\n    value: function _computeScrollHeight() {\n      var _this3 = this;\n\n      var config = this._config;\n      var total = config.total;\n      var scrollHeight = this._itemHeights.reduce(function (a, b) {\n        return a + b;\n      }, 0);\n\n      HyperList.mergeStyle(this._scroller, {\n        opacity: 0,\n        position: 'absolute',\n        width: '1px',\n        height: scrollHeight + 'px'\n      });\n\n      // Calculate the height median\n      var sortedItemHeights = this._itemHeights.slice(0).sort(function (a, b) {\n        return a - b;\n      });\n      var middle = Math.floor(total / 2);\n      var averageHeight = total % 2 === 0 ? (sortedItemHeights[middle] + sortedItemHeights[middle - 1]) / 2 : sortedItemHeights[middle];\n\n      var containerHeight = this._element.clientHeight ? this._element.clientHeight : this._containerHeight;\n      this._screenItemsLen = Math.ceil(containerHeight / averageHeight);\n      this._containerHeight = containerHeight;\n\n      // Cache 3 times the number of items that fit in the container viewport.\n      this._cachedItemsLen = Math.max(this._cachedItemsLen || 0, this._screenItemsLen * 3);\n      this._averageHeight = averageHeight;\n\n      if (config.reverse) {\n        window.requestAnimationFrame(function () {\n          _this3._element.scrollTop = scrollHeight;\n        });\n      }\n\n      return scrollHeight;\n    }\n  }, {\n    key: '_getFrom',\n    value: function _getFrom(scrollTop) {\n      var i = 0;\n\n      while (this._itemPositions[i] < scrollTop) {\n        i++;\n      }\n\n      return i;\n    }\n  }, {\n    key: '_getReverseFrom',\n    value: function _getReverseFrom(scrollTop) {\n      var i = this._config.total - 1;\n\n      while (i > 0 && this._itemPositions[i] < scrollTop + this._containerHeight) {\n        i--;\n      }\n\n      return i;\n    }\n  }]);\n\n  return HyperList;\n}();\n\nexports.default = HyperList;\nmodule.exports = exports['default'];\n\n},{}]},{},[1])(1)\n});\n});\n\nvar HyperList = unwrapExports(hyperlist);\n\nclass BodyRenderer {\n    constructor(instance) {\n        this.instance = instance;\n        this.options = instance.options;\n        this.datamanager = instance.datamanager;\n        this.rowmanager = instance.rowmanager;\n        this.cellmanager = instance.cellmanager;\n        this.bodyScrollable = instance.bodyScrollable;\n        this.footer = this.instance.footer;\n        this.log = instance.log;\n    }\n\n    renderRows(rows) {\n        this.visibleRows = rows;\n        this.visibleRowIndices = rows.map(row => row.meta.rowIndex);\n\n        if (rows.length === 0) {\n            this.bodyScrollable.innerHTML = this.getNoDataHTML();\n            return;\n        }\n\n        const rowViewOrder = this.datamanager.rowViewOrder.map(index => {\n            if (this.visibleRowIndices.includes(index)) {\n                return index;\n            }\n            return null;\n        }).filter(index => index !== null);\n\n        const computedStyle = getComputedStyle(this.bodyScrollable);\n\n        let config = {\n            width: computedStyle.width,\n            height: computedStyle.height,\n            itemHeight: this.options.cellHeight,\n            total: rows.length,\n            generate: (index) => {\n                const el = document.createElement('div');\n                const rowIndex = rowViewOrder[index];\n                const row = this.datamanager.getRow(rowIndex);\n                const rowHTML = this.rowmanager.getRowHTML(row, row.meta);\n                el.innerHTML = rowHTML;\n                return el.children[0];\n            },\n            afterRender: () => {\n                this.restoreState();\n            }\n        };\n\n        if (!this.hyperlist) {\n            this.hyperlist = new HyperList(this.bodyScrollable, config);\n        } else {\n            this.hyperlist.refresh(this.bodyScrollable, config);\n        }\n\n        this.renderFooter();\n    }\n\n    render() {\n        const rows = this.datamanager.getRowsForView();\n        this.renderRows(rows);\n        // setDimensions requires atleast 1 row to exist in dom\n        this.instance.setDimensions();\n    }\n\n    renderFooter() {\n        if (!this.options.showTotalRow) return;\n\n        const totalRow = this.getTotalRow();\n        let html = this.rowmanager.getRowHTML(totalRow, { isTotalRow: 1, rowIndex: 'totalRow' });\n\n        this.footer.innerHTML = html;\n    }\n\n    getTotalRow() {\n        const columns = this.datamanager.getColumns();\n        const totalRowTemplate = columns.map(col => {\n            let content = null;\n            if (['_rowIndex', '_checkbox'].includes(col.id)) {\n                content = '';\n            }\n            return {\n                content,\n                isTotalRow: 1,\n                colIndex: col.colIndex,\n                column: col\n            };\n        });\n\n        const totalRow = totalRowTemplate.map((cell, i) => {\n            if (cell.content === '') return cell;\n\n            if (this.options.hooks.columnTotal) {\n                const columnValues = this.visibleRows.map(row => row[i].content);\n                const result = this.options.hooks.columnTotal.call(this.instance, columnValues, cell);\n                if (result != null) {\n                    cell.content = result;\n                    return cell;\n                }\n            }\n\n            cell.content = this.visibleRows.reduce((acc, prevRow) => {\n                const prevCell = prevRow[i];\n                if (typeof prevCell.content === 'number') {\n                    if (acc == null) acc = 0;\n                    return acc + prevCell.content;\n                }\n                return acc;\n            }, cell.content);\n\n            return cell;\n        });\n\n        return totalRow;\n    }\n\n    restoreState() {\n        this.rowmanager.highlightCheckedRows();\n        this.cellmanager.selectAreaOnClusterChanged();\n        this.cellmanager.focusCellOnClusterChanged();\n    }\n\n    showToastMessage(message, hideAfter) {\n        this.instance.toastMessage.innerHTML = this.getToastMessageHTML(message);\n\n        if (hideAfter) {\n            setTimeout(() => {\n                this.clearToastMessage();\n            }, hideAfter * 1000);\n        }\n    }\n\n    clearToastMessage() {\n        this.instance.toastMessage.innerHTML = '';\n    }\n\n    getNoDataHTML() {\n        return `<div class=\"dt-scrollable__no-data\">${this.options.noDataMessage}</div>`;\n    }\n\n    getToastMessageHTML(message) {\n        return `<span class=\"dt-toast__message\">${message}</span>`;\n    }\n}\n\nclass Style {\n    constructor(instance) {\n        this.instance = instance;\n\n        linkProperties(this, this.instance, [\n            'options', 'datamanager', 'columnmanager',\n            'header', 'footer', 'bodyScrollable', 'datatableWrapper',\n            'getColumn', 'bodyRenderer'\n        ]);\n\n        this.scopeClass = 'dt-instance-' + instance.constructor.instances;\n        instance.datatableWrapper.classList.add(this.scopeClass);\n\n        const styleEl = document.createElement('style');\n        instance.wrapper.insertBefore(styleEl, instance.datatableWrapper);\n        this.styleEl = styleEl;\n\n        this.bindResizeWindow();\n        this.bindScrollHeader();\n    }\n\n    get stylesheet() {\n        return this.styleEl.sheet;\n    }\n\n    bindResizeWindow() {\n        this.onWindowResize = this.onWindowResize.bind(this);\n        this.onWindowResize = throttle$1(this.onWindowResize, 300);\n\n        if (this.options.layout === 'fluid') {\n            $.on(window, 'resize', this.onWindowResize);\n        }\n    }\n\n    bindScrollHeader() {\n        this._settingHeaderPosition = false;\n\n        $.on(this.bodyScrollable, 'scroll', (e) => {\n            if (this._settingHeaderPosition) return;\n\n            this._settingHeaderPosition = true;\n\n            requestAnimationFrame(() => {\n                const left = -e.target.scrollLeft;\n\n                $.style(this.header, {\n                    transform: `translateX(${left}px)`\n                });\n                $.style(this.footer, {\n                    transform: `translateX(${left}px)`\n                });\n                this._settingHeaderPosition = false;\n            });\n        });\n    }\n\n    onWindowResize() {\n        this.distributeRemainingWidth();\n        this.refreshColumnWidth();\n        this.setBodyStyle();\n    }\n\n    destroy() {\n        this.styleEl.remove();\n        $.off(window, 'resize', this.onWindowResize);\n    }\n\n    setStyle(selector, styleObject) {\n        if (selector.includes(',')) {\n            selector.split(',')\n                .map(s => s.trim())\n                .forEach(selector => {\n                    this.setStyle(selector, styleObject);\n                });\n            return;\n        }\n\n        selector = selector.trim();\n        if (!selector) return;\n\n        this._styleRulesMap = this._styleRulesMap || {};\n        const prefixedSelector = this._getPrefixedSelector(selector);\n\n        if (this._styleRulesMap[prefixedSelector]) {\n            this.removeStyle(selector);\n\n            // merge with old styleobject\n            styleObject = Object.assign({}, this._styleRulesMap[prefixedSelector], styleObject);\n        }\n\n        const styleString = this._getRuleString(styleObject);\n        const ruleString = `${prefixedSelector} { ${styleString} }`;\n\n        this._styleRulesMap[prefixedSelector] = styleObject;\n        this.stylesheet.insertRule(ruleString);\n    }\n\n    removeStyle(selector) {\n        if (selector.includes(',')) {\n            selector.split(',')\n                .map(s => s.trim())\n                .forEach(selector => {\n                    this.removeStyle(selector);\n                });\n            return;\n        }\n\n        selector = selector.trim();\n        if (!selector) return;\n\n        // find and remove\n        const prefixedSelector = this._getPrefixedSelector(selector);\n        const index = Array.from(this.stylesheet.cssRules)\n            .findIndex(rule => rule.selectorText === prefixedSelector);\n\n        if (index === -1) return;\n        this.stylesheet.deleteRule(index);\n    }\n\n    _getPrefixedSelector(selector) {\n        return `.${this.scopeClass} ${selector}`;\n    }\n\n    _getRuleString(styleObject) {\n        return Object.keys(styleObject)\n            .map(prop => {\n                let dashed = prop;\n                if (!prop.includes('-')) {\n                    dashed = camelCaseToDash(prop);\n                }\n                return `${dashed}:${styleObject[prop]};`;\n            })\n            .join('');\n    }\n\n    setDimensions() {\n        this.setCellHeight();\n        this.setupMinWidth();\n        this.setupNaturalColumnWidth();\n        this.setupColumnWidth();\n        this.distributeRemainingWidth();\n        this.setColumnStyle();\n        this.setBodyStyle();\n    }\n\n    setCellHeight() {\n        this.setStyle('.dt-cell', {\n            height: this.options.cellHeight + 'px'\n        });\n    }\n\n    setupMinWidth() {\n        $.each('.dt-cell--header', this.header).map(col => {\n            const { colIndex } = $.data(col);\n            const column = this.getColumn(colIndex);\n\n            if (!column.minWidth) {\n                const width = $.style($('.dt-cell__content', col), 'width');\n                // only set this once\n                column.minWidth = width;\n            }\n        });\n    }\n\n    setupNaturalColumnWidth() {\n        if (!$('.dt-row')) return;\n\n        $.each('.dt-row-header .dt-cell', this.header).map($headerCell => {\n            const { colIndex } = $.data($headerCell);\n            const column = this.datamanager.getColumn(colIndex);\n            let width = $.style($('.dt-cell__content', $headerCell), 'width');\n            if (typeof width === 'number' && width >= this.options.minimumColumnWidth) {\n                column.naturalWidth = width;\n            } else {\n                column.naturalWidth = this.options.minimumColumnWidth;\n            }\n        });\n\n        // set initial width as naturally calculated by table's first row\n        $.each('.dt-row-0 .dt-cell', this.bodyScrollable).map($cell => {\n            const {\n                colIndex\n            } = $.data($cell);\n            const column = this.datamanager.getColumn(colIndex);\n\n            let naturalWidth = $.style($('.dt-cell__content', $cell), 'width');\n\n            if (typeof naturalWidth === 'number' && naturalWidth >= column.naturalWidth) {\n                column.naturalWidth = naturalWidth;\n            } else {\n                column.naturalWidth = column.naturalWidth;\n            }\n        });\n    }\n\n    setupColumnWidth() {\n        if (this.options.layout === 'ratio') {\n            let totalWidth = $.style(this.datatableWrapper, 'width');\n\n            if (this.options.serialNoColumn) {\n                const rowIndexColumn = this.datamanager.getColumnById('_rowIndex');\n                totalWidth = totalWidth - rowIndexColumn.width - 1;\n            }\n\n            if (this.options.checkboxColumn) {\n                const rowIndexColumn = this.datamanager.getColumnById('_checkbox');\n                totalWidth = totalWidth - rowIndexColumn.width - 1;\n            }\n\n            const totalParts = this.datamanager.getColumns()\n                .map(column => {\n                    if (column.id === '_rowIndex' || column.id === '_checkbox') {\n                        return 0;\n                    }\n                    if (!column.width) {\n                        column.width = 1;\n                    }\n                    column.ratioWidth = parseInt(column.width, 10);\n                    return column.ratioWidth;\n                })\n                .reduce((a, c) => a + c);\n\n            const onePart = totalWidth / totalParts;\n\n            this.datamanager.getColumns()\n                .map(column => {\n                    if (column.id === '_rowIndex' || column.id === '_checkbox') return;\n                    column.width = Math.floor(onePart * column.ratioWidth) - 1;\n                });\n        } else {\n            this.datamanager.getColumns()\n                .map(column => {\n                    if (!column.width) {\n                        column.width = column.naturalWidth;\n                    }\n                    if (column.id === '_rowIndex') {\n                        column.width = this.getRowIndexColumnWidth();\n                    }\n                    if (column.width < this.options.minimumColumnWidth) {\n                        column.width = this.options.minimumColumnWidth;\n                    }\n                });\n        }\n    }\n\n    distributeRemainingWidth() {\n        if (this.options.layout !== 'fluid') return;\n\n        const wrapperWidth = $.style(this.instance.datatableWrapper, 'width');\n        let firstRow = $('.dt-row', this.bodyScrollable);\n        let firstRowWidth = wrapperWidth;\n        if (!firstRow) {\n            let headerRow = $('.dt-row', this.instance.header);\n            let cellWidths = Array.from(headerRow.children)\n                .map(cell => cell.offsetWidth);\n            firstRowWidth = cellWidths.reduce((sum, a) => sum + a, 0);\n        } else {\n            firstRowWidth = $.style(firstRow, 'width');\n        }\n        const resizableColumns = this.datamanager.getColumns().filter(col => col.resizable);\n        const deltaWidth = (wrapperWidth - firstRowWidth) / resizableColumns.length;\n\n        resizableColumns.map(col => {\n            const width = $.style(this.getColumnHeaderElement(col.colIndex), 'width');\n            let finalWidth = Math.floor(width + deltaWidth) - 2;\n\n            this.datamanager.updateColumn(col.colIndex, {\n                width: finalWidth\n            });\n        });\n    }\n\n    setColumnStyle() {\n        // align columns\n        this.datamanager.getColumns()\n            .map(column => {\n                // alignment\n                if (!column.align) {\n                    column.align = 'left';\n                }\n                if (!['left', 'center', 'right'].includes(column.align)) {\n                    column.align = 'left';\n                }\n                this.setStyle(`.dt-cell--col-${column.colIndex}`, {\n                    'text-align': column.align\n                });\n\n                // width\n                this.columnmanager.setColumnHeaderWidth(column.colIndex);\n                this.columnmanager.setColumnWidth(column.colIndex);\n            });\n    }\n\n    refreshColumnWidth() {\n        this.datamanager.getColumns()\n            .map(column => {\n                this.columnmanager.setColumnHeaderWidth(column.colIndex);\n                this.columnmanager.setColumnWidth(column.colIndex);\n            });\n    }\n\n    setBodyStyle() {\n        const bodyWidth = $.style(this.datatableWrapper, 'width');\n        const firstRow = $('.dt-row', this.bodyScrollable);\n        if (!firstRow) return;\n        const rowWidth = $.style(firstRow, 'width');\n\n        let width = bodyWidth > rowWidth ? rowWidth : bodyWidth;\n        $.style(this.bodyScrollable, {\n            width: width + 'px'\n        });\n\n        // remove the body height, so that it resets to it's original\n        $.removeStyle(this.bodyScrollable, 'height');\n\n        // when there are less rows than the container\n        // adapt the container height\n        let bodyHeight = $.getStyle(this.bodyScrollable, 'height');\n        const scrollHeight = (this.bodyRenderer.hyperlist || {})._scrollHeight || Infinity;\n        const hasHorizontalOverflow = $.hasHorizontalOverflow(this.bodyScrollable);\n\n        let height;\n\n        if (scrollHeight < bodyHeight) {\n            height = scrollHeight;\n\n            // account for scrollbar size when\n            // there is horizontal overflow\n            if (hasHorizontalOverflow) {\n                height += $.scrollbarSize();\n            }\n\n            $.style(this.bodyScrollable, {\n                height: height + 'px'\n            });\n        }\n\n        const verticalOverflow = this.bodyScrollable.scrollHeight - this.bodyScrollable.offsetHeight;\n        if (verticalOverflow < $.scrollbarSize()) {\n            // if verticalOverflow is less than scrollbar size\n            // then most likely scrollbar is causing the scroll\n            // which is not needed\n            $.style(this.bodyScrollable, {\n                overflowY: 'hidden'\n            });\n        }\n\n        if (this.options.layout === 'fluid') {\n            $.style(this.bodyScrollable, {\n                overflowX: 'hidden'\n            });\n        }\n    }\n\n    getColumnHeaderElement(colIndex) {\n        colIndex = +colIndex;\n        if (colIndex < 0) return null;\n        return $(`.dt-cell--col-${colIndex}`, this.header);\n    }\n\n    getRowIndexColumnWidth() {\n        const rowCount = this.datamanager.getRowCount();\n        const padding = 22;\n        return $.measureTextWidth(rowCount + '') + padding;\n    }\n}\n\nconst KEYCODES = {\n    13: 'enter',\n    91: 'meta',\n    16: 'shift',\n    17: 'ctrl',\n    18: 'alt',\n    37: 'left',\n    38: 'up',\n    39: 'right',\n    40: 'down',\n    9: 'tab',\n    27: 'esc',\n    67: 'c',\n    70: 'f',\n    86: 'v'\n};\n\nclass Keyboard {\n    constructor(element) {\n        this.listeners = {};\n        $.on(element, 'keydown', this.handler.bind(this));\n    }\n\n    handler(e) {\n        let key = KEYCODES[e.keyCode];\n\n        if (e.shiftKey && key !== 'shift') {\n            key = 'shift+' + key;\n        }\n\n        if ((e.ctrlKey && key !== 'ctrl') || (e.metaKey && key !== 'meta')) {\n            key = 'ctrl+' + key;\n        }\n\n        const listeners = this.listeners[key];\n\n        if (listeners && listeners.length > 0) {\n            for (let listener of listeners) {\n                const preventBubbling = listener(e);\n                if (preventBubbling === undefined || preventBubbling === true) {\n                    e.preventDefault();\n                }\n            }\n        }\n    }\n\n    on(key, listener) {\n        const keys = key.split(',').map(k => k.trim());\n\n        keys.map(key => {\n            this.listeners[key] = this.listeners[key] || [];\n            this.listeners[key].push(listener);\n        });\n    }\n}\n\nvar en = {\n\t\"Sort Ascending\": \"Sort Ascending\",\n\t\"Sort Descending\": \"Sort Descending\",\n\t\"Reset sorting\": \"Reset sorting\",\n\t\"Remove column\": \"Remove column\",\n\t\"No Data\": \"No Data\",\n\t\"{count} cells copied\": {\"1\":\"{count} cell copied\",\"default\":\"{count} cells copied\"},\n\t\"{count} rows selected\": {\"1\":\"{count} row selected\",\"default\":\"{count} rows selected\"}\n};\n\nvar de = {\n\t\"Sort Ascending\": \"Aufsteigend sortieren\",\n\t\"Sort Descending\": \"Absteigend sortieren\",\n\t\"Reset sorting\": \"Sortierung zur\u00FCcksetzen\",\n\t\"Remove column\": \"Spalte entfernen\",\n\t\"No Data\": \"Keine Daten\",\n\t\"{count} cells copied\": {\"1\":\"{count} Zelle kopiert\",\"default\":\"{count} Zellen kopiert\"},\n\t\"{count} rows selected\": {\"1\":\"{count} Zeile ausgew\u00E4hlt\",\"default\":\"{count} Zeilen ausgew\u00E4hlt\"}\n};\n\nvar fr = {\n\t\"Sort Ascending\": \"Trier par ordre croissant\",\n\t\"Sort Descending\": \"Trier par ordre d\u00E9croissant\",\n\t\"Reset sorting\": \"R\u00E9initialiser le tri\",\n\t\"Remove column\": \"Supprimer colonne\",\n\t\"No Data\": \"Pas de donn\u00E9es\",\n\t\"{count} cells copied\": {\"1\":\"{count} cellule copi\u00E9e\",\"default\":\"{count} cellules copi\u00E9es\"},\n\t\"{count} rows selected\": {\"1\":\"{count} ligne s\u00E9lectionn\u00E9e\",\"default\":\"{count} lignes s\u00E9lectionn\u00E9es\"}\n};\n\nvar it = {\n\t\"Sort Ascending\": \"Ordinamento ascendente\",\n\t\"Sort Descending\": \"Ordinamento decrescente\",\n\t\"Reset sorting\": \"Azzeramento ordinamento\",\n\t\"Remove column\": \"Rimuovi colonna\",\n\t\"No Data\": \"Nessun dato\",\n\t\"{count} cells copied\": {\"1\":\"Copiato {count} cella\",\"default\":\"{count} celle copiate\"},\n\t\"{count} rows selected\": {\"1\":\"{count} linea selezionata\",\"default\":\"{count} linee selezionate\"}\n};\n\nfunction getTranslations() {\n    return {\n        en,\n        de,\n        fr,\n        it,\n    };\n}\n\nclass TranslationManager {\n    constructor(language) {\n        this.language = language;\n        this.translations = getTranslations();\n    }\n\n    addTranslations(translations) {\n        this.translations = Object.assign(this.translations, translations);\n    }\n\n    translate(sourceText, args) {\n        let translation = (this.translations[this.language] &&\n            this.translations[this.language][sourceText]) || sourceText;\n\n        if (typeof translation === 'object') {\n            translation = args && args.count ?\n                this.getPluralizedTranslation(translation, args.count) :\n                sourceText;\n        }\n\n        return format(translation, args || {});\n    }\n\n    getPluralizedTranslation(translations, count) {\n        return translations[count] || translations['default'];\n    }\n}\n\nfunction filterRows(rows, filters) {\n    let filteredRowIndices = [];\n\n    if (Object.keys(filters).length === 0) {\n        return rows.map(row => row.meta.rowIndex);\n    }\n\n    for (let colIndex in filters) {\n        const keyword = filters[colIndex];\n\n        const filteredRows = filteredRowIndices.length ?\n            filteredRowIndices.map(i => rows[i]) :\n            rows;\n\n        const cells = filteredRows.map(row => row[colIndex]);\n\n        let filter = guessFilter(keyword);\n        let filterMethod = getFilterMethod(filter);\n\n        if (filterMethod) {\n            filteredRowIndices = filterMethod(filter.text, cells);\n        } else {\n            filteredRowIndices = cells.map(cell => cell.rowIndex);\n        }\n    }\n\n    return filteredRowIndices;\n}\nfunction getFilterMethod(filter) {\n    const stringCompareValue = cell =>\n        String(stripHTML(cell.html || '') || cell.content || '').toLowerCase();\n\n    const numberCompareValue = cell => parseFloat(cell.content);\n\n    const getCompareValues = (cell, keyword) => {\n        if (cell.column.compareValue) {\n            const compareValues = cell.column.compareValue(cell, keyword);\n            if (compareValues && Array.isArray(compareValues)) return compareValues;\n        }\n\n        // check if it can be converted to number\n        const float = numberCompareValue(cell);\n        if (!isNaN(float)) {\n            return [float, keyword];\n        }\n\n        return [stringCompareValue(cell), keyword];\n    };\n\n    let filterMethodMap = {\n        contains(keyword, cells) {\n            return cells\n                .filter(cell => {\n                    const hay = stringCompareValue(cell);\n                    const needle = (keyword || '').toLowerCase();\n                    return !needle || hay.includes(needle);\n                })\n                .map(cell => cell.rowIndex);\n        },\n\n        greaterThan(keyword, cells) {\n            return cells\n                .filter(cell => {\n                    const [compareValue, keywordValue] = getCompareValues(cell, keyword);\n                    return compareValue > keywordValue;\n                })\n                .map(cell => cell.rowIndex);\n        },\n\n        lessThan(keyword, cells) {\n            return cells\n                .filter(cell => {\n                    const [compareValue, keywordValue] = getCompareValues(cell, keyword);\n                    return compareValue < keywordValue;\n                })\n                .map(cell => cell.rowIndex);\n        },\n\n        equals(keyword, cells) {\n            return cells\n                .filter(cell => {\n                    const value = parseFloat(cell.content);\n                    return value === keyword;\n                })\n                .map(cell => cell.rowIndex);\n        },\n\n        notEquals(keyword, cells) {\n            return cells\n                .filter(cell => {\n                    const value = parseFloat(cell.content);\n                    return value !== keyword;\n                })\n                .map(cell => cell.rowIndex);\n        },\n\n        range(rangeValues, cells) {\n            return cells\n                .filter(cell => {\n                    const values1 = getCompareValues(cell, rangeValues[0]);\n                    const values2 = getCompareValues(cell, rangeValues[1]);\n                    const value = values1[0];\n                    return value >= values1[1] && value <= values2[1];\n                })\n                .map(cell => cell.rowIndex);\n        },\n\n        containsNumber(keyword, cells) {\n            return cells\n                .filter(cell => {\n                    let number = parseFloat(keyword, 10);\n                    let string = keyword;\n                    let hayNumber = numberCompareValue(cell);\n                    let hayString = stringCompareValue(cell);\n\n                    return number === hayNumber || hayString.includes(string);\n                })\n                .map(cell => cell.rowIndex);\n        }\n    };\n\n    return filterMethodMap[filter.type];\n}\n\nfunction guessFilter(keyword = '') {\n    if (keyword.length === 0) return {};\n\n    let compareString = keyword;\n\n    if (['>', '<', '='].includes(compareString[0])) {\n        compareString = keyword.slice(1);\n    } else if (compareString.startsWith('!=')) {\n        compareString = keyword.slice(2);\n    }\n\n    if (keyword.startsWith('>')) {\n        if (compareString) {\n            return {\n                type: 'greaterThan',\n                text: compareString.trim()\n            };\n        }\n    }\n\n    if (keyword.startsWith('<')) {\n        if (compareString) {\n            return {\n                type: 'lessThan',\n                text: compareString.trim()\n            };\n        }\n    }\n\n    if (keyword.startsWith('=')) {\n        if (isNumber(compareString)) {\n            return {\n                type: 'equals',\n                text: Number(keyword.slice(1).trim())\n            };\n        }\n    }\n\n    if (isNumber(compareString)) {\n        return {\n            type: 'containsNumber',\n            text: compareString\n        };\n    }\n\n    if (keyword.startsWith('!=')) {\n        if (isNumber(compareString)) {\n            return {\n                type: 'notEquals',\n                text: Number(keyword.slice(2).trim())\n            };\n        }\n    }\n\n    if (keyword.split(':').length === 2) {\n        compareString = keyword.split(':');\n        return {\n            type: 'range',\n            text: compareString.map(v => v.trim())\n        };\n    }\n\n    return {\n        type: 'contains',\n        text: compareString.toLowerCase()\n    };\n}\n\nfunction getDefaultOptions(instance) {\n    return {\n        columns: [],\n        data: [],\n        dropdownButton: icons.chevronDown,\n        headerDropdown: [\n            {\n                label: instance.translate('Sort Ascending'),\n                action: function (column) {\n                    this.sortColumn(column.colIndex, 'asc');\n                }\n            },\n            {\n                label: instance.translate('Sort Descending'),\n                action: function (column) {\n                    this.sortColumn(column.colIndex, 'desc');\n                }\n            },\n            {\n                label: instance.translate('Reset sorting'),\n                action: function (column) {\n                    this.sortColumn(column.colIndex, 'none');\n                }\n            },\n            {\n                label: instance.translate('Remove column'),\n                action: function (column) {\n                    this.removeColumn(column.colIndex);\n                }\n            }\n        ],\n        events: {\n            onRemoveColumn(column) {},\n            onSwitchColumn(column1, column2) {},\n            onSortColumn(column) {},\n            onCheckRow(row) {},\n            onDestroy() {}\n        },\n        hooks: {\n            columnTotal: null\n        },\n        sortIndicator: {\n            asc: '\u2191',\n            desc: '\u2193',\n            none: ''\n        },\n        overrideComponents: {\n            // ColumnManager: CustomColumnManager\n        },\n        filterRows: filterRows,\n        freezeMessage: '',\n        getEditor: null,\n        serialNoColumn: true,\n        checkboxColumn: false,\n        clusterize: true,\n        logs: false,\n        layout: 'fixed', // fixed, fluid, ratio\n        noDataMessage: instance.translate('No Data'),\n        cellHeight: 40,\n        minimumColumnWidth: 30,\n        inlineFilters: false,\n        treeView: false,\n        checkedRowStatus: true,\n        dynamicRowHeight: false,\n        pasteFromClipboard: false,\n        showTotalRow: false,\n        direction: 'ltr',\n        disableReorderColumn: false\n    };\n}\n\nlet defaultComponents = {\n    DataManager,\n    CellManager,\n    ColumnManager,\n    RowManager,\n    BodyRenderer,\n    Style,\n    Keyboard\n};\n\nclass DataTable {\n    constructor(wrapper, options) {\n        DataTable.instances++;\n\n        if (typeof wrapper === 'string') {\n            // css selector\n            wrapper = document.querySelector(wrapper);\n        }\n        this.wrapper = wrapper;\n        if (!(this.wrapper instanceof HTMLElement)) {\n            throw new Error('Invalid argument given for `wrapper`');\n        }\n\n        this.initializeTranslations(options);\n        this.setDefaultOptions();\n        this.buildOptions(options);\n        this.prepare();\n        this.initializeComponents();\n\n        if (this.options.data) {\n            this.refresh();\n            this.columnmanager.applyDefaultSortOrder();\n        }\n    }\n\n    initializeTranslations(options) {\n        this.language = options.language || 'en';\n        this.translationManager = new TranslationManager(this.language);\n\n        if (options.translations) {\n            this.translationManager.addTranslations(options.translations);\n        }\n    }\n\n    setDefaultOptions() {\n        this.DEFAULT_OPTIONS = getDefaultOptions(this);\n    }\n\n    buildOptions(options) {\n        this.options = this.options || {};\n\n        this.options = Object.assign(\n            {}, this.DEFAULT_OPTIONS,\n            this.options || {}, options\n        );\n\n        options.headerDropdown = options.headerDropdown || [];\n        this.options.headerDropdown = [\n            ...this.DEFAULT_OPTIONS.headerDropdown,\n            ...options.headerDropdown\n        ];\n\n        // custom user events\n        this.events = Object.assign(\n            {}, this.DEFAULT_OPTIONS.events,\n            this.options.events || {},\n            options.events || {}\n        );\n        this.fireEvent = this.fireEvent.bind(this);\n    }\n\n    prepare() {\n        this.prepareDom();\n        this.unfreeze();\n    }\n\n    initializeComponents() {\n        let components = Object.assign({}, defaultComponents, this.options.overrideComponents);\n        let {\n            Style: Style$$1,\n            Keyboard: Keyboard$$1,\n            DataManager: DataManager$$1,\n            RowManager: RowManager$$1,\n            ColumnManager: ColumnManager$$1,\n            CellManager: CellManager$$1,\n            BodyRenderer: BodyRenderer$$1\n        } = components;\n\n        this.style = new Style$$1(this);\n        this.keyboard = new Keyboard$$1(this.wrapper);\n        this.datamanager = new DataManager$$1(this.options);\n        this.rowmanager = new RowManager$$1(this);\n        this.columnmanager = new ColumnManager$$1(this);\n        this.cellmanager = new CellManager$$1(this);\n        this.bodyRenderer = new BodyRenderer$$1(this);\n    }\n\n    prepareDom() {\n        this.wrapper.innerHTML = `\n            <div class=\"datatable\" dir=\"${this.options.direction}\">\n                <div class=\"dt-header\"></div>\n                <div class=\"dt-scrollable\"></div>\n                <div class=\"dt-footer\"></div>\n                <div class=\"dt-freeze\">\n                    <span class=\"dt-freeze__message\">\n                        ${this.options.freezeMessage}\n                    </span>\n                </div>\n                <div class=\"dt-toast\"></div>\n                <div class=\"dt-dropdown-container\"></div>\n                <textarea class=\"dt-paste-target\"></textarea>\n            </div>\n        `;\n\n        this.datatableWrapper = $('.datatable', this.wrapper);\n        this.header = $('.dt-header', this.wrapper);\n        this.footer = $('.dt-footer', this.wrapper);\n        this.bodyScrollable = $('.dt-scrollable', this.wrapper);\n        this.freezeContainer = $('.dt-freeze', this.wrapper);\n        this.toastMessage = $('.dt-toast', this.wrapper);\n        this.pasteTarget = $('.dt-paste-target', this.wrapper);\n        this.dropdownContainer = $('.dt-dropdown-container', this.wrapper);\n    }\n\n    refresh(data, columns) {\n        this.datamanager.init(data, columns);\n        this.render();\n        this.setDimensions();\n    }\n\n    destroy() {\n        this.wrapper.innerHTML = '';\n        this.style.destroy();\n        this.fireEvent('onDestroy');\n    }\n\n    appendRows(rows) {\n        this.datamanager.appendRows(rows);\n        this.rowmanager.refreshRows();\n    }\n\n    refreshRow(row, rowIndex) {\n        this.rowmanager.refreshRow(row, rowIndex);\n    }\n\n    render() {\n        this.renderHeader();\n        this.renderBody();\n    }\n\n    renderHeader() {\n        this.columnmanager.renderHeader();\n    }\n\n    renderBody() {\n        this.bodyRenderer.render();\n    }\n\n    setDimensions() {\n        this.style.setDimensions();\n    }\n\n    showToastMessage(message, hideAfter) {\n        this.bodyRenderer.showToastMessage(message, hideAfter);\n    }\n\n    clearToastMessage() {\n        this.bodyRenderer.clearToastMessage();\n    }\n\n    getColumn(colIndex) {\n        return this.datamanager.getColumn(colIndex);\n    }\n\n    getColumns() {\n        return this.datamanager.getColumns();\n    }\n\n    getRows() {\n        return this.datamanager.getRows();\n    }\n\n    getCell(colIndex, rowIndex) {\n        return this.datamanager.getCell(colIndex, rowIndex);\n    }\n\n    getColumnHeaderElement(colIndex) {\n        return this.columnmanager.getColumnHeaderElement(colIndex);\n    }\n\n    getViewportHeight() {\n        if (!this.viewportHeight) {\n            this.viewportHeight = $.style(this.bodyScrollable, 'height');\n        }\n\n        return this.viewportHeight;\n    }\n\n    sortColumn(colIndex, sortOrder) {\n        this.columnmanager.sortColumn(colIndex, sortOrder);\n    }\n\n    removeColumn(colIndex) {\n        this.columnmanager.removeColumn(colIndex);\n    }\n\n    scrollToLastColumn() {\n        this.datatableWrapper.scrollLeft = 9999;\n    }\n\n    freeze() {\n        $.style(this.freezeContainer, {\n            display: ''\n        });\n    }\n\n    unfreeze() {\n        $.style(this.freezeContainer, {\n            display: 'none'\n        });\n    }\n\n    updateOptions(options) {\n        this.buildOptions(options);\n    }\n\n    fireEvent(eventName, ...args) {\n        // fire internalEventHandlers if any\n        // and then user events\n        const handlers = [\n            ...(this._internalEventHandlers[eventName] || []),\n            this.events[eventName]\n        ].filter(Boolean);\n\n        for (let handler of handlers) {\n            handler.apply(this, args);\n        }\n    }\n\n    on(event, handler) {\n        this._internalEventHandlers = this._internalEventHandlers || {};\n        this._internalEventHandlers[event] = this._internalEventHandlers[event] || [];\n        this._internalEventHandlers[event].push(handler);\n    }\n\n    log() {\n        if (this.options.logs) {\n            console.log.apply(console, arguments);\n        }\n    }\n\n    translate(str, args) {\n        return this.translationManager.translate(str, args);\n    }\n}\n\nDataTable.instances = 0;\n\nvar name = \"frappe-datatable\";\nvar version = \"0.0.0-development\";\nvar description = \"A modern datatable library for the web\";\nvar main = \"dist/frappe-datatable.cjs.js\";\nvar unpkg = \"dist/frappe-datatable.min.js\";\nvar jsdelivr = \"dist/frappe-datatable.min.js\";\nvar scripts = {\"start\":\"yarn run dev\",\"build\":\"rollup -c && NODE_ENV=production rollup -c\",\"dev\":\"rollup -c -w\",\"cy:server\":\"http-server -p 8989\",\"cy:open\":\"cypress open\",\"cy:run\":\"cypress run\",\"test\":\"start-server-and-test cy:server http://localhost:8989 cy:run\",\"test-local\":\"start-server-and-test cy:server http://localhost:8989 cy:open\",\"travis-deploy-once\":\"travis-deploy-once\",\"semantic-release\":\"semantic-release\",\"lint\":\"eslint src\",\"lint-and-build\":\"yarn lint && yarn build\",\"commit\":\"npx git-cz\"};\nvar files = [\"dist\",\"src\"];\nvar devDependencies = {\"autoprefixer\":\"^9.0.0\",\"chai\":\"3.5.0\",\"cypress\":\"^9.2.0\",\"cz-conventional-changelog\":\"^2.1.0\",\"deepmerge\":\"^2.0.1\",\"eslint\":\"^5.0.1\",\"eslint-config-airbnb\":\"^16.1.0\",\"eslint-config-airbnb-base\":\"^12.1.0\",\"eslint-plugin-import\":\"^2.11.0\",\"http-server\":\"^0.11.1\",\"mocha\":\"3.3.0\",\"postcss-custom-properties\":\"^7.0.0\",\"postcss-nested\":\"^3.0.0\",\"rollup\":\"^0.59.4\",\"rollup-plugin-commonjs\":\"^8.3.0\",\"rollup-plugin-eslint\":\"^4.0.0\",\"rollup-plugin-json\":\"^2.3.0\",\"rollup-plugin-node-resolve\":\"^3.0.3\",\"rollup-plugin-postcss\":\"^1.2.8\",\"rollup-plugin-uglify-es\":\"^0.0.1\",\"semantic-release\":\"^17.1.1\",\"start-server-and-test\":\"^1.4.1\",\"travis-deploy-once\":\"^5.0.1\"};\nvar repository = {\"type\":\"git\",\"url\":\"https://github.com/frappe/datatable.git\"};\nvar keywords = [\"datatable\",\"data\",\"grid\",\"table\"];\nvar author = \"Faris Ansari\";\nvar license = \"MIT\";\nvar bugs = {\"url\":\"https://github.com/frappe/datatable/issues\"};\nvar homepage = \"https://frappe.io/datatable\";\nvar dependencies = {\"hyperlist\":\"^1.0.0-beta\",\"lodash\":\"^4.17.5\",\"sortablejs\":\"^1.7.0\"};\nvar config = {\"commitizen\":{\"path\":\"cz-conventional-changelog\"}};\nvar packageJson = {\n\tname: name,\n\tversion: version,\n\tdescription: description,\n\tmain: main,\n\tunpkg: unpkg,\n\tjsdelivr: jsdelivr,\n\tscripts: scripts,\n\tfiles: files,\n\tdevDependencies: devDependencies,\n\trepository: repository,\n\tkeywords: keywords,\n\tauthor: author,\n\tlicense: license,\n\tbugs: bugs,\n\thomepage: homepage,\n\tdependencies: dependencies,\n\tconfig: config\n};\n\nDataTable.__version__ = packageJson.version;\n\nmodule.exports = DataTable;\n", "// Copyright (c) 2015, Frappe Technologies Pvt. Ltd. and Contributors\n// License: GNU General Public License v3. See license.txt\n\nerpnext.taxes_and_totals = class TaxesAndTotals extends erpnext.payments {\n\tsetup() {\n\t\tthis.fetch_round_off_accounts();\n\t}\n\n\tapply_pricing_rule_on_item(item) {\n\t\tlet effective_item_rate = item.price_list_rate;\n\t\tlet item_rate = item.rate;\n\t\tif (in_list([\"Sales Order\", \"Quotation\"], item.parenttype) && item.blanket_order_rate) {\n\t\t\teffective_item_rate = item.blanket_order_rate;\n\t\t}\n\t\tif (item.margin_type == \"Percentage\") {\n\t\t\titem.rate_with_margin = flt(effective_item_rate)\n\t\t\t\t+ flt(effective_item_rate) * ( flt(item.margin_rate_or_amount) / 100);\n\t\t} else {\n\t\t\titem.rate_with_margin = flt(effective_item_rate) + flt(item.margin_rate_or_amount);\n\t\t}\n\t\titem.base_rate_with_margin = flt(item.rate_with_margin) * flt(this.frm.doc.conversion_rate);\n\n\t\titem_rate = flt(item.rate_with_margin , precision(\"rate\", item));\n\n\t\tif (item.discount_percentage) {\n\t\t\titem.discount_amount = flt(item.rate_with_margin) * flt(item.discount_percentage) / 100;\n\t\t}\n\n\t\tif (item.discount_amount) {\n\t\t\titem_rate = flt((item.rate_with_margin) - (item.discount_amount), precision('rate', item));\n\t\t\titem.discount_percentage = 100 * flt(item.discount_amount) / flt(item.rate_with_margin);\n\t\t}\n\n\t\tfrappe.model.set_value(item.doctype, item.name, \"rate\", item_rate);\n\t}\n\n\tcalculate_taxes_and_totals(update_paid_amount) {\n\t\tthis.discount_amount_applied = false;\n\t\tthis._calculate_taxes_and_totals();\n\t\tthis.calculate_discount_amount();\n\n\t\t// Advance calculation applicable to Sales /Purchase Invoice\n\t\tif(in_list([\"Sales Invoice\", \"POS Invoice\", \"Purchase Invoice\"], this.frm.doc.doctype)\n\t\t\t&& this.frm.doc.docstatus < 2 && !this.frm.doc.is_return) {\n\t\t\tthis.calculate_total_advance(update_paid_amount);\n\t\t}\n\n\t\tif (in_list([\"Sales Invoice\", \"POS Invoice\"], this.frm.doc.doctype) && this.frm.doc.is_pos &&\n\t\t\tthis.frm.doc.is_return) {\n\t\t\tthis.update_paid_amount_for_return();\n\t\t}\n\n\t\t// Sales person's commission\n\t\tif(in_list([\"Quotation\", \"Sales Order\", \"Delivery Note\", \"Sales Invoice\",\"Proforma Invoice\"], this.frm.doc.doctype)) {\n\t\t\tthis.calculate_commission();\n\t\t\tthis.calculate_contribution();\n\t\t}\n\n\t\t// Update paid amount on return/debit note creation\n\t\tif(this.frm.doc.doctype === \"Purchase Invoice\" && this.frm.doc.is_return\n\t\t\t&& (this.frm.doc.grand_total > this.frm.doc.paid_amount)) {\n\t\t\tthis.frm.doc.paid_amount = flt(this.frm.doc.grand_total, precision(\"grand_total\"));\n\t\t}\n\n\t\tthis.frm.refresh_fields();\n\t}\n\n\tcalculate_discount_amount() {\n\t\tif (frappe.meta.get_docfield(this.frm.doc.doctype, \"discount_amount\")) {\n\t\t\tthis.calculate_item_values();\n\t\t\tthis.calculate_net_total();\n\t\t\tthis.set_discount_amount();\n\t\t\tthis.apply_discount_amount();\n\t\t}\n\t}\n\n\t_calculate_taxes_and_totals() {\n\t\tthis.validate_conversion_rate();\n\t\tthis.calculate_item_values();\n\t\tthis.initialize_taxes();\n\t\tthis.determine_exclusive_rate();\n\t\tthis.calculate_net_total();\n\t\tthis.calculate_taxes();\n\t\tthis.manipulate_grand_total_for_inclusive_tax();\n\t\tthis.calculate_totals();\n\t\tthis._cleanup();\n\t}\n\n\tvalidate_conversion_rate() {\n\t\tthis.frm.doc.conversion_rate = flt(this.frm.doc.conversion_rate, (cur_frm) ? precision(\"conversion_rate\") : 9);\n\t\tvar conversion_rate_label = frappe.meta.get_label(this.frm.doc.doctype, \"conversion_rate\",\n\t\t\tthis.frm.doc.name);\n\t\tvar company_currency = this.get_company_currency();\n\n\t\tif(!this.frm.doc.conversion_rate) {\n\t\t\tif(this.frm.doc.currency == company_currency) {\n\t\t\t\tthis.frm.set_value(\"conversion_rate\", 1);\n\t\t\t} else {\n\t\t\t\tconst subs =  [conversion_rate_label, this.frm.doc.currency, company_currency];\n\t\t\t\tconst err_message = __('{0} is mandatory. Maybe Currency Exchange record is not created for {1} to {2}', subs);\n\t\t\t\tfrappe.throw(err_message);\n\t\t\t}\n\t\t}\n\t}\n\n\tcalculate_item_values() {\n\t\tlet me = this;\n\t\tif (!this.discount_amount_applied) {\n\t\t\t$.each(this.frm.doc[\"items\"] || [], function(i, item) {\n\t\t\t\tfrappe.model.round_floats_in(item);\n\t\t\t\titem.net_rate = item.rate;\n\n\t\t\t\tif ((!item.qty) && me.frm.doc.is_return) {\n\t\t\t\t\titem.amount = flt(item.rate * -1, precision(\"amount\", item));\n\t\t\t\t} \n\t\t\t\telse if (item.uom == 'Percent') {\n\t\t\t\t\titem.amount = flt((item.rate * item.qty)/100, precision(\"amount\", item)); //changes only for civil tech\n\t\t\t\t} else {\n\t\t\t\t\titem.amount = flt(item.rate * item.qty, precision(\"amount\", item));\n\t\t\t\t}\n\n\t\t\t\titem.net_amount = item.amount;\n\t\t\t\titem.item_tax_amount = 0.0;\n\t\t\t\titem.total_weight = flt(item.weight_per_unit * item.stock_qty);\n\n\t\t\t\tme.set_in_company_currency(item, [\"price_list_rate\", \"rate\", \"amount\", \"net_rate\", \"net_amount\"]);\n\t\t\t});\n\t\t}\n\t}\n\n\tset_in_company_currency(doc, fields) {\n\t\tvar me = this;\n\t\t$.each(fields, function(i, f) {\n\t\t\tdoc[\"base_\"+f] = flt(flt(doc[f], precision(f, doc)) * me.frm.doc.conversion_rate, precision(\"base_\" + f, doc));\n\t\t});\n\t}\n\n\tinitialize_taxes() {\n\t\tvar me = this;\n\n\t\t$.each(this.frm.doc[\"taxes\"] || [], function(i, tax) {\n\t\t\ttax.item_wise_tax_detail = {};\n\t\t\tvar tax_fields = [\"total\", \"tax_amount_after_discount_amount\",\n\t\t\t\t\"tax_amount_for_current_item\", \"grand_total_for_current_item\",\n\t\t\t\t\"tax_fraction_for_current_item\", \"grand_total_fraction_for_current_item\"];\n\n\t\t\tif (cstr(tax.charge_type) != \"Actual\" &&\n\t\t\t\t!(me.discount_amount_applied && me.frm.doc.apply_discount_on==\"Grand Total\")) {\n\t\t\t\ttax_fields.push(\"tax_amount\");\n\t\t\t}\n\n\t\t\t$.each(tax_fields, function(i, fieldname) { tax[fieldname] = 0.0; });\n\n\t\t\tif (!this.discount_amount_applied && cur_frm) {\n\t\t\t\tcur_frm.cscript.validate_taxes_and_charges(tax.doctype, tax.name);\n\t\t\t\tme.validate_inclusive_tax(tax);\n\t\t\t}\n\t\t\tfrappe.model.round_floats_in(tax);\n\t\t});\n\t}\n\n\tfetch_round_off_accounts() {\n\t\tlet me = this;\n\t\tfrappe.flags.round_off_applicable_accounts = [];\n\n\t\tif (me.frm.doc.company) {\n\t\t\treturn frappe.call({\n\t\t\t\t\"method\": \"erpnext.controllers.taxes_and_totals.get_round_off_applicable_accounts\",\n\t\t\t\t\"args\": {\n\t\t\t\t\t\"company\": me.frm.doc.company,\n\t\t\t\t\t\"account_list\": frappe.flags.round_off_applicable_accounts\n\t\t\t\t},\n\t\t\t\tcallback: function(r) {\n\t\t\t\t\tfrappe.flags.round_off_applicable_accounts.push(r.message);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tdetermine_exclusive_rate() {\n\t\tvar me = this;\n\n\t\tvar has_inclusive_tax = false;\n\t\t$.each(me.frm.doc[\"taxes\"] || [], function(i, row) {\n\t\t\tif(cint(row.included_in_print_rate)) has_inclusive_tax = true;\n\t\t});\n\t\tif(has_inclusive_tax==false) return;\n\n\t\t$.each(me.frm.doc[\"items\"] || [], function(n, item) {\n\t\t\tvar item_tax_map = me._load_item_tax_rate(item.item_tax_rate);\n\t\t\tvar cumulated_tax_fraction = 0.0;\n\t\t\tvar total_inclusive_tax_amount_per_qty = 0;\n\t\t\t$.each(me.frm.doc[\"taxes\"] || [], function(i, tax) {\n\t\t\t\tvar current_tax_fraction = me.get_current_tax_fraction(tax, item_tax_map);\n\t\t\t\ttax.tax_fraction_for_current_item = current_tax_fraction[0];\n\t\t\t\tvar inclusive_tax_amount_per_qty = current_tax_fraction[1];\n\n\t\t\t\tif(i==0) {\n\t\t\t\t\ttax.grand_total_fraction_for_current_item = 1 + tax.tax_fraction_for_current_item;\n\t\t\t\t} else {\n\t\t\t\t\ttax.grand_total_fraction_for_current_item =\n\t\t\t\t\t\tme.frm.doc[\"taxes\"][i-1].grand_total_fraction_for_current_item +\n\t\t\t\t\t\ttax.tax_fraction_for_current_item;\n\t\t\t\t}\n\n\t\t\t\tcumulated_tax_fraction += tax.tax_fraction_for_current_item;\n\t\t\t\ttotal_inclusive_tax_amount_per_qty += inclusive_tax_amount_per_qty * flt(item.qty);\n\t\t\t});\n\n\t\t\tif(!me.discount_amount_applied && item.qty && (total_inclusive_tax_amount_per_qty || cumulated_tax_fraction)) {\n\t\t\t\tvar amount = flt(item.amount) - total_inclusive_tax_amount_per_qty;\n\t\t\t\titem.net_amount = flt(amount / (1 + cumulated_tax_fraction));\n\t\t\t\titem.net_rate = item.qty ? flt(item.net_amount / item.qty, precision(\"net_rate\", item)) : 0;\n\n\t\t\t\tme.set_in_company_currency(item, [\"net_rate\", \"net_amount\"]);\n\t\t\t}\n\t\t});\n\t}\n\n\tget_current_tax_fraction(tax, item_tax_map) {\n\t\t// Get tax fraction for calculating tax exclusive amount\n\t\t// from tax inclusive amount\n\t\tvar current_tax_fraction = 0.0;\n\t\tvar inclusive_tax_amount_per_qty = 0;\n\n\t\tif(cint(tax.included_in_print_rate)) {\n\t\t\tvar tax_rate = this._get_tax_rate(tax, item_tax_map);\n\n\t\t\tif(tax.charge_type == \"On Net Total\") {\n\t\t\t\tcurrent_tax_fraction = (tax_rate / 100.0);\n\n\t\t\t} else if(tax.charge_type == \"On Previous Row Amount\") {\n\t\t\t\tcurrent_tax_fraction = (tax_rate / 100.0) *\n\t\t\t\t\tthis.frm.doc[\"taxes\"][cint(tax.row_id) - 1].tax_fraction_for_current_item;\n\n\t\t\t} else if(tax.charge_type == \"On Previous Row Total\") {\n\t\t\t\tcurrent_tax_fraction = (tax_rate / 100.0) *\n\t\t\t\t\tthis.frm.doc[\"taxes\"][cint(tax.row_id) - 1].grand_total_fraction_for_current_item;\n\t\t\t} else if (tax.charge_type == \"On Item Quantity\") {\n\t\t\t\tinclusive_tax_amount_per_qty = flt(tax_rate);\n\t\t\t}\n\t\t}\n\n\t\tif(tax.add_deduct_tax && tax.add_deduct_tax == \"Deduct\") {\n\t\t\tcurrent_tax_fraction *= -1;\n\t\t\tinclusive_tax_amount_per_qty *= -1;\n\t\t}\n\t\treturn [current_tax_fraction, inclusive_tax_amount_per_qty];\n\t}\n\n\t_get_tax_rate(tax, item_tax_map) {\n\t\treturn (Object.keys(item_tax_map).indexOf(tax.account_head) != -1) ?\n\t\t\tflt(item_tax_map[tax.account_head], precision(\"rate\", tax)) : tax.rate;\n\t}\n\n\tcalculate_net_total() {\n\t\tvar me = this;\n\t\tthis.frm.doc.total_qty = this.frm.doc.total = this.frm.doc.base_total = this.frm.doc.net_total = this.frm.doc.base_net_total = 0.0;\n\n\t\t$.each(this.frm.doc[\"items\"] || [], function(i, item) {\n\t\t\tme.frm.doc.total += item.amount;\n\t\t\tme.frm.doc.total_qty += item.qty;\n\t\t\tme.frm.doc.base_total += item.base_amount;\n\t\t\tme.frm.doc.net_total += item.net_amount;\n\t\t\tme.frm.doc.base_net_total += item.base_net_amount;\n\t\t\t});\n\n\t\tfrappe.model.round_floats_in(this.frm.doc, [\"total\", \"base_total\", \"net_total\", \"base_net_total\"]);\n\t}\n\n\tadd_taxes_from_item_tax_template(item_tax_map) {\n\t\tlet me = this;\n\n\t\tif (item_tax_map && cint(frappe.defaults.get_default(\"add_taxes_from_item_tax_template\"))) {\n\t\t\tif (typeof (item_tax_map) == \"string\") {\n\t\t\t\titem_tax_map = JSON.parse(item_tax_map);\n\t\t\t}\n\n\t\t\t$.each(item_tax_map, function(tax, rate) {\n\t\t\t\tlet found = (me.frm.doc.taxes || []).find(d => d.account_head === tax);\n\t\t\t\tif (!found) {\n\t\t\t\t\tlet child = frappe.model.add_child(me.frm.doc, \"taxes\");\n\t\t\t\t\tchild.charge_type = \"On Net Total\";\n\t\t\t\t\tchild.account_head = tax;\n\t\t\t\t\tchild.rate = 0;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tcalculate_taxes() {\n\t\tvar me = this;\n\t\tthis.frm.doc.rounding_adjustment = 0;\n\t\tvar actual_tax_dict = {};\n\n\t\t// maintain actual tax rate based on idx\n\t\t$.each(this.frm.doc[\"taxes\"] || [], function(i, tax) {\n\t\t\tif (tax.charge_type == \"Actual\") {\n\t\t\t\tactual_tax_dict[tax.idx] = flt(tax.tax_amount, precision(\"tax_amount\", tax));\n\t\t\t}\n\t\t});\n\n\t\t$.each(this.frm.doc[\"items\"] || [], function(n, item) {\n\t\t\tvar item_tax_map = me._load_item_tax_rate(item.item_tax_rate);\n\t\t\t$.each(me.frm.doc[\"taxes\"] || [], function(i, tax) {\n\t\t\t\t// tax_amount represents the amount of tax for the current step\n\t\t\t\tvar current_tax_amount = me.get_current_tax_amount(item, tax, item_tax_map);\n\n\t\t\t\t// Adjust divisional loss to the last item\n\t\t\t\tif (tax.charge_type == \"Actual\") {\n\t\t\t\t\tactual_tax_dict[tax.idx] -= current_tax_amount;\n\t\t\t\t\tif (n == me.frm.doc[\"items\"].length - 1) {\n\t\t\t\t\t\tcurrent_tax_amount += actual_tax_dict[tax.idx];\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// accumulate tax amount into tax.tax_amount\n\t\t\t\tif (tax.charge_type != \"Actual\" &&\n\t\t\t\t\t!(me.discount_amount_applied && me.frm.doc.apply_discount_on==\"Grand Total\")) {\n\t\t\t\t\ttax.tax_amount += current_tax_amount;\n\t\t\t\t}\n\n\t\t\t\t// store tax_amount for current item as it will be used for\n\t\t\t\t// charge type = 'On Previous Row Amount'\n\t\t\t\ttax.tax_amount_for_current_item = current_tax_amount;\n\n\t\t\t\t// tax amount after discount amount\n\t\t\t\ttax.tax_amount_after_discount_amount += current_tax_amount;\n\n\t\t\t\t// for buying\n\t\t\t\tif(tax.category) {\n\t\t\t\t\t// if just for valuation, do not add the tax amount in total\n\t\t\t\t\t// hence, setting it as 0 for further steps\n\t\t\t\t\tcurrent_tax_amount = (tax.category == \"Valuation\") ? 0.0 : current_tax_amount;\n\n\t\t\t\t\tcurrent_tax_amount *= (tax.add_deduct_tax == \"Deduct\") ? -1.0 : 1.0;\n\t\t\t\t}\n\n\t\t\t\t// note: grand_total_for_current_item contains the contribution of\n\t\t\t\t// item's amount, previously applied tax and the current tax on that item\n\t\t\t\tif(i==0) {\n\t\t\t\t\ttax.grand_total_for_current_item = flt(item.net_amount + current_tax_amount);\n\t\t\t\t} else {\n\t\t\t\t\ttax.grand_total_for_current_item =\n\t\t\t\t\t\tflt(me.frm.doc[\"taxes\"][i-1].grand_total_for_current_item + current_tax_amount);\n\t\t\t\t}\n\n\t\t\t\t// set precision in the last item iteration\n\t\t\t\tif (n == me.frm.doc[\"items\"].length - 1) {\n\t\t\t\t\tme.round_off_totals(tax);\n\t\t\t\t\tme.set_in_company_currency(tax,\n\t\t\t\t\t\t[\"tax_amount\", \"tax_amount_after_discount_amount\"]);\n\n\t\t\t\t\tme.round_off_base_values(tax);\n\n\t\t\t\t\t// in tax.total, accumulate grand total for each item\n\t\t\t\t\tme.set_cumulative_total(i, tax);\n\n\t\t\t\t\tme.set_in_company_currency(tax, [\"total\"]);\n\n\t\t\t\t\t// adjust Discount Amount loss in last tax iteration\n\t\t\t\t\tif ((i == me.frm.doc[\"taxes\"].length - 1) && me.discount_amount_applied\n\t\t\t\t\t\t&& me.frm.doc.apply_discount_on == \"Grand Total\" && me.frm.doc.discount_amount) {\n\t\t\t\t\t\tme.frm.doc.rounding_adjustment = flt(me.frm.doc.grand_total -\n\t\t\t\t\t\t\tflt(me.frm.doc.discount_amount) - tax.total, precision(\"rounding_adjustment\"));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\n\tset_cumulative_total(row_idx, tax) {\n\t\tvar tax_amount = tax.tax_amount_after_discount_amount;\n\t\tif (tax.category == 'Valuation') {\n\t\t\ttax_amount = 0;\n\t\t}\n\n\t\tif (tax.add_deduct_tax == \"Deduct\") { tax_amount = -1*tax_amount; }\n\n\t\tif(row_idx==0) {\n\t\t\ttax.total = flt(this.frm.doc.net_total + tax_amount, precision(\"total\", tax));\n\t\t} else {\n\t\t\ttax.total = flt(this.frm.doc[\"taxes\"][row_idx-1].total + tax_amount, precision(\"total\", tax));\n\t\t}\n\t}\n\n\t_load_item_tax_rate(item_tax_rate) {\n\t\treturn item_tax_rate ? JSON.parse(item_tax_rate) : {};\n\t}\n\n\tget_current_tax_amount(item, tax, item_tax_map) {\n\t\tvar tax_rate = this._get_tax_rate(tax, item_tax_map);\n\t\tvar current_tax_amount = 0.0;\n\n\t\t// To set row_id by default as previous row.\n\t\tif([\"On Previous Row Amount\", \"On Previous Row Total\"].includes(tax.charge_type)) {\n\t\t\tif (tax.idx === 1) {\n\t\t\t\tfrappe.throw(\n\t\t\t\t\t__(\"Cannot select charge type as 'On Previous Row Amount' or 'On Previous Row Total' for first row\"));\n\t\t\t}\n\t\t\tif (!tax.row_id) {\n\t\t\t\ttax.row_id = tax.idx - 1;\n\t\t\t}\n\t\t}\n\t\tif(tax.charge_type == \"Actual\") {\n\t\t\t// distribute the tax amount proportionally to each item row\n\t\t\tvar actual = flt(tax.tax_amount, precision(\"tax_amount\", tax));\n\t\t\tcurrent_tax_amount = this.frm.doc.net_total ?\n\t\t\t\t((item.net_amount / this.frm.doc.net_total) * actual) : 0.0;\n\n\t\t} else if(tax.charge_type == \"On Net Total\") {\n\t\t\tcurrent_tax_amount = (tax_rate / 100.0) * item.net_amount;\n\t\t} else if(tax.charge_type == \"On Previous Row Amount\") {\n\t\t\tcurrent_tax_amount = (tax_rate / 100.0) *\n\t\t\t\tthis.frm.doc[\"taxes\"][cint(tax.row_id) - 1].tax_amount_for_current_item;\n\n\t\t} else if(tax.charge_type == \"On Previous Row Total\") {\n\t\t\tcurrent_tax_amount = (tax_rate / 100.0) *\n\t\t\t\tthis.frm.doc[\"taxes\"][cint(tax.row_id) - 1].grand_total_for_current_item;\n\t\t} else if (tax.charge_type == \"On Item Quantity\") {\n\t\t\tcurrent_tax_amount = tax_rate * item.qty;\n\t\t}\n\n\t\tthis.set_item_wise_tax(item, tax, tax_rate, current_tax_amount);\n\n\t\treturn current_tax_amount;\n\t}\n\n\tset_item_wise_tax(item, tax, tax_rate, current_tax_amount) {\n\t\t// store tax breakup for each item\n\t\tlet tax_detail = tax.item_wise_tax_detail;\n\t\tlet key = item.item_code || item.item_name;\n\n\t\tif(typeof (tax_detail) == \"string\") {\n\t\t\ttax.item_wise_tax_detail = JSON.parse(tax.item_wise_tax_detail);\n\t\t\ttax_detail = tax.item_wise_tax_detail;\n\t\t}\n\n\t\tlet item_wise_tax_amount = current_tax_amount * this.frm.doc.conversion_rate;\n\t\tif (tax_detail && tax_detail[key])\n\t\t\titem_wise_tax_amount += tax_detail[key][1];\n\n\t\ttax_detail[key] = [tax_rate, flt(item_wise_tax_amount, precision(\"base_tax_amount\", tax))];\n\t}\n\n\tround_off_totals(tax) {\n\t\tif (frappe.flags.round_off_applicable_accounts.includes(tax.account_head)) {\n\t\t\ttax.tax_amount= Math.round(tax.tax_amount);\n\t\t\ttax.tax_amount_after_discount_amount = Math.round(tax.tax_amount_after_discount_amount);\n\t\t}\n\n\t\ttax.tax_amount = flt(tax.tax_amount, precision(\"tax_amount\", tax));\n\t\ttax.tax_amount_after_discount_amount = flt(tax.tax_amount_after_discount_amount, precision(\"tax_amount\", tax));\n\t}\n\n\tround_off_base_values(tax) {\n\t\tif (frappe.flags.round_off_applicable_accounts.includes(tax.account_head)) {\n\t\t\ttax.base_tax_amount= Math.round(tax.base_tax_amount);\n\t\t\ttax.base_tax_amount_after_discount_amount = Math.round(tax.base_tax_amount_after_discount_amount);\n\t\t}\n\t}\n\n\tmanipulate_grand_total_for_inclusive_tax() {\n\t\tvar me = this;\n\t\t// if fully inclusive taxes and diff\n\t\tif (this.frm.doc[\"taxes\"] && this.frm.doc[\"taxes\"].length) {\n\t\t\tvar any_inclusive_tax = false;\n\t\t\t$.each(this.frm.doc.taxes || [], function(i, d) {\n\t\t\t\tif(cint(d.included_in_print_rate)) any_inclusive_tax = true;\n\t\t\t});\n\t\t\tif (any_inclusive_tax) {\n\t\t\t\tvar last_tax = me.frm.doc[\"taxes\"].slice(-1)[0];\n\t\t\t\tvar non_inclusive_tax_amount = frappe.utils.sum($.map(this.frm.doc.taxes || [],\n\t\t\t\t\tfunction(d) {\n\t\t\t\t\t\tif(!d.included_in_print_rate) {\n\t\t\t\t\t\t\treturn flt(d.tax_amount_after_discount_amount);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t));\n\t\t\t\tvar diff = me.frm.doc.total + non_inclusive_tax_amount\n\t\t\t\t\t- flt(last_tax.total, precision(\"grand_total\"));\n\n\t\t\t\tif(me.discount_amount_applied && me.frm.doc.discount_amount) {\n\t\t\t\t\tdiff -= flt(me.frm.doc.discount_amount);\n\t\t\t\t}\n\n\t\t\t\tdiff = flt(diff, precision(\"rounding_adjustment\"));\n\n\t\t\t\tif ( diff && Math.abs(diff) <= (5.0 / Math.pow(10, precision(\"tax_amount\", last_tax))) ) {\n\t\t\t\t\tme.frm.doc.rounding_adjustment = diff;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tcalculate_totals() {\n\t\t// Changing sequence can because of rounding adjustment issue and on-screen discrepancy\n\t\tvar me = this;\n\t\tvar tax_count = this.frm.doc[\"taxes\"] ? this.frm.doc[\"taxes\"].length : 0;\n\t\tthis.frm.doc.grand_total = flt(tax_count\n\t\t\t? this.frm.doc[\"taxes\"][tax_count - 1].total + flt(this.frm.doc.rounding_adjustment)\n\t\t\t: this.frm.doc.net_total);\n\n\t\tif(in_list([\"Quotation\", \"Sales Order\", \"Delivery Note\", \"Sales Invoice\", \"POS Invoice\", \"Proforma Invoice\"], this.frm.doc.doctype)) {\n\t\t\tthis.frm.doc.base_grand_total = (this.frm.doc.total_taxes_and_charges) ?\n\t\t\t\tflt(this.frm.doc.grand_total * this.frm.doc.conversion_rate) : this.frm.doc.base_net_total;\n\t\t} else {\n\t\t\t// other charges added/deducted\n\t\t\tthis.frm.doc.taxes_and_charges_added = this.frm.doc.taxes_and_charges_deducted = 0.0;\n\t\t\tif(tax_count) {\n\t\t\t\t$.each(this.frm.doc[\"taxes\"] || [], function(i, tax) {\n\t\t\t\t\tif (in_list([\"Valuation and Total\", \"Total\"], tax.category)) {\n\t\t\t\t\t\tif(tax.add_deduct_tax == \"Add\") {\n\t\t\t\t\t\t\tme.frm.doc.taxes_and_charges_added += flt(tax.tax_amount_after_discount_amount);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tme.frm.doc.taxes_and_charges_deducted += flt(tax.tax_amount_after_discount_amount);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tfrappe.model.round_floats_in(this.frm.doc,\n\t\t\t\t\t[\"taxes_and_charges_added\", \"taxes_and_charges_deducted\"]);\n\t\t\t}\n\n\t\t\tthis.frm.doc.base_grand_total = flt((this.frm.doc.taxes_and_charges_added || this.frm.doc.taxes_and_charges_deducted) ?\n\t\t\t\tflt(this.frm.doc.grand_total * this.frm.doc.conversion_rate) : this.frm.doc.base_net_total);\n\n\t\t\tthis.set_in_company_currency(this.frm.doc,\n\t\t\t\t[\"taxes_and_charges_added\", \"taxes_and_charges_deducted\"]);\n\t\t}\n\n\t\tthis.frm.doc.total_taxes_and_charges = flt(this.frm.doc.grand_total - this.frm.doc.net_total\n\t\t\t- flt(this.frm.doc.rounding_adjustment), precision(\"total_taxes_and_charges\"));\n\n\t\tthis.set_in_company_currency(this.frm.doc, [\"total_taxes_and_charges\", \"rounding_adjustment\"]);\n\n\t\t// Round grand total as per precision\n\t\tfrappe.model.round_floats_in(this.frm.doc, [\"grand_total\", \"base_grand_total\"]);\n\n\t\t// rounded totals\n\t\tthis.set_rounded_total();\n\t}\n\n\tset_rounded_total() {\n\t\tvar disable_rounded_total = 0;\n\t\tif(frappe.meta.get_docfield(this.frm.doc.doctype, \"disable_rounded_total\", this.frm.doc.name)) {\n\t\t\tdisable_rounded_total = this.frm.doc.disable_rounded_total;\n\t\t} else if (frappe.sys_defaults.disable_rounded_total) {\n\t\t\tdisable_rounded_total = frappe.sys_defaults.disable_rounded_total;\n\t\t}\n\n\t\tif (cint(disable_rounded_total)) {\n\t\t\tthis.frm.doc.rounded_total = 0;\n\t\t\tthis.frm.doc.base_rounded_total = 0;\n\t\t\treturn;\n\t\t}\n\n\t\tif(frappe.meta.get_docfield(this.frm.doc.doctype, \"rounded_total\", this.frm.doc.name)) {\n\t\t\tthis.frm.doc.rounded_total = round_based_on_smallest_currency_fraction(this.frm.doc.grand_total,\n\t\t\t\tthis.frm.doc.currency, precision(\"rounded_total\"));\n\t\t\tthis.frm.doc.rounding_adjustment += flt(this.frm.doc.rounded_total - this.frm.doc.grand_total,\n\t\t\t\tprecision(\"rounding_adjustment\"));\n\n\t\t\tthis.set_in_company_currency(this.frm.doc, [\"rounding_adjustment\", \"rounded_total\"]);\n\t\t}\n\t}\n\n\t_cleanup() {\n\t\tthis.frm.doc.base_in_words = this.frm.doc.in_words = \"\";\n\n\t\tif(this.frm.doc[\"items\"] && this.frm.doc[\"items\"].length) {\n\t\t\tif(!frappe.meta.get_docfield(this.frm.doc[\"items\"][0].doctype, \"item_tax_amount\", this.frm.doctype)) {\n\t\t\t\t$.each(this.frm.doc[\"items\"] || [], function(i, item) {\n\t\t\t\t\tdelete item[\"item_tax_amount\"];\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tif(this.frm.doc[\"taxes\"] && this.frm.doc[\"taxes\"].length) {\n\t\t\tvar temporary_fields = [\"tax_amount_for_current_item\", \"grand_total_for_current_item\",\n\t\t\t\t\"tax_fraction_for_current_item\", \"grand_total_fraction_for_current_item\"];\n\n\t\t\tif(!frappe.meta.get_docfield(this.frm.doc[\"taxes\"][0].doctype, \"tax_amount_after_discount_amount\", this.frm.doctype)) {\n\t\t\t\ttemporary_fields.push(\"tax_amount_after_discount_amount\");\n\t\t\t}\n\n\t\t\t$.each(this.frm.doc[\"taxes\"] || [], function(i, tax) {\n\t\t\t\t$.each(temporary_fields, function(i, fieldname) {\n\t\t\t\t\tdelete tax[fieldname];\n\t\t\t\t});\n\n\t\t\t\ttax.item_wise_tax_detail = JSON.stringify(tax.item_wise_tax_detail);\n\t\t\t});\n\t\t}\n\t}\n\n\tset_discount_amount() {\n\t\tif(this.frm.doc.additional_discount_percentage) {\n\t\t\tthis.frm.doc.discount_amount = flt(flt(this.frm.doc[frappe.scrub(this.frm.doc.apply_discount_on)])\n\t\t\t\t* this.frm.doc.additional_discount_percentage / 100, precision(\"discount_amount\"));\n\t\t}\n\t}\n\n\tapply_discount_amount() {\n\t\tvar me = this;\n\t\tvar distributed_amount = 0.0;\n\t\tthis.frm.doc.base_discount_amount = 0.0;\n\n\t\tif (this.frm.doc.discount_amount) {\n\t\t\tif(!this.frm.doc.apply_discount_on)\n\t\t\t\tfrappe.throw(__(\"Please select Apply Discount On\"));\n\n\t\t\tthis.frm.doc.base_discount_amount = flt(this.frm.doc.discount_amount * this.frm.doc.conversion_rate,\n\t\t\t\tprecision(\"base_discount_amount\"));\n\n\t\t\tvar total_for_discount_amount = this.get_total_for_discount_amount();\n\t\t\tvar net_total = 0;\n\t\t\t// calculate item amount after Discount Amount\n\t\t\tif (total_for_discount_amount) {\n\t\t\t\t$.each(this.frm.doc[\"items\"] || [], function(i, item) {\n\t\t\t\t\tdistributed_amount = flt(me.frm.doc.discount_amount) * item.net_amount / total_for_discount_amount;\n\t\t\t\t\titem.net_amount = flt(item.net_amount - distributed_amount,\n\t\t\t\t\t\tprecision(\"base_amount\", item));\n\t\t\t\t\tnet_total += item.net_amount;\n\n\t\t\t\t\t// discount amount rounding loss adjustment if no taxes\n\t\t\t\t\tif ((!(me.frm.doc.taxes || []).length || total_for_discount_amount==me.frm.doc.net_total || (me.frm.doc.apply_discount_on == \"Net Total\"))\n\t\t\t\t\t\t\t&& i == (me.frm.doc.items || []).length - 1) {\n\t\t\t\t\t\tvar discount_amount_loss = flt(me.frm.doc.net_total - net_total\n\t\t\t\t\t\t\t- me.frm.doc.discount_amount, precision(\"net_total\"));\n\t\t\t\t\t\titem.net_amount = flt(item.net_amount + discount_amount_loss,\n\t\t\t\t\t\t\tprecision(\"net_amount\", item));\n\t\t\t\t\t}\n\t\t\t\t\titem.net_rate = item.qty ? flt(item.net_amount / item.qty, precision(\"net_rate\", item)) : 0;\n\t\t\t\t\tme.set_in_company_currency(item, [\"net_rate\", \"net_amount\"]);\n\t\t\t\t});\n\n\t\t\t\tthis.discount_amount_applied = true;\n\t\t\t\tthis._calculate_taxes_and_totals();\n\t\t\t}\n\t\t}\n\t}\n\n\tget_total_for_discount_amount() {\n\t\tif(this.frm.doc.apply_discount_on == \"Net Total\") {\n\t\t\treturn this.frm.doc.net_total;\n\t\t} else {\n\t\t\tvar total_actual_tax = 0.0;\n\t\t\tvar actual_taxes_dict = {};\n\n\t\t\t$.each(this.frm.doc[\"taxes\"] || [], function(i, tax) {\n\t\t\t\tif (in_list([\"Actual\", \"On Item Quantity\"], tax.charge_type)) {\n\t\t\t\t\tvar tax_amount = (tax.category == \"Valuation\") ? 0.0 : tax.tax_amount;\n\t\t\t\t\ttax_amount *= (tax.add_deduct_tax == \"Deduct\") ? -1.0 : 1.0;\n\t\t\t\t\tactual_taxes_dict[tax.idx] = tax_amount;\n\t\t\t\t} else if (actual_taxes_dict[tax.row_id] !== null) {\n\t\t\t\t\tvar actual_tax_amount = flt(actual_taxes_dict[tax.row_id]) * flt(tax.rate) / 100;\n\t\t\t\t\tactual_taxes_dict[tax.idx] = actual_tax_amount;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t$.each(actual_taxes_dict, function(key, value) {\n\t\t\t\tif (value) total_actual_tax += value;\n\t\t\t});\n\n\t\t\treturn flt(this.frm.doc.grand_total - total_actual_tax, precision(\"grand_total\"));\n\t\t}\n\t}\n\n\tcalculate_total_advance(update_paid_amount) {\n\t\tvar total_allocated_amount = frappe.utils.sum($.map(this.frm.doc[\"advances\"] || [], function(adv) {\n\t\t\treturn flt(adv.allocated_amount, precision(\"allocated_amount\", adv));\n\t\t}));\n\t\tthis.frm.doc.total_advance = flt(total_allocated_amount, precision(\"total_advance\"));\n\n\t\tthis.calculate_outstanding_amount(update_paid_amount);\n\t}\n\n\tis_internal_invoice() {\n\t\tif (['Sales Invoice', 'Purchase Invoice'].includes(this.frm.doc.doctype)) {\n\t\t\tif (this.frm.doc.company === this.frm.doc.represents_company) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tcalculate_outstanding_amount(update_paid_amount) {\n\t\t// NOTE:\n\t\t// paid_amount and write_off_amount is only for POS/Loyalty Point Redemption Invoice\n\t\t// total_advance is only for non POS Invoice\n\t\tif(in_list([\"Sales Invoice\", \"POS Invoice\"], this.frm.doc.doctype) && this.frm.doc.is_return){\n\t\t\tthis.calculate_paid_amount();\n\t\t}\n\n\t\tif (this.frm.doc.is_return || (this.frm.doc.docstatus > 0) || this.is_internal_invoice()) return;\n\n\t\tfrappe.model.round_floats_in(this.frm.doc, [\"grand_total\", \"total_advance\", \"write_off_amount\"]);\n\n\t\tif(in_list([\"Sales Invoice\", \"POS Invoice\", \"Purchase Invoice\"], this.frm.doc.doctype)) {\n\t\t\tvar grand_total = this.frm.doc.rounded_total || this.frm.doc.grand_total;\n\n\t\t\tif(this.frm.doc.party_account_currency == this.frm.doc.currency) {\n\t\t\t\tvar total_amount_to_pay = flt((grand_total - this.frm.doc.total_advance\n\t\t\t\t\t- this.frm.doc.write_off_amount), precision(\"grand_total\"));\n\t\t\t} else {\n\t\t\t\tvar total_amount_to_pay = flt(\n\t\t\t\t\t(flt(grand_total*this.frm.doc.conversion_rate, precision(\"grand_total\"))\n\t\t\t\t\t\t- this.frm.doc.total_advance - this.frm.doc.base_write_off_amount),\n\t\t\t\t\tprecision(\"base_grand_total\")\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tfrappe.model.round_floats_in(this.frm.doc, [\"paid_amount\"]);\n\t\t\tthis.set_in_company_currency(this.frm.doc, [\"paid_amount\"]);\n\n\t\t\tif(this.frm.refresh_field){\n\t\t\t\tthis.frm.refresh_field(\"paid_amount\");\n\t\t\t\tthis.frm.refresh_field(\"base_paid_amount\");\n\t\t\t}\n\n\t\t\tif(in_list([\"Sales Invoice\", \"POS Invoice\"], this.frm.doc.doctype)) {\n\t\t\t\tlet total_amount_for_payment = (this.frm.doc.redeem_loyalty_points && this.frm.doc.loyalty_amount)\n\t\t\t\t\t? flt(total_amount_to_pay - this.frm.doc.loyalty_amount, precision(\"base_grand_total\"))\n\t\t\t\t\t: total_amount_to_pay;\n\t\t\t\tthis.set_default_payment(total_amount_for_payment, update_paid_amount);\n\t\t\t\tthis.calculate_paid_amount();\n\t\t\t}\n\t\t\tthis.calculate_change_amount();\n\n\t\t\tvar paid_amount = (this.frm.doc.party_account_currency == this.frm.doc.currency) ?\n\t\t\t\tthis.frm.doc.paid_amount : this.frm.doc.base_paid_amount;\n\t\t\tthis.frm.doc.outstanding_amount =  flt(total_amount_to_pay - flt(paid_amount) +\n\t\t\t\tflt(this.frm.doc.change_amount * this.frm.doc.conversion_rate), precision(\"outstanding_amount\"));\n\t\t}\n\t}\n\n\tupdate_paid_amount_for_return() {\n\t\tvar grand_total = this.frm.doc.rounded_total || this.frm.doc.grand_total;\n\n\t\tif(this.frm.doc.party_account_currency == this.frm.doc.currency) {\n\t\t\tvar total_amount_to_pay = flt((grand_total - this.frm.doc.total_advance\n\t\t\t\t- this.frm.doc.write_off_amount), precision(\"grand_total\"));\n\t\t} else {\n\t\t\tvar total_amount_to_pay = flt(\n\t\t\t\t(flt(grand_total*this.frm.doc.conversion_rate, precision(\"grand_total\"))\n\t\t\t\t\t- this.frm.doc.total_advance - this.frm.doc.base_write_off_amount),\n\t\t\t\tprecision(\"base_grand_total\")\n\t\t\t);\n\t\t}\n\n\t\tthis.frm.doc.payments.find(pay => {\n\t\t\tif (pay.default) {\n\t\t\t\tpay.amount = total_amount_to_pay;\n\t\t\t} else {\n\t\t\t\tpay.amount = 0.0\n\t\t\t}\n\t\t});\n\t\tthis.frm.refresh_fields();\n\n\t\tthis.calculate_paid_amount();\n\t}\n\n\tset_default_payment(total_amount_to_pay, update_paid_amount) {\n\t\tvar me = this;\n\t\tvar payment_status = true;\n\t\tif(this.frm.doc.is_pos && (update_paid_amount===undefined || update_paid_amount)) {\n\t\t\t$.each(this.frm.doc['payments'] || [], function(index, data) {\n\t\t\t\tif(data.default && payment_status && total_amount_to_pay > 0) {\n\t\t\t\t\tlet base_amount = flt(total_amount_to_pay, precision(\"base_amount\", data));\n\t\t\t\t\tfrappe.model.set_value(data.doctype, data.name, \"base_amount\", base_amount);\n\t\t\t\t\tlet amount = flt(total_amount_to_pay / me.frm.doc.conversion_rate, precision(\"amount\", data));\n\t\t\t\t\tfrappe.model.set_value(data.doctype, data.name, \"amount\", amount);\n\t\t\t\t\tpayment_status = false;\n\t\t\t\t} else if(me.frm.doc.paid_amount) {\n\t\t\t\t\tfrappe.model.set_value(data.doctype, data.name, \"amount\", 0.0);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tcalculate_paid_amount() {\n\t\tvar me = this;\n\t\tvar paid_amount = 0.0;\n\t\tvar base_paid_amount = 0.0;\n\t\tif(this.frm.doc.is_pos) {\n\t\t\t$.each(this.frm.doc['payments'] || [], function(index, data){\n\t\t\t\tdata.base_amount = flt(data.amount * me.frm.doc.conversion_rate, precision(\"base_amount\", data));\n\t\t\t\tpaid_amount += data.amount;\n\t\t\t\tbase_paid_amount += data.base_amount;\n\t\t\t});\n\t\t} else if(!this.frm.doc.is_return){\n\t\t\tthis.frm.doc.payments = [];\n\t\t}\n\t\tif (this.frm.doc.redeem_loyalty_points && this.frm.doc.loyalty_amount) {\n\t\t\tbase_paid_amount += this.frm.doc.loyalty_amount;\n\t\t\tpaid_amount += flt(this.frm.doc.loyalty_amount / me.frm.doc.conversion_rate, precision(\"paid_amount\"));\n\t\t}\n\n\t\tthis.frm.set_value('paid_amount', flt(paid_amount, precision(\"paid_amount\")));\n\t\tthis.frm.set_value('base_paid_amount', flt(base_paid_amount, precision(\"base_paid_amount\")));\n\t}\n\n\tcalculate_change_amount(){\n\t\tthis.frm.doc.change_amount = 0.0;\n\t\tthis.frm.doc.base_change_amount = 0.0;\n\t\tif(in_list([\"Sales Invoice\", \"POS Invoice\"], this.frm.doc.doctype)\n\t\t\t&& this.frm.doc.paid_amount > this.frm.doc.grand_total && !this.frm.doc.is_return) {\n\n\t\t\tvar payment_types = $.map(this.frm.doc.payments, function(d) { return d.type; });\n\t\t\tif (in_list(payment_types, 'Cash')) {\n\t\t\t\tvar grand_total = this.frm.doc.rounded_total || this.frm.doc.grand_total;\n\t\t\t\tvar base_grand_total = this.frm.doc.base_rounded_total || this.frm.doc.base_grand_total;\n\n\t\t\t\tthis.frm.doc.change_amount = flt(this.frm.doc.paid_amount - grand_total +\n\t\t\t\t\tthis.frm.doc.write_off_amount, precision(\"change_amount\"));\n\n\t\t\t\tthis.frm.doc.base_change_amount = flt(this.frm.doc.base_paid_amount -\n\t\t\t\t\tbase_grand_total + this.frm.doc.base_write_off_amount,\n\t\t\t\t\tprecision(\"base_change_amount\"));\n\t\t\t}\n\t\t}\n\t}\n\n\tcalculate_write_off_amount(){\n\t\tif(this.frm.doc.paid_amount > this.frm.doc.grand_total){\n\t\t\tthis.frm.doc.write_off_amount = flt(this.frm.doc.grand_total - this.frm.doc.paid_amount\n\t\t\t\t+ this.frm.doc.change_amount, precision(\"write_off_amount\"));\n\n\t\t\tthis.frm.doc.base_write_off_amount = flt(this.frm.doc.write_off_amount * this.frm.doc.conversion_rate,\n\t\t\t\tprecision(\"base_write_off_amount\"));\n\t\t}else{\n\t\t\tthis.frm.doc.paid_amount = 0.0;\n\t\t}\n\t\tthis.calculate_outstanding_amount(false);\n\t}\n}\n", "// Copyright (c) 2015, Frappe Technologies Pvt. Ltd. and Contributors\n// License: GNU General Public License v3. See license.txt\n\nfrappe.provide('erpnext.accounts.dimensions');\n\nerpnext.TransactionController = class TransactionController extends erpnext.taxes_and_totals {\n\tsetup() {\n\t\tsuper.setup();\n\t\tlet me = this;\n\t\tfrappe.flags.hide_serial_batch_dialog = true;\n\t\tfrappe.ui.form.on(this.frm.doctype + \" Item\", \"rate\", function(frm, cdt, cdn) {\n\t\t\tvar item = frappe.get_doc(cdt, cdn);\n\t\t\tvar has_margin_field = frappe.meta.has_field(cdt, 'margin_type');\n\n\t\t\tfrappe.model.round_floats_in(item, [\"rate\", \"price_list_rate\"]);\n\n\t\t\tif(item.price_list_rate) {\n\t\t\t\tif(item.rate > item.price_list_rate && has_margin_field) {\n\t\t\t\t\t// if rate is greater than price_list_rate, set margin\n\t\t\t\t\t// or set discount\n\t\t\t\t\titem.discount_percentage = 0;\n\t\t\t\t\titem.margin_type = 'Amount';\n\t\t\t\t\titem.margin_rate_or_amount = flt(item.rate - item.price_list_rate,\n\t\t\t\t\t\tprecision(\"margin_rate_or_amount\", item));\n\t\t\t\t\titem.rate_with_margin = item.rate;\n\t\t\t\t} else {\n\t\t\t\t\titem.discount_percentage = flt((1 - item.rate / item.price_list_rate) * 100.0,\n\t\t\t\t\t\tprecision(\"discount_percentage\", item));\n\t\t\t\t\titem.discount_amount = flt(item.price_list_rate) - flt(item.rate);\n\t\t\t\t\titem.margin_type = '';\n\t\t\t\t\titem.margin_rate_or_amount = 0;\n\t\t\t\t\titem.rate_with_margin = 0;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\titem.discount_percentage = 0.0;\n\t\t\t\titem.margin_type = '';\n\t\t\t\titem.margin_rate_or_amount = 0;\n\t\t\t\titem.rate_with_margin = 0;\n\t\t\t}\n\t\t\titem.base_rate_with_margin = item.rate_with_margin * flt(frm.doc.conversion_rate);\n\n\t\t\tcur_frm.cscript.set_gross_profit(item);\n\t\t\tcur_frm.cscript.calculate_taxes_and_totals();\n\t\t\tcur_frm.cscript.calculate_stock_uom_rate(frm, cdt, cdn);\n\t\t});\n\n\t\tfrappe.ui.form.on(this.frm.cscript.tax_table, \"rate\", function(frm, cdt, cdn) {\n\t\t\tcur_frm.cscript.calculate_taxes_and_totals();\n\t\t});\n\n\t\tfrappe.ui.form.on(this.frm.cscript.tax_table, \"tax_amount\", function(frm, cdt, cdn) {\n\t\t\tcur_frm.cscript.calculate_taxes_and_totals();\n\t\t});\n\n\t\tfrappe.ui.form.on(this.frm.cscript.tax_table, \"row_id\", function(frm, cdt, cdn) {\n\t\t\tcur_frm.cscript.calculate_taxes_and_totals();\n\t\t});\n\n\t\tfrappe.ui.form.on(this.frm.cscript.tax_table, \"included_in_print_rate\", function(frm, cdt, cdn) {\n\t\t\tcur_frm.cscript.set_dynamic_labels();\n\t\t\tcur_frm.cscript.calculate_taxes_and_totals();\n\t\t});\n\n\t\tfrappe.ui.form.on(this.frm.doctype, \"apply_discount_on\", function(frm) {\n\t\t\tif(frm.doc.additional_discount_percentage) {\n\t\t\t\tfrm.trigger(\"additional_discount_percentage\");\n\t\t\t} else {\n\t\t\t\tcur_frm.cscript.calculate_taxes_and_totals();\n\t\t\t}\n\t\t});\n\n\t\tfrappe.ui.form.on(this.frm.doctype, \"additional_discount_percentage\", function(frm) {\n\t\t\tif(!frm.doc.apply_discount_on) {\n\t\t\t\tfrappe.msgprint(__(\"Please set 'Apply Additional Discount On'\"));\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tfrm.via_discount_percentage = true;\n\n\t\t\tif(frm.doc.additional_discount_percentage && frm.doc.discount_amount) {\n\t\t\t\t// Reset discount amount and net / grand total\n\t\t\t\tfrm.doc.discount_amount = 0;\n\t\t\t\tfrm.cscript.calculate_taxes_and_totals();\n\t\t\t}\n\n\t\t\tvar total = flt(frm.doc[frappe.model.scrub(frm.doc.apply_discount_on)]);\n\t\t\tvar discount_amount = flt(total*flt(frm.doc.additional_discount_percentage) / 100,\n\t\t\t\tprecision(\"discount_amount\"));\n\n\t\t\tfrm.set_value(\"discount_amount\", discount_amount)\n\t\t\t\t.then(() => delete frm.via_discount_percentage);\n\t\t});\n\n\t\tfrappe.ui.form.on(this.frm.doctype, \"discount_amount\", function(frm) {\n\t\t\tfrm.cscript.set_dynamic_labels();\n\n\t\t\tif (!frm.via_discount_percentage) {\n\t\t\t\tfrm.doc.additional_discount_percentage = 0;\n\t\t\t}\n\n\t\t\tfrm.cscript.calculate_taxes_and_totals();\n\t\t});\n\n\t\tfrappe.ui.form.on(this.frm.doctype + \" Item\", {\n\t\t\titems_add: function(frm, cdt, cdn) {\n\t\t\t\tvar item = frappe.get_doc(cdt, cdn);\n\t\t\t\tif (!item.warehouse && frm.doc.set_warehouse) {\n\t\t\t\t\titem.warehouse = frm.doc.set_warehouse;\n\t\t\t\t}\n\n\t\t\t\tif (!item.target_warehouse && frm.doc.set_target_warehouse) {\n\t\t\t\t\titem.target_warehouse = frm.doc.set_target_warehouse;\n\t\t\t\t}\n\n\t\t\t\tif (!item.from_warehouse && frm.doc.set_from_warehouse) {\n\t\t\t\t\titem.from_warehouse = frm.doc.set_from_warehouse;\n\t\t\t\t}\n\n\t\t\t\terpnext.accounts.dimensions.copy_dimension_from_first_row(frm, cdt, cdn, 'items');\n\t\t\t}\n\t\t});\n\n\t\tif(this.frm.fields_dict[\"items\"].grid.get_field('batch_no')) {\n\t\t\tthis.frm.set_query(\"batch_no\", \"items\", function(doc, cdt, cdn) {\n\t\t\t\treturn me.set_query_for_batch(doc, cdt, cdn);\n\t\t\t});\n\t\t}\n\n\t\tif(\n\t\t\tthis.frm.docstatus < 2\n\t\t\t&& this.frm.fields_dict[\"payment_terms_template\"]\n\t\t\t&& this.frm.fields_dict[\"payment_schedule\"]\n\t\t\t&& this.frm.doc.payment_terms_template\n\t\t\t&& !this.frm.doc.payment_schedule.length\n\t\t){\n\t\t\tthis.frm.trigger(\"payment_terms_template\");\n\t\t}\n\n\t\tif(this.frm.fields_dict[\"taxes\"]) {\n\t\t\tthis[\"taxes_remove\"] = this.calculate_taxes_and_totals;\n\t\t}\n\n\t\tif(this.frm.fields_dict[\"items\"]) {\n\t\t\tthis[\"items_remove\"] = this.calculate_net_weight;\n\t\t}\n\n\t\tif(this.frm.fields_dict[\"recurring_print_format\"]) {\n\t\t\tthis.frm.set_query(\"recurring_print_format\", function(doc) {\n\t\t\t\treturn{\n\t\t\t\t\tfilters: [\n\t\t\t\t\t\t['Print Format', 'doc_type', '=', cur_frm.doctype],\n\t\t\t\t\t]\n\t\t\t\t};\n\t\t\t});\n\t\t}\n\n\t\tif(this.frm.fields_dict[\"return_against\"]) {\n\t\t\tthis.frm.set_query(\"return_against\", function(doc) {\n\t\t\t\tvar filters = {\n\t\t\t\t\t\"docstatus\": 1,\n\t\t\t\t\t\"is_return\": 0,\n\t\t\t\t\t\"company\": doc.company\n\t\t\t\t};\n\t\t\t\tif (me.frm.fields_dict[\"customer\"] && doc.customer) filters[\"customer\"] = doc.customer;\n\t\t\t\tif (me.frm.fields_dict[\"supplier\"] && doc.supplier) filters[\"supplier\"] = doc.supplier;\n\n\t\t\t\treturn {\n\t\t\t\t\tfilters: filters\n\t\t\t\t};\n\t\t\t});\n\t\t}\n\n\t\tif (this.frm.fields_dict[\"items\"].grid.get_field(\"expense_account\")) {\n\t\t\tthis.frm.set_query(\"expense_account\", \"items\", function(doc) {\n\t\t\t\treturn {\n\t\t\t\t\tfilters: {\n\t\t\t\t\t\t\"company\": doc.company\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t});\n\t\t}\n\n\t\tif(frappe.meta.get_docfield(this.frm.doc.doctype, \"pricing_rules\")) {\n\t\t\tthis.frm.set_indicator_formatter('pricing_rule', function(doc) {\n\t\t\t\treturn (doc.rule_applied) ? \"green\" : \"red\";\n\t\t\t});\n\t\t}\n\n\t\tlet batch_no_field = this.frm.get_docfield(\"items\", \"batch_no\");\n\t\tif (batch_no_field) {\n\t\t\tbatch_no_field.get_route_options_for_new_doc = function(row) {\n\t\t\t\treturn {\n\t\t\t\t\t\"item\": row.doc.item_code\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\n\t\tif (this.frm.fields_dict[\"items\"].grid.get_field('blanket_order')) {\n\t\t\tthis.frm.set_query(\"blanket_order\", \"items\", function(doc, cdt, cdn) {\n\t\t\t\tvar item = locals[cdt][cdn];\n\t\t\t\treturn {\n\t\t\t\t\tquery: \"erpnext.controllers.queries.get_blanket_orders\",\n\t\t\t\t\tfilters: {\n\t\t\t\t\t\t\"company\": doc.company,\n\t\t\t\t\t\t\"blanket_order_type\": doc.doctype === \"Sales Order\" ? \"Selling\" : \"Purchasing\",\n\t\t\t\t\t\t\"item\": item.item_code\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (this.frm.fields_dict.taxes_and_charges) {\n\t\t\tthis.frm.set_query(\"taxes_and_charges\", function() {\n\t\t\t\treturn {\n\t\t\t\t\tfilters: [\n\t\t\t\t\t\t['company', '=', me.frm.doc.company],\n\t\t\t\t\t\t['docstatus', '!=', 2]\n\t\t\t\t\t]\n\t\t\t\t};\n\t\t\t});\n\t\t}\n\n\t}\n\tonload() {\n\t\tvar me = this;\n\t\tif(this.frm.doc.__islocal) {\n\t\t\tvar currency = frappe.defaults.get_user_default(\"currency\");\n\n\t\t\tlet set_value = (fieldname, value) => {\n\t\t\t\tif(me.frm.fields_dict[fieldname] && !me.frm.doc[fieldname]) {\n\t\t\t\t\treturn me.frm.set_value(fieldname, value);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tthis.frm.trigger('set_default_internal_warehouse');\n\n\t\t\treturn frappe.run_serially([\n\t\t\t\t() => set_value('currency', currency),\n\t\t\t\t() => set_value('price_list_currency', currency),\n\t\t\t\t() => set_value('status', 'Draft'),\n\t\t\t\t() => set_value('is_subcontracted', 'No'),\n\t\t\t\t() => {\n\t\t\t\t\tif(this.frm.doc.company && !this.frm.doc.amended_from) {\n\t\t\t\t\t\tthis.frm.trigger(\"company\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t]);\n\t\t}\n\t}\n\n\tis_return() {\n\t\tif(!this.frm.doc.is_return && this.frm.doc.return_against) {\n\t\t\tthis.frm.set_value('return_against', '');\n\t\t}\n\t}\n\n\tsetup_quality_inspection() {\n\t\tif(!in_list([\"Delivery Note\", \"Sales Invoice\", \"Purchase Receipt\", \"Purchase Invoice\"], this.frm.doc.doctype)) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst me = this;\n\t\tif (!this.frm.is_new() && this.frm.doc.docstatus === 0) {\n\t\t\tthis.frm.add_custom_button(__(\"Quality Inspection(s)\"), () => {\n\t\t\t\tme.make_quality_inspection();\n\t\t\t}, __(\"Create\"));\n\t\t\tthis.frm.page.set_inner_btn_group_as_primary(__('Create'));\n\t\t}\n\n\t\tconst inspection_type = in_list([\"Purchase Receipt\", \"Purchase Invoice\"], this.frm.doc.doctype)\n\t\t\t? \"Incoming\" : \"Outgoing\";\n\n\t\tlet quality_inspection_field = this.frm.get_docfield(\"items\", \"quality_inspection\");\n\t\tquality_inspection_field.get_route_options_for_new_doc = function(row) {\n\t\t\tif(me.frm.is_new()) return;\n\t\t\treturn {\n\t\t\t\t\"inspection_type\": inspection_type,\n\t\t\t\t\"reference_type\": me.frm.doc.doctype,\n\t\t\t\t\"reference_name\": me.frm.doc.name,\n\t\t\t\t\"item_code\": row.doc.item_code,\n\t\t\t\t\"description\": row.doc.description,\n\t\t\t\t\"item_serial_no\": row.doc.serial_no ? row.doc.serial_no.split(\"\\n\")[0] : null,\n\t\t\t\t\"batch_no\": row.doc.batch_no\n\t\t\t}\n\t\t}\n\n\t\tthis.frm.set_query(\"quality_inspection\", \"items\", function(doc, cdt, cdn) {\n\t\t\tlet d = locals[cdt][cdn];\n\t\t\treturn {\n\t\t\t\tfilters: {\n\t\t\t\t\tdocstatus: 1,\n\t\t\t\t\tinspection_type: inspection_type,\n\t\t\t\t\treference_name: doc.name,\n\t\t\t\t\titem_code: d.item_code\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tmake_payment_request() {\n\t\tvar me = this;\n\t\tconst payment_request_type = (in_list(['Sales Order', 'Sales Invoice'], this.frm.doc.doctype))\n\t\t\t? \"Inward\" : \"Outward\";\n\n\t\tfrappe.call({\n\t\t\tmethod:\"erpnext.accounts.doctype.payment_request.payment_request.make_payment_request\",\n\t\t\targs: {\n\t\t\t\tdt: me.frm.doc.doctype,\n\t\t\t\tdn: me.frm.doc.name,\n\t\t\t\trecipient_id: me.frm.doc.contact_email,\n\t\t\t\tpayment_request_type: payment_request_type,\n\t\t\t\tparty_type: payment_request_type == 'Outward' ? \"Supplier\" : \"Customer\",\n\t\t\t\tparty: payment_request_type == 'Outward' ? me.frm.doc.supplier : me.frm.doc.customer\n\t\t\t},\n\t\t\tcallback: function(r) {\n\t\t\t\tif(!r.exc){\n\t\t\t\t\tvar doc = frappe.model.sync(r.message);\n\t\t\t\t\tfrappe.set_route(\"Form\", r.message.doctype, r.message.name);\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\t}\n\n\tonload_post_render() {\n\t\tif(this.frm.doc.__islocal && !(this.frm.doc.taxes || []).length\n\t\t\t&& !(this.frm.doc.__onload ? this.frm.doc.__onload.load_after_mapping : false)) {\n\t\t\tfrappe.after_ajax(() => this.apply_default_taxes());\n\t\t} else if(this.frm.doc.__islocal && this.frm.doc.company && this.frm.doc[\"items\"]\n\t\t\t&& !this.frm.doc.is_pos) {\n\t\t\tfrappe.after_ajax(() => this.calculate_taxes_and_totals());\n\t\t}\n\t\tif(frappe.meta.get_docfield(this.frm.doc.doctype + \" Item\", \"item_code\")) {\n\t\t\tthis.setup_item_selector();\n\t\t\tthis.frm.get_field(\"items\").grid.set_multiple_add(\"item_code\", \"qty\");\n\t\t}\n\t}\n\n\trefresh() {\n\t\terpnext.toggle_naming_series();\n\t\terpnext.hide_company();\n\t\tthis.set_dynamic_labels();\n\t\tthis.setup_sms();\n\t\tthis.setup_quality_inspection();\n\t\tlet scan_barcode_field = this.frm.get_field('scan_barcode');\n\t\tif (scan_barcode_field && scan_barcode_field.get_value()) {\n\t\t\tscan_barcode_field.set_value(\"\");\n\t\t\tscan_barcode_field.set_new_description(\"\");\n\n\t\t\tif (frappe.is_mobile()) {\n\t\t\t\tif (scan_barcode_field.$input_wrapper.find('.input-group').length) return;\n\n\t\t\t\tlet $input_group = $('<div class=\"input-group\">');\n\t\t\t\tscan_barcode_field.$input_wrapper.find('.control-input').append($input_group);\n\t\t\t\t$input_group.append(scan_barcode_field.$input);\n\t\t\t\t$(`<span class=\"input-group-btn\" style=\"vertical-align: top\">\n\t\t\t\t\t\t<button class=\"btn btn-default border\" type=\"button\">\n\t\t\t\t\t\t\t<i class=\"fa fa-camera text-muted\"></i>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</span>`)\n\t\t\t\t\t.on('click', '.btn', () => {\n\t\t\t\t\t\tfrappe.barcode.scan_barcode().then(barcode => {\n\t\t\t\t\t\t\tscan_barcode_field.set_value(barcode);\n\t\t\t\t\t\t});\n\t\t\t\t\t})\n\t\t\t\t\t.appendTo($input_group);\n\t\t\t}\n\t\t}\n\t}\n\n\tscan_barcode() {\n\t\tlet scan_barcode_field = this.frm.fields_dict[\"scan_barcode\"];\n\n\t\tlet show_description = function(idx, exist = null) {\n\t\t\tif (exist) {\n\t\t\t\tfrappe.show_alert({\n\t\t\t\t\tmessage: __('Row #{0}: Qty increased by 1', [idx]),\n\t\t\t\t\tindicator: 'green'\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tfrappe.show_alert({\n\t\t\t\t\tmessage: __('Row #{0}: Item added', [idx]),\n\t\t\t\t\tindicator: 'green'\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tif(this.frm.doc.scan_barcode) {\n\t\t\tfrappe.call({\n\t\t\t\tmethod: \"erpnext.selling.page.point_of_sale.point_of_sale.search_for_serial_or_batch_or_barcode_number\",\n\t\t\t\targs: { search_value: this.frm.doc.scan_barcode }\n\t\t\t}).then(r => {\n\t\t\t\tconst data = r && r.message;\n\t\t\t\tif (!data || Object.keys(data).length === 0) {\n\t\t\t\t\tfrappe.show_alert({\n\t\t\t\t\t\tmessage: __('Cannot find Item with this Barcode'),\n\t\t\t\t\t\tindicator: 'red'\n\t\t\t\t\t});\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tlet cur_grid = this.frm.fields_dict.items.grid;\n\n\t\t\t\tlet row_to_modify = null;\n\t\t\t\tconst existing_item_row = this.frm.doc.items.find(d => d.item_code === data.item_code);\n\t\t\t\tconst blank_item_row = this.frm.doc.items.find(d => !d.item_code);\n\n\t\t\t\tif (existing_item_row) {\n\t\t\t\t\trow_to_modify = existing_item_row;\n\t\t\t\t} else if (blank_item_row) {\n\t\t\t\t\trow_to_modify = blank_item_row;\n\t\t\t\t}\n\n\t\t\t\tif (!row_to_modify) {\n\t\t\t\t\t// add new row\n\t\t\t\t\trow_to_modify = frappe.model.add_child(this.frm.doc, cur_grid.doctype, 'items');\n\t\t\t\t}\n\n\t\t\t\tshow_description(row_to_modify.idx, row_to_modify.item_code);\n\n\t\t\t\tthis.frm.from_barcode = this.frm.from_barcode ? this.frm.from_barcode + 1 : 1;\n\t\t\t\tfrappe.model.set_value(row_to_modify.doctype, row_to_modify.name, {\n\t\t\t\t\titem_code: data.item_code,\n\t\t\t\t\tqty: (row_to_modify.qty || 0) + 1\n\t\t\t\t});\n\n\t\t\t\t['serial_no', 'batch_no', 'barcode'].forEach(field => {\n\t\t\t\t\tif (data[field] && frappe.meta.has_field(row_to_modify.doctype, field)) {\n\n\t\t\t\t\t\tlet value = (row_to_modify[field] && field === \"serial_no\")\n\t\t\t\t\t\t\t? row_to_modify[field] + '\\n' + data[field] : data[field];\n\n\t\t\t\t\t\tfrappe.model.set_value(row_to_modify.doctype,\n\t\t\t\t\t\t\trow_to_modify.name, field, value);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tscan_barcode_field.set_value('');\n\t\t\t\trefresh_field(\"items\");\n\t\t\t});\n\t\t}\n\t\treturn false;\n\t}\n\n\tapply_default_taxes() {\n\t\tvar me = this;\n\t\tvar taxes_and_charges_field = frappe.meta.get_docfield(me.frm.doc.doctype, \"taxes_and_charges\",\n\t\t\tme.frm.doc.name);\n\n\t\tif (!this.frm.doc.taxes_and_charges && this.frm.doc.taxes && this.frm.doc.taxes.length > 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (taxes_and_charges_field) {\n\t\t\treturn frappe.call({\n\t\t\t\tmethod: \"erpnext.controllers.accounts_controller.get_default_taxes_and_charges\",\n\t\t\t\targs: {\n\t\t\t\t\t\"master_doctype\": taxes_and_charges_field.options,\n\t\t\t\t\t\"tax_template\": me.frm.doc.taxes_and_charges || \"\",\n\t\t\t\t\t\"company\": me.frm.doc.company\n\t\t\t\t},\n\t\t\t\tdebounce: 2000,\n\t\t\t\tcallback: function(r) {\n\t\t\t\t\tif(!r.exc && r.message) {\n\t\t\t\t\t\tfrappe.run_serially([\n\t\t\t\t\t\t\t() => {\n\t\t\t\t\t\t\t\t// directly set in doc, so as not to call triggers\n\t\t\t\t\t\t\t\tif(r.message.taxes_and_charges) {\n\t\t\t\t\t\t\t\t\tme.frm.doc.taxes_and_charges = r.message.taxes_and_charges;\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t// set taxes table\n\t\t\t\t\t\t\t\tif(r.message.taxes) {\n\t\t\t\t\t\t\t\t\tme.frm.set_value(\"taxes\", r.message.taxes);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t() => me.set_dynamic_labels(),\n\t\t\t\t\t\t\t() => me.calculate_taxes_and_totals()\n\t\t\t\t\t\t]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tsetup_sms() {\n\t\tvar me = this;\n\t\tlet blacklist = ['Purchase Invoice', 'BOM'];\n\t\tif(this.frm.doc.docstatus===1 && !in_list([\"Lost\", \"Stopped\", \"Closed\"], this.frm.doc.status)\n\t\t\t&& !blacklist.includes(this.frm.doctype)) {\n\t\t\tthis.frm.page.add_menu_item(__('Send SMS'), function() { me.send_sms(); });\n\t\t}\n\t}\n\n\tsend_sms() {\n\t\tvar sms_man = new erpnext.SMSManager(this.frm.doc);\n\t}\n\n\tbarcode(doc, cdt, cdn) {\n\t\tvar d = locals[cdt][cdn];\n\t\tif(d.barcode==\"\" || d.barcode==null) {\n\t\t\t// barcode cleared, remove item\n\t\t\td.item_code = \"\";\n\t\t}\n\n\t\tthis.frm.from_barcode = this.frm.from_barcode ? this.frm.from_barcode + 1 : 1;\n\t\tthis.item_code(doc, cdt, cdn);\n\t}\n\n\titem_code(doc, cdt, cdn) {\n\t\tvar me = this;\n\t\tvar item = frappe.get_doc(cdt, cdn);\n\t\tvar update_stock = 0, show_batch_dialog = 0;\n\t\tif(['Sales Invoice'].includes(this.frm.doc.doctype)) {\n\t\t\tupdate_stock = cint(me.frm.doc.update_stock);\n\t\t\tshow_batch_dialog = update_stock;\n\n\t\t} else if((this.frm.doc.doctype === 'Purchase Receipt' && me.frm.doc.is_return) ||\n\t\t\tthis.frm.doc.doctype === 'Delivery Note') {\n\t\t\tshow_batch_dialog = 1;\n\t\t}\n\t\t// clear barcode if setting item (else barcode will take priority)\n\t\tif (this.frm.from_barcode == 0) {\n\t\t\titem.barcode = null;\n\t\t}\n\t\tthis.frm.from_barcode = this.frm.from_barcode - 1 >= 0 ? this.frm.from_barcode - 1 : 0;\n\n\n\t\tif(item.item_code || item.barcode || item.serial_no) {\n\t\t\tif(!this.validate_company_and_party()) {\n\t\t\t\tthis.frm.fields_dict[\"items\"].grid.grid_rows[item.idx - 1].remove();\n\t\t\t} else {\n\t\t\t\treturn this.frm.call({\n\t\t\t\t\tmethod: \"erpnext.stock.get_item_details.get_item_details\",\n\t\t\t\t\tchild: item,\n\t\t\t\t\targs: {\n\t\t\t\t\t\tdoc: me.frm.doc,\n\t\t\t\t\t\targs: {\n\t\t\t\t\t\t\titem_code: item.item_code,\n\t\t\t\t\t\t\tbarcode: item.barcode,\n\t\t\t\t\t\t\tserial_no: item.serial_no,\n\t\t\t\t\t\t\tbatch_no: item.batch_no,\n\t\t\t\t\t\t\tset_warehouse: me.frm.doc.set_warehouse,\n\t\t\t\t\t\t\twarehouse: item.warehouse,\n\t\t\t\t\t\t\tcustomer: me.frm.doc.customer || me.frm.doc.party_name,\n\t\t\t\t\t\t\tquotation_to: me.frm.doc.quotation_to,\n\t\t\t\t\t\t\tsupplier: me.frm.doc.supplier,\n\t\t\t\t\t\t\tcurrency: me.frm.doc.currency,\n\t\t\t\t\t\t\tupdate_stock: update_stock,\n\t\t\t\t\t\t\tconversion_rate: me.frm.doc.conversion_rate,\n\t\t\t\t\t\t\tprice_list: me.frm.doc.selling_price_list || me.frm.doc.buying_price_list,\n\t\t\t\t\t\t\tprice_list_currency: me.frm.doc.price_list_currency,\n\t\t\t\t\t\t\tplc_conversion_rate: me.frm.doc.plc_conversion_rate,\n\t\t\t\t\t\t\tcompany: me.frm.doc.company,\n\t\t\t\t\t\t\torder_type: me.frm.doc.order_type,\n\t\t\t\t\t\t\tis_pos: cint(me.frm.doc.is_pos),\n\t\t\t\t\t\t\tis_return: cint(me.frm.doc.is_return),\n\t\t\t\t\t\t\tis_subcontracted: me.frm.doc.is_subcontracted,\n\t\t\t\t\t\t\ttransaction_date: me.frm.doc.transaction_date || me.frm.doc.posting_date,\n\t\t\t\t\t\t\tignore_pricing_rule: me.frm.doc.ignore_pricing_rule,\n\t\t\t\t\t\t\tdoctype: me.frm.doc.doctype,\n\t\t\t\t\t\t\tname: me.frm.doc.name,\n\t\t\t\t\t\t\tproject: item.project || me.frm.doc.project,\n\t\t\t\t\t\t\tqty: item.qty || 1,\n\t\t\t\t\t\t\tnet_rate: item.rate,\n\t\t\t\t\t\t\tstock_qty: item.stock_qty,\n\t\t\t\t\t\t\tconversion_factor: item.conversion_factor,\n\t\t\t\t\t\t\tweight_per_unit: item.weight_per_unit,\n\t\t\t\t\t\t\tweight_uom: item.weight_uom,\n\t\t\t\t\t\t\tmanufacturer: item.manufacturer,\n\t\t\t\t\t\t\tstock_uom: item.stock_uom,\n\t\t\t\t\t\t\tpos_profile: cint(me.frm.doc.is_pos) ? me.frm.doc.pos_profile : '',\n\t\t\t\t\t\t\tcost_center: item.cost_center,\n\t\t\t\t\t\t\ttax_category: me.frm.doc.tax_category,\n\t\t\t\t\t\t\titem_tax_template: item.item_tax_template,\n\t\t\t\t\t\t\tchild_docname: item.name\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\n\t\t\t\t\tcallback: function(r) {\n\t\t\t\t\t\tif(!r.exc) {\n\t\t\t\t\t\t\tfrappe.run_serially([\n\t\t\t\t\t\t\t\t() => {\n\t\t\t\t\t\t\t\t\tvar d = locals[cdt][cdn];\n\t\t\t\t\t\t\t\t\tme.add_taxes_from_item_tax_template(d.item_tax_rate);\n\t\t\t\t\t\t\t\t\tif (d.free_item_data) {\n\t\t\t\t\t\t\t\t\t\tme.apply_product_discount(d);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t() => {\n\t\t\t\t\t\t\t\t\t// for internal customer instead of pricing rule directly apply valuation rate on item\n\t\t\t\t\t\t\t\t\tif (me.frm.doc.is_internal_customer || me.frm.doc.is_internal_supplier) {\n\t\t\t\t\t\t\t\t\t\tme.get_incoming_rate(item, me.frm.posting_date, me.frm.posting_time,\n\t\t\t\t\t\t\t\t\t\t\tme.frm.doc.doctype, me.frm.doc.company);\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tme.frm.script_manager.trigger(\"price_list_rate\", cdt, cdn);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t() => {\n\t\t\t\t\t\t\t\t\tif (me.frm.doc.is_internal_customer || me.frm.doc.is_internal_supplier) {\n\t\t\t\t\t\t\t\t\t\tme.calculate_taxes_and_totals();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t() => me.toggle_conversion_factor(item),\n\t\t\t\t\t\t\t\t() => {\n\t\t\t\t\t\t\t\t\tif (show_batch_dialog)\n\t\t\t\t\t\t\t\t\t\treturn frappe.db.get_value(\"Item\", item.item_code, [\"has_batch_no\", \"has_serial_no\"])\n\t\t\t\t\t\t\t\t\t\t\t.then((r) => {\n\t\t\t\t\t\t\t\t\t\t\t\tif (r.message &&\n\t\t\t\t\t\t\t\t\t\t\t\t(r.message.has_batch_no || r.message.has_serial_no)) {\n\t\t\t\t\t\t\t\t\t\t\t\t\tfrappe.flags.hide_serial_batch_dialog = false;\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t() => {\n\t\t\t\t\t\t\t\t\t// check if batch serial selector is disabled or not\n\t\t\t\t\t\t\t\t\tif (show_batch_dialog && !frappe.flags.hide_serial_batch_dialog)\n\t\t\t\t\t\t\t\t\t\treturn frappe.db.get_single_value('Stock Settings', 'disable_serial_no_and_batch_selector')\n\t\t\t\t\t\t\t\t\t\t\t.then((value) => {\n\t\t\t\t\t\t\t\t\t\t\t\tif (value) {\n\t\t\t\t\t\t\t\t\t\t\t\t\tfrappe.flags.hide_serial_batch_dialog = true;\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t() => {\n\t\t\t\t\t\t\t\t\tif(show_batch_dialog && !frappe.flags.hide_serial_batch_dialog) {\n\t\t\t\t\t\t\t\t\t\tvar d = locals[cdt][cdn];\n\t\t\t\t\t\t\t\t\t\t$.each(r.message, function(k, v) {\n\t\t\t\t\t\t\t\t\t\t\tif(!d[k]) d[k] = v;\n\t\t\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\t\t\tif (d.has_batch_no && d.has_serial_no) {\n\t\t\t\t\t\t\t\t\t\t\td.batch_no = undefined;\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\terpnext.show_serial_batch_selector(me.frm, d, (item) => {\n\t\t\t\t\t\t\t\t\t\t\tme.frm.script_manager.trigger('qty', item.doctype, item.name);\n\t\t\t\t\t\t\t\t\t\t\tif (!me.frm.doc.set_warehouse)\n\t\t\t\t\t\t\t\t\t\t\t\tme.frm.script_manager.trigger('warehouse', item.doctype, item.name);\n\t\t\t\t\t\t\t\t\t\t}, undefined, !frappe.flags.hide_serial_batch_dialog);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t() => me.conversion_factor(doc, cdt, cdn, true),\n\t\t\t\t\t\t\t\t() => me.remove_pricing_rule(item),\n\t\t\t\t\t\t\t\t() => {\n\t\t\t\t\t\t\t\t\tif (item.apply_rule_on_other_items) {\n\t\t\t\t\t\t\t\t\t\tlet key = item.name;\n\t\t\t\t\t\t\t\t\t\tme.apply_rule_on_other_items({key: item});\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t() => {\n\t\t\t\t\t\t\t\t\tvar company_currency = me.get_company_currency();\n\t\t\t\t\t\t\t\t\tme.update_item_grid_labels(company_currency);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\tprice_list_rate(doc, cdt, cdn) {\n\t\tvar item = frappe.get_doc(cdt, cdn);\n\t\tfrappe.model.round_floats_in(item, [\"price_list_rate\", \"discount_percentage\"]);\n\n\t\t// check if child doctype is Sales Order Item/Qutation Item and calculate the rate\n\t\tif (in_list([\"Quotation Item\", \"Sales Order Item\", \"Delivery Note Item\", \"Sales Invoice Item\", \"POS Invoice Item\", \"Purchase Invoice Item\", \"Purchase Order Item\", \"Purchase Receipt Item\",\"Proforma Invoice Item\"]), cdt)\n\t\t\tthis.apply_pricing_rule_on_item(item);\n\t\telse\n\t\t\titem.rate = flt(item.price_list_rate * (1 - item.discount_percentage / 100.0),\n\t\t\t\tprecision(\"rate\", item));\n\n\t\tthis.calculate_taxes_and_totals();\n\t}\n\n\tmargin_rate_or_amount(doc, cdt, cdn) {\n\t\t// calculated the revised total margin and rate on margin rate changes\n\t\tlet item = frappe.get_doc(cdt, cdn);\n\t\tthis.apply_pricing_rule_on_item(item);\n\t\tthis.calculate_taxes_and_totals();\n\t\tcur_frm.refresh_fields();\n\t}\n\n\tmargin_type(doc, cdt, cdn) {\n\t\t// calculate the revised total margin and rate on margin type changes\n\t\tlet item = frappe.get_doc(cdt, cdn);\n\t\tif (!item.margin_type) {\n\t\t\tfrappe.model.set_value(cdt, cdn, \"margin_rate_or_amount\", 0);\n\t\t} else {\n\t\t\tthis.apply_pricing_rule_on_item(item, doc, cdt, cdn);\n\t\t\tthis.calculate_taxes_and_totals();\n\t\t\tcur_frm.refresh_fields();\n\t\t}\n\t}\n\n\tget_incoming_rate(item, posting_date, posting_time, voucher_type, company) {\n\n\t\tlet item_args = {\n\t\t\t'item_code': item.item_code,\n\t\t\t'warehouse': in_list('Purchase Receipt', 'Purchase Invoice') ? item.from_warehouse : item.warehouse,\n\t\t\t'posting_date': posting_date,\n\t\t\t'posting_time': posting_time,\n\t\t\t'qty': item.qty * item.conversion_factor,\n\t\t\t'serial_no': item.serial_no,\n\t\t\t'voucher_type': voucher_type,\n\t\t\t'company': company,\n\t\t\t'allow_zero_valuation_rate': item.allow_zero_valuation_rate\n\t\t}\n\n\t\tfrappe.call({\n\t\t\tmethod: 'erpnext.stock.utils.get_incoming_rate',\n\t\t\targs: {\n\t\t\t\targs: item_args\n\t\t\t},\n\t\t\tcallback: function(r) {\n\t\t\t\tfrappe.model.set_value(item.doctype, item.name, 'rate', r.message * item.conversion_factor);\n\t\t\t}\n\t\t});\n\t}\n\n\tserial_no(doc, cdt, cdn) {\n\t\tvar me = this;\n\t\tvar item = frappe.get_doc(cdt, cdn);\n\n\t\tif (item && item.doctype === 'Purchase Receipt Item Supplied') {\n\t\t\treturn;\n\t\t}\n\n\t\tif (item && item.serial_no) {\n\t\t\tif (!item.item_code) {\n\t\t\t\tthis.frm.trigger(\"item_code\", cdt, cdn);\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// Replacing all occurences of comma with carriage return\n\t\t\t\titem.serial_no = item.serial_no.replace(/,/g, '\\n');\n\t\t\t\titem.conversion_factor = item.conversion_factor || 1;\n\t\t\t\trefresh_field(\"serial_no\", item.name, item.parentfield);\n\t\t\t\tif (!doc.is_return && cint(frappe.user_defaults.set_qty_in_transactions_based_on_serial_no_input)) {\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tme.update_qty(cdt, cdn);\n\t\t\t\t\t}, 10000);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tupdate_qty(cdt, cdn) {\n\t\tvar valid_serial_nos = [];\n\t\tvar serialnos = [];\n\t\tvar item = frappe.get_doc(cdt, cdn);\n\t\tserialnos = item.serial_no.split(\"\\n\");\n\t\tfor (var i = 0; i < serialnos.length; i++) {\n\t\t\tif (serialnos[i] != \"\") {\n\t\t\t\tvalid_serial_nos.push(serialnos[i]);\n\t\t\t}\n\t\t}\n\t\tfrappe.model.set_value(item.doctype, item.name,\n\t\t\t\"qty\", valid_serial_nos.length / item.conversion_factor);\n\t\tfrappe.model.set_value(item.doctype, item.name, \"stock_qty\", valid_serial_nos.length);\n\t}\n\n\tvalidate() {\n\t\tthis.calculate_taxes_and_totals(false);\n\t}\n\n\tupdate_stock() {\n\t\tthis.frm.trigger('set_default_internal_warehouse');\n\t}\n\n\tset_default_internal_warehouse() {\n\t\tlet me = this;\n\t\tif ((this.frm.doc.doctype === 'Sales Invoice' && me.frm.doc.update_stock)\n\t\t\t|| this.frm.doc.doctype == 'Delivery Note') {\n\t\t\tif (this.frm.doc.is_internal_customer && this.frm.doc.company === this.frm.doc.represents_company) {\n\t\t\t\tfrappe.db.get_value('Company', this.frm.doc.company, 'default_in_transit_warehouse', function(value) {\n\t\t\t\t\tme.frm.set_value('set_target_warehouse', value.default_in_transit_warehouse);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tif ((this.frm.doc.doctype === 'Purchase Invoice' && me.frm.doc.update_stock)\n\t\t\t|| this.frm.doc.doctype == 'Purchase Receipt') {\n\t\t\tif (this.frm.doc.is_internal_supplier && this.frm.doc.company === this.frm.doc.represents_company) {\n\t\t\t\tfrappe.db.get_value('Company', this.frm.doc.company, 'default_in_transit_warehouse', function(value) {\n\t\t\t\t\tme.frm.set_value('set_from_warehouse', value.default_in_transit_warehouse);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\tcompany() {\n\t\tvar me = this;\n\t\tvar set_pricing = function() {\n\t\t\tif(me.frm.doc.company && me.frm.fields_dict.currency) {\n\t\t\t\tvar company_currency = me.get_company_currency();\n\t\t\t\tvar company_doc = frappe.get_doc(\":Company\", me.frm.doc.company);\n\n\t\t\t\tif (!me.frm.doc.currency) {\n\t\t\t\t\tme.frm.set_value(\"currency\", company_currency);\n\t\t\t\t}\n\n\t\t\t\tif (me.frm.doc.currency == company_currency) {\n\t\t\t\t\tme.frm.set_value(\"conversion_rate\", 1.0);\n\t\t\t\t}\n\t\t\t\tif (me.frm.doc.price_list_currency == company_currency) {\n\t\t\t\t\tme.frm.set_value('plc_conversion_rate', 1.0);\n\t\t\t\t}\n\t\t\t\tif (company_doc.default_letter_head) {\n\t\t\t\t\tif(me.frm.fields_dict.letter_head) {\n\t\t\t\t\t\tme.frm.set_value(\"letter_head\", company_doc.default_letter_head);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tlet selling_doctypes_for_tc = [\"Sales Invoice\", \"Quotation\", \"Sales Order\", \"Delivery Note\",\"Proforma Invoice\"];\n\t\t\t\tif (company_doc.default_selling_terms && frappe.meta.has_field(me.frm.doc.doctype, \"tc_name\") &&\n\t\t\t\tselling_doctypes_for_tc.indexOf(me.frm.doc.doctype) != -1) {\n\t\t\t\t\tme.frm.set_value(\"tc_name\", company_doc.default_selling_terms);\n\t\t\t\t}\n\t\t\t\tlet buying_doctypes_for_tc = [\"Request for Quotation\", \"Supplier Quotation\", \"Purchase Order\",\n\t\t\t\t\t\"Material Request\", \"Purchase Receipt\"];\n\t\t\t\t// Purchase Invoice is excluded as per issue #3345\n\t\t\t\tif (company_doc.default_buying_terms && frappe.meta.has_field(me.frm.doc.doctype, \"tc_name\") &&\n\t\t\t\tbuying_doctypes_for_tc.indexOf(me.frm.doc.doctype) != -1) {\n\t\t\t\t\tme.frm.set_value(\"tc_name\", company_doc.default_buying_terms);\n\t\t\t\t}\n\n\t\t\t\tfrappe.run_serially([\n\t\t\t\t\t() => me.frm.script_manager.trigger(\"currency\"),\n\t\t\t\t\t() => me.update_item_tax_map(),\n\t\t\t\t\t() => me.apply_default_taxes(),\n\t\t\t\t\t() => me.apply_pricing_rule()\n\t\t\t\t]);\n\t\t\t}\n\t\t}\n\n\t\tvar set_party_account = function(set_pricing) {\n\t\t\tif (in_list([\"Sales Invoice\", \"Purchase Invoice\"], me.frm.doc.doctype)) {\n\t\t\t\tif(me.frm.doc.doctype==\"Sales Invoice\") {\n\t\t\t\t\tvar party_type = \"Customer\";\n\t\t\t\t\tvar party_account_field = 'debit_to';\n\t\t\t\t} else {\n\t\t\t\t\tvar party_type = \"Supplier\";\n\t\t\t\t\tvar party_account_field = 'credit_to';\n\t\t\t\t}\n\n\t\t\t\tvar party = me.frm.doc[frappe.model.scrub(party_type)];\n\t\t\t\tif(party && me.frm.doc.company) {\n\t\t\t\t\treturn frappe.call({\n\t\t\t\t\t\tmethod: \"erpnext.accounts.party.get_party_account\",\n\t\t\t\t\t\targs: {\n\t\t\t\t\t\t\tcompany: me.frm.doc.company,\n\t\t\t\t\t\t\tparty_type: party_type,\n\t\t\t\t\t\t\tparty: party\n\t\t\t\t\t\t},\n\t\t\t\t\t\tcallback: function(r) {\n\t\t\t\t\t\t\tif(!r.exc && r.message) {\n\t\t\t\t\t\t\t\tme.frm.set_value(party_account_field, r.message);\n\t\t\t\t\t\t\t\tset_pricing();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tset_pricing();\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tset_pricing();\n\t\t\t}\n\n\t\t}\n\n\t\tif (frappe.meta.get_docfield(this.frm.doctype, \"shipping_address\") &&\n\t\t\tin_list(['Purchase Order', 'Purchase Receipt', 'Purchase Invoice'], this.frm.doctype)) {\n\t\t\terpnext.utils.get_shipping_address(this.frm, function(){\n\t\t\t\tset_party_account(set_pricing);\n\t\t\t});\n\n\t\t\t// Get default company billing address in Purchase Invoice, Order and Receipt\n\t\t\tfrappe.call({\n\t\t\t\t'method': 'frappe.contacts.doctype.address.address.get_default_address',\n\t\t\t\t'args': {\n\t\t\t\t\t'doctype': 'Company',\n\t\t\t\t\t'name': this.frm.doc.company\n\t\t\t\t},\n\t\t\t\t'callback': function(r) {\n\t\t\t\t\tme.frm.set_value('billing_address', r.message);\n\t\t\t\t}\n\t\t\t});\n\n\t\t} else {\n\t\t\tset_party_account(set_pricing);\n\t\t}\n\n\t\tif(this.frm.doc.company) {\n\t\t\terpnext.last_selected_company = this.frm.doc.company;\n\t\t}\n\t}\n\n\ttransaction_date() {\n\t\tif (this.frm.doc.transaction_date) {\n\t\t\tthis.frm.transaction_date = this.frm.doc.transaction_date;\n\t\t\tfrappe.ui.form.trigger(this.frm.doc.doctype, \"currency\");\n\t\t}\n\t}\n\n\tposting_date() {\n\t\tvar me = this;\n\t\tif (this.frm.doc.posting_date) {\n\t\t\tthis.frm.posting_date = this.frm.doc.posting_date;\n\n\t\t\tif ((this.frm.doc.doctype == \"Sales Invoice\" && this.frm.doc.customer) ||\n\t\t\t\t(this.frm.doc.doctype == \"Purchase Invoice\" && this.frm.doc.supplier)) {\n\t\t\t\treturn frappe.call({\n\t\t\t\t\tmethod: \"erpnext.accounts.party.get_due_date\",\n\t\t\t\t\targs: {\n\t\t\t\t\t\t\"posting_date\": me.frm.doc.posting_date,\n\t\t\t\t\t\t\"party_type\": me.frm.doc.doctype == \"Sales Invoice\" ? \"Customer\" : \"Supplier\",\n\t\t\t\t\t\t\"bill_date\": me.frm.doc.bill_date,\n\t\t\t\t\t\t\"party\": me.frm.doc.doctype == \"Sales Invoice\" ? me.frm.doc.customer : me.frm.doc.supplier,\n\t\t\t\t\t\t\"company\": me.frm.doc.company\n\t\t\t\t\t},\n\t\t\t\t\tcallback: function(r, rt) {\n\t\t\t\t\t\tif(r.message) {\n\t\t\t\t\t\t\tme.frm.doc.due_date = r.message;\n\t\t\t\t\t\t\trefresh_field(\"due_date\");\n\t\t\t\t\t\t\tfrappe.ui.form.trigger(me.frm.doc.doctype, \"currency\");\n\t\t\t\t\t\t\tme.recalculate_terms();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t} else {\n\t\t\t\tfrappe.ui.form.trigger(me.frm.doc.doctype, \"currency\");\n\t\t\t}\n\t\t}\n\t}\n\n\tdue_date() {\n\t\t// due_date is to be changed, payment terms template and/or payment schedule must\n\t\t// be removed as due_date is automatically changed based on payment terms\n\t\tif (this.frm.doc.due_date && !this.frm.updating_party_details && !this.frm.doc.is_pos) {\n\t\t\tif (this.frm.doc.payment_terms_template ||\n\t\t\t\t(this.frm.doc.payment_schedule && this.frm.doc.payment_schedule.length)) {\n\t\t\t\tvar message1 = \"\";\n\t\t\t\tvar message2 = \"\";\n\t\t\t\tvar final_message = __(\"Please clear the\") + \" \";\n\n\t\t\t\tif (this.frm.doc.payment_terms_template) {\n\t\t\t\t\tmessage1 = __(\"selected Payment Terms Template\");\n\t\t\t\t\tfinal_message = final_message + message1;\n\t\t\t\t}\n\n\t\t\t\tif ((this.frm.doc.payment_schedule || []).length) {\n\t\t\t\t\tmessage2 = __(\"Payment Schedule Table\");\n\t\t\t\t\tif (message1.length !== 0) message2 = \" and \" + message2;\n\t\t\t\t\tfinal_message = final_message + message2;\n\t\t\t\t}\n\t\t\t\tfrappe.msgprint(final_message);\n\t\t\t}\n\t\t}\n\t}\n\n\tbill_date() {\n\t\tthis.posting_date();\n\t}\n\n\trecalculate_terms() {\n\t\tconst doc = this.frm.doc;\n\t\tif (doc.payment_terms_template) {\n\t\t\tthis.payment_terms_template();\n\t\t} else if (doc.payment_schedule) {\n\t\t\tconst me = this;\n\t\t\tdoc.payment_schedule.forEach(\n\t\t\t\tfunction(term) {\n\t\t\t\t\tif (term.payment_term) {\n\t\t\t\t\t\tme.payment_term(doc, term.doctype, term.name);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tfrappe.model.set_value(\n\t\t\t\t\t\t\tterm.doctype, term.name, 'due_date',\n\t\t\t\t\t\t\tdoc.posting_date || doc.transaction_date\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t}\n\n\tget_company_currency() {\n\t\treturn erpnext.get_currency(this.frm.doc.company);\n\t}\n\n\tcontact_person() {\n\t\terpnext.utils.get_contact_details(this.frm);\n\t}\n\n\tcurrency() {\n\t\t/* manqala 19/09/2016: let the translation date be whichever of the transaction_date or posting_date is available */\n\t\tvar transaction_date = this.frm.doc.transaction_date || this.frm.doc.posting_date;\n\t\t/* end manqala */\n\t\tvar me = this;\n\t\tthis.set_dynamic_labels();\n\t\tvar company_currency = this.get_company_currency();\n\t\t// Added `ignore_pricing_rule` to determine if document is loading after mapping from another doc\n\t\tif(this.frm.doc.currency && this.frm.doc.currency !== company_currency\n\t\t\t\t&& !this.frm.doc.ignore_pricing_rule) {\n\n\t\t\tthis.get_exchange_rate(transaction_date, this.frm.doc.currency, company_currency,\n\t\t\t\tfunction(exchange_rate) {\n\t\t\t\t\tif(exchange_rate != me.frm.doc.conversion_rate) {\n\t\t\t\t\t\tme.set_margin_amount_based_on_currency(exchange_rate);\n\t\t\t\t\t\tme.set_actual_charges_based_on_currency(exchange_rate);\n\t\t\t\t\t\tme.frm.set_value(\"conversion_rate\", exchange_rate);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t} else {\n\t\t\tthis.conversion_rate();\n\t\t}\n\t}\n\n\tconversion_rate() {\n\t\tconst me = this.frm;\n\t\tif(this.frm.doc.currency === this.get_company_currency()) {\n\t\t\tthis.frm.set_value(\"conversion_rate\", 1.0);\n\t\t}\n\t\tif(this.frm.doc.currency === this.frm.doc.price_list_currency &&\n\t\t\tthis.frm.doc.plc_conversion_rate !== this.frm.doc.conversion_rate) {\n\t\t\tthis.frm.set_value(\"plc_conversion_rate\", this.frm.doc.conversion_rate);\n\t\t}\n\n\t\tif(flt(this.frm.doc.conversion_rate)>0.0) {\n\t\t\tif(this.frm.doc.ignore_pricing_rule) {\n\t\t\t\tthis.calculate_taxes_and_totals();\n\t\t\t} else if (!this.in_apply_price_list){\n\t\t\t\tthis.apply_price_list();\n\t\t\t}\n\n\t\t}\n\t\t// Make read only if Accounts Settings doesn't allow stale rates\n\t\tthis.frm.set_df_property(\"conversion_rate\", \"read_only\", erpnext.stale_rate_allowed() ? 0 : 1);\n\t}\n\n\tshipping_rule() {\n\t\tvar me = this;\n\t\tif(this.frm.doc.shipping_rule) {\n\t\t\treturn this.frm.call({\n\t\t\t\tdoc: this.frm.doc,\n\t\t\t\tmethod: \"apply_shipping_rule\",\n\t\t\t\tcallback: function(r) {\n\t\t\t\t\tif(!r.exc) {\n\t\t\t\t\t\tme.calculate_taxes_and_totals();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}).fail(() => this.frm.set_value('shipping_rule', ''));\n\t\t}\n\t\telse {\n\t\t\tme.calculate_taxes_and_totals();\n\t\t}\n\t}\n\n\tset_margin_amount_based_on_currency(exchange_rate) {\n\t\tif (in_list([\"Quotation\", \"Sales Order\", \"Delivery Note\", \"Sales Invoice\", \"Purchase Invoice\", \"Purchase Order\", \"Purchase Receipt\",\"Proforma Invoice\"]), this.frm.doc.doctype) {\n\t\t\tvar me = this;\n\t\t\t$.each(this.frm.doc.items || [], function(i, d) {\n\t\t\t\tif(d.margin_type == \"Amount\") {\n\t\t\t\t\tfrappe.model.set_value(d.doctype, d.name, \"margin_rate_or_amount\",\n\t\t\t\t\t\tflt(d.margin_rate_or_amount) / flt(exchange_rate));\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tset_actual_charges_based_on_currency(exchange_rate) {\n\t\tvar me = this;\n\t\t$.each(this.frm.doc.taxes || [], function(i, d) {\n\t\t\tif(d.charge_type == \"Actual\") {\n\t\t\t\tfrappe.model.set_value(d.doctype, d.name, \"tax_amount\",\n\t\t\t\t\tflt(d.tax_amount) / flt(exchange_rate));\n\t\t\t}\n\t\t});\n\t}\n\n\tget_exchange_rate(transaction_date, from_currency, to_currency, callback) {\n\t\tvar args;\n\t\tif ([\"Quotation\", \"Sales Order\", \"Delivery Note\", \"Sales Invoice\",\"Proforma Invoice\"].includes(this.frm.doctype)) {\n\t\t\targs = \"for_selling\";\n\t\t}\n\t\telse if ([\"Purchase Order\", \"Purchase Receipt\", \"Purchase Invoice\"].includes(this.frm.doctype)) {\n\t\t\targs = \"for_buying\";\n\t\t}\n\n\t\tif (!transaction_date || !from_currency || !to_currency) return;\n\t\treturn frappe.call({\n\t\t\tmethod: \"erpnext.setup.utils.get_exchange_rate\",\n\t\t\targs: {\n\t\t\t\ttransaction_date: transaction_date,\n\t\t\t\tfrom_currency: from_currency,\n\t\t\t\tto_currency: to_currency,\n\t\t\t\targs: args\n\t\t\t},\n\t\t\tfreeze: true,\n\t\t\tfreeze_message: __(\"Fetching exchange rates ...\"),\n\t\t\tcallback: function(r) {\n\t\t\t\tcallback(flt(r.message));\n\t\t\t}\n\t\t});\n\t}\n\n\tprice_list_currency() {\n\t\tvar me=this;\n\t\tthis.set_dynamic_labels();\n\n\t\tvar company_currency = this.get_company_currency();\n\t\t// Added `ignore_pricing_rule` to determine if document is loading after mapping from another doc\n\t\tif(this.frm.doc.price_list_currency !== company_currency  && !this.frm.doc.ignore_pricing_rule) {\n\t\t\tthis.get_exchange_rate(this.frm.doc.posting_date, this.frm.doc.price_list_currency, company_currency,\n\t\t\t\tfunction(exchange_rate) {\n\t\t\t\t\tme.frm.set_value(\"plc_conversion_rate\", exchange_rate);\n\t\t\t\t});\n\t\t} else {\n\t\t\tthis.plc_conversion_rate();\n\t\t}\n\t}\n\n\tplc_conversion_rate() {\n\t\tif(this.frm.doc.price_list_currency === this.get_company_currency()) {\n\t\t\tthis.frm.set_value(\"plc_conversion_rate\", 1.0);\n\t\t} else if(this.frm.doc.price_list_currency === this.frm.doc.currency\n\t\t\t&& this.frm.doc.plc_conversion_rate && cint(this.frm.doc.plc_conversion_rate) != 1 &&\n\t\t\tcint(this.frm.doc.plc_conversion_rate) != cint(this.frm.doc.conversion_rate)) {\n\t\t\tthis.frm.set_value(\"conversion_rate\", this.frm.doc.plc_conversion_rate);\n\t\t}\n\n\t\tif(!this.in_apply_price_list) {\n\t\t\tthis.apply_price_list(null, true);\n\t\t}\n\t}\n\n\tuom(doc, cdt, cdn) {\n\t\tvar me = this;\n\t\tvar item = frappe.get_doc(cdt, cdn);\n\t\tif(item.item_code && item.uom) {\n\t\t\treturn this.frm.call({\n\t\t\t\tmethod: \"erpnext.stock.get_item_details.get_conversion_factor\",\n\t\t\t\targs: {\n\t\t\t\t\titem_code: item.item_code,\n\t\t\t\t\tuom: item.uom\n\t\t\t\t},\n\t\t\t\tcallback: function(r) {\n\t\t\t\t\tif(!r.exc) {\n\t\t\t\t\t\tfrappe.model.set_value(cdt, cdn, 'conversion_factor', r.message.conversion_factor);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\tme.calculate_stock_uom_rate(doc, cdt, cdn);\n\t}\n\n\tconversion_factor(doc, cdt, cdn, dont_fetch_price_list_rate) {\n\t\tif(frappe.meta.get_docfield(cdt, \"stock_qty\", cdn)) {\n\t\t\tvar item = frappe.get_doc(cdt, cdn);\n\t\t\tfrappe.model.round_floats_in(item, [\"qty\", \"conversion_factor\"]);\n\t\t\titem.stock_qty = flt(item.qty * item.conversion_factor, precision(\"stock_qty\", item));\n\t\t\trefresh_field(\"stock_qty\", item.name, item.parentfield);\n\t\t\tthis.toggle_conversion_factor(item);\n\n\t\t\tif(doc.doctype != \"Material Request\") {\n\t\t\t\titem.total_weight = flt(item.stock_qty * item.weight_per_unit);\n\t\t\t\trefresh_field(\"total_weight\", item.name, item.parentfield);\n\t\t\t\tthis.calculate_net_weight();\n\t\t\t}\n\n\t\t\t// for handling customization not to fetch price list rate\n\t\t\tif(frappe.flags.dont_fetch_price_list_rate) {\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tif (!dont_fetch_price_list_rate &&\n\t\t\t\tfrappe.meta.has_field(doc.doctype, \"price_list_currency\")) {\n\t\t\t\tthis.apply_price_list(item, true);\n\t\t\t}\n\t\t\tthis.calculate_stock_uom_rate(doc, cdt, cdn);\n\t\t}\n\t}\n\n\tbatch_no(doc, cdt, cdn) {\n\t\tlet item = frappe.get_doc(cdt, cdn);\n\t\tthis.apply_price_list(item, true);\n\t}\n\n\ttoggle_conversion_factor(item) {\n\t\t// toggle read only property for conversion factor field if the uom and stock uom are same\n\t\tif(this.frm.get_field('items').grid.fields_map.conversion_factor) {\n\t\t\tthis.frm.fields_dict.items.grid.toggle_enable(\"conversion_factor\",\n\t\t\t\t((item.uom != item.stock_uom) && !frappe.meta.get_docfield(cur_frm.fields_dict.items.grid.doctype, \"conversion_factor\").read_only)? true: false);\n\t\t}\n\n\t}\n\n\tqty(doc, cdt, cdn) {\n\t\tlet item = frappe.get_doc(cdt, cdn);\n\t\tthis.conversion_factor(doc, cdt, cdn, true);\n\t\tthis.calculate_stock_uom_rate(doc, cdt, cdn);\n\t\tthis.apply_pricing_rule(item, true);\n\t}\n\n\tcalculate_stock_uom_rate(doc, cdt, cdn) {\n\t\tlet item = frappe.get_doc(cdt, cdn);\n\t\titem.stock_uom_rate = flt(item.rate)/flt(item.conversion_factor);\n\t\trefresh_field(\"stock_uom_rate\", item.name, item.parentfield);\n\t}\n\tservice_stop_date(frm, cdt, cdn){\n\t\tvar child = locals[cdt][cdn];\n\n\t\tif(child.service_stop_date) {\n\t\t\tlet start_date = Date.parse(child.service_start_date);\n\t\t\tlet end_date = Date.parse(child.service_end_date);\n\t\t\tlet stop_date = Date.parse(child.service_stop_date);\n\n\t\t\tif(stop_date < start_date) {\n\t\t\t\tfrappe.model.set_value(cdt, cdn, \"service_stop_date\", \"\");\n\t\t\t\tfrappe.throw(__(\"Service Stop Date cannot be before Service Start Date\"));\n\t\t\t} else if (stop_date > end_date) {\n\t\t\t\tfrappe.model.set_value(cdt, cdn, \"service_stop_date\", \"\");\n\t\t\t\tfrappe.throw(__(\"Service Stop Date cannot be after Service End Date\"));\n\t\t\t}\n\t\t}\n\t}\n\n\tservice_start_date(frm, cdt, cdn) {\n\t\tvar child = locals[cdt][cdn];\n\n\t\tif(child.service_start_date) {\n\t\t\tfrappe.call({\n\t\t\t\t\"method\": \"erpnext.stock.get_item_details.calculate_service_end_date\",\n\t\t\t\targs: {\"args\": child},\n\t\t\t\tcallback: function(r) {\n\t\t\t\t\tfrappe.model.set_value(cdt, cdn, \"service_end_date\", r.message.service_end_date);\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\t}\n\n\tcalculate_net_weight(){\n\t\t/* Calculate Total Net Weight then further applied shipping rule to calculate shipping charges.*/\n\t\tvar me = this;\n\t\tthis.frm.doc.total_net_weight= 0.0;\n\n\t\t$.each(this.frm.doc[\"items\"] || [], function(i, item) {\n\t\t\tme.frm.doc.total_net_weight += flt(item.total_weight);\n\t\t});\n\t\trefresh_field(\"total_net_weight\");\n\t\tthis.shipping_rule();\n\t}\n\n\tset_dynamic_labels() {\n\t\t// What TODO? should we make price list system non-mandatory?\n\t\tthis.frm.toggle_reqd(\"plc_conversion_rate\",\n\t\t\t!!(this.frm.doc.price_list_name && this.frm.doc.price_list_currency));\n\n\t\tvar company_currency = this.get_company_currency();\n\t\tthis.change_form_labels(company_currency);\n\t\tthis.change_grid_labels(company_currency);\n\t\tthis.frm.refresh_fields();\n\t}\n\n\tchange_form_labels(company_currency) {\n\t\tvar me = this;\n\n\t\tthis.frm.set_currency_labels([\"base_total\", \"base_net_total\", \"base_total_taxes_and_charges\",\n\t\t\t\"base_discount_amount\", \"base_grand_total\", \"base_rounded_total\", \"base_in_words\",\n\t\t\t\"base_taxes_and_charges_added\", \"base_taxes_and_charges_deducted\", \"total_amount_to_pay\",\n\t\t\t\"base_paid_amount\", \"base_write_off_amount\", \"base_change_amount\", \"base_operating_cost\",\n\t\t\t\"base_raw_material_cost\", \"base_total_cost\", \"base_scrap_material_cost\",\n\t\t\t\"base_rounding_adjustment\"], company_currency);\n\n\t\tthis.frm.set_currency_labels([\"total\", \"net_total\", \"total_taxes_and_charges\", \"discount_amount\",\n\t\t\t\"grand_total\", \"taxes_and_charges_added\", \"taxes_and_charges_deducted\",\n\t\t\t\"rounded_total\", \"in_words\", \"paid_amount\", \"write_off_amount\", \"operating_cost\",\n\t\t\t\"scrap_material_cost\", \"rounding_adjustment\", \"raw_material_cost\",\n\t\t\t\"total_cost\"], this.frm.doc.currency);\n\n\t\tthis.frm.set_currency_labels([\"outstanding_amount\", \"total_advance\"],\n\t\t\tthis.frm.doc.party_account_currency);\n\n\t\tcur_frm.set_df_property(\"conversion_rate\", \"description\", \"1 \" + this.frm.doc.currency\n\t\t\t+ \" = [?] \" + company_currency);\n\n\t\tif(this.frm.doc.price_list_currency && this.frm.doc.price_list_currency!=company_currency) {\n\t\t\tcur_frm.set_df_property(\"plc_conversion_rate\", \"description\", \"1 \"\n\t\t\t\t+ this.frm.doc.price_list_currency + \" = [?] \" + company_currency);\n\t\t}\n\n\t\t// toggle fields\n\t\tthis.frm.toggle_display([\"conversion_rate\", \"base_total\", \"base_net_total\",\n\t\t\t\"base_total_taxes_and_charges\", \"base_taxes_and_charges_added\", \"base_taxes_and_charges_deducted\",\n\t\t\t\"base_grand_total\", \"base_rounded_total\", \"base_in_words\", \"base_discount_amount\",\n\t\t\t\"base_paid_amount\", \"base_write_off_amount\", \"base_operating_cost\", \"base_raw_material_cost\",\n\t\t\t\"base_total_cost\", \"base_scrap_material_cost\", \"base_rounding_adjustment\"],\n\t\tthis.frm.doc.currency != company_currency);\n\n\t\tthis.frm.toggle_display([\"plc_conversion_rate\", \"price_list_currency\"],\n\t\t\tthis.frm.doc.price_list_currency != company_currency);\n\n\t\tvar show = cint(cur_frm.doc.discount_amount) ||\n\t\t\t\t((cur_frm.doc.taxes || []).filter(function(d) {return d.included_in_print_rate===1}).length);\n\n\t\tif(frappe.meta.get_docfield(cur_frm.doctype, \"net_total\"))\n\t\t\tcur_frm.toggle_display(\"net_total\", show);\n\n\t\tif(frappe.meta.get_docfield(cur_frm.doctype, \"base_net_total\"))\n\t\t\tcur_frm.toggle_display(\"base_net_total\", (show && (me.frm.doc.currency != company_currency)));\n\n\t}\n\n\tchange_grid_labels(company_currency) {\n\t\tvar me = this;\n\n\t\tthis.update_item_grid_labels(company_currency);\n\n\t\tthis.toggle_item_grid_columns(company_currency);\n\n\t\tif (this.frm.doc.operations && this.frm.doc.operations.length > 0) {\n\t\t\tthis.frm.set_currency_labels([\"operating_cost\", \"hour_rate\"], this.frm.doc.currency, \"operations\");\n\t\t\tthis.frm.set_currency_labels([\"base_operating_cost\", \"base_hour_rate\"], company_currency, \"operations\");\n\n\t\t\tvar item_grid = this.frm.fields_dict[\"operations\"].grid;\n\t\t\t$.each([\"base_operating_cost\", \"base_hour_rate\"], function(i, fname) {\n\t\t\t\tif(frappe.meta.get_docfield(item_grid.doctype, fname))\n\t\t\t\t\titem_grid.set_column_disp(fname, me.frm.doc.currency != company_currency);\n\t\t\t});\n\t\t}\n\n\t\tif (this.frm.doc.scrap_items && this.frm.doc.scrap_items.length > 0) {\n\t\t\tthis.frm.set_currency_labels([\"rate\", \"amount\"], this.frm.doc.currency, \"scrap_items\");\n\t\t\tthis.frm.set_currency_labels([\"base_rate\", \"base_amount\"], company_currency, \"scrap_items\");\n\n\t\t\tvar item_grid = this.frm.fields_dict[\"scrap_items\"].grid;\n\t\t\t$.each([\"base_rate\", \"base_amount\"], function(i, fname) {\n\t\t\t\tif(frappe.meta.get_docfield(item_grid.doctype, fname))\n\t\t\t\t\titem_grid.set_column_disp(fname, me.frm.doc.currency != company_currency);\n\t\t\t});\n\t\t}\n\n\t\tif (this.frm.doc.taxes && this.frm.doc.taxes.length > 0) {\n\t\t\tthis.frm.set_currency_labels([\"tax_amount\", \"total\", \"tax_amount_after_discount\"], this.frm.doc.currency, \"taxes\");\n\n\t\t\tthis.frm.set_currency_labels([\"base_tax_amount\", \"base_total\", \"base_tax_amount_after_discount\"], company_currency, \"taxes\");\n\t\t}\n\n\t\tif (this.frm.doc.advances && this.frm.doc.advances.length > 0) {\n\t\t\tthis.frm.set_currency_labels([\"advance_amount\", \"allocated_amount\"],\n\t\t\t\tthis.frm.doc.party_account_currency, \"advances\");\n\t\t}\n\n\t\tthis.update_payment_schedule_grid_labels(company_currency);\n\t}\n\n\tupdate_item_grid_labels(company_currency) {\n\t\tthis.frm.set_currency_labels([\n\t\t\t\"base_rate\", \"base_net_rate\", \"base_price_list_rate\",\n\t\t\t\"base_amount\", \"base_net_amount\", \"base_rate_with_margin\"\n\t\t], company_currency, \"items\");\n\n\t\tthis.frm.set_currency_labels([\n\t\t\t\"rate\", \"net_rate\", \"price_list_rate\", \"amount\",\n\t\t\t\"net_amount\", \"stock_uom_rate\", \"rate_with_margin\"\n\t\t], this.frm.doc.currency, \"items\");\n\t}\n\n\tupdate_payment_schedule_grid_labels(company_currency) {\n\t\tconst me = this;\n\t\tif (this.frm.doc.payment_schedule && this.frm.doc.payment_schedule.length > 0) {\n\t\t\tthis.frm.set_currency_labels([\"base_payment_amount\", \"base_outstanding\", \"base_paid_amount\"],\n\t\t\t\tcompany_currency, \"payment_schedule\");\n\t\t\tthis.frm.set_currency_labels([\"payment_amount\", \"outstanding\", \"paid_amount\"],\n\t\t\t\tthis.frm.doc.currency, \"payment_schedule\");\n\n\t\t\tvar schedule_grid = this.frm.fields_dict[\"payment_schedule\"].grid;\n\t\t\t$.each([\"base_payment_amount\", \"base_outstanding\", \"base_paid_amount\"], function(i, fname) {\n\t\t\t\tif (frappe.meta.get_docfield(schedule_grid.doctype, fname))\n\t\t\t\t\tschedule_grid.set_column_disp(fname, me.frm.doc.currency != company_currency);\n\t\t\t});\n\t\t}\n\t}\n\n\ttoggle_item_grid_columns(company_currency) {\n\t\tconst me = this;\n\t\t// toggle columns\n\t\tvar item_grid = this.frm.fields_dict[\"items\"].grid;\n\t\t$.each([\"base_rate\", \"base_price_list_rate\", \"base_amount\", \"base_rate_with_margin\"], function(i, fname) {\n\t\t\tif(frappe.meta.get_docfield(item_grid.doctype, fname))\n\t\t\t\titem_grid.set_column_disp(fname, me.frm.doc.currency != company_currency);\n\t\t});\n\n\t\tvar show = (cint(cur_frm.doc.discount_amount)) ||\n\t\t\t((cur_frm.doc.taxes || []).filter(function(d) {return d.included_in_print_rate===1}).length);\n\n\t\t$.each([\"net_rate\", \"net_amount\"], function(i, fname) {\n\t\t\tif(frappe.meta.get_docfield(item_grid.doctype, fname))\n\t\t\t\titem_grid.set_column_disp(fname, show);\n\t\t});\n\n\t\t$.each([\"base_net_rate\", \"base_net_amount\"], function(i, fname) {\n\t\t\tif(frappe.meta.get_docfield(item_grid.doctype, fname))\n\t\t\t\titem_grid.set_column_disp(fname, (show && (me.frm.doc.currency != company_currency)));\n\t\t});\n\t}\n\n\trecalculate() {\n\t\tthis.calculate_taxes_and_totals();\n\t}\n\n\trecalculate_values() {\n\t\tthis.calculate_taxes_and_totals();\n\t}\n\n\tcalculate_charges() {\n\t\tthis.calculate_taxes_and_totals();\n\t}\n\n\tignore_pricing_rule() {\n\t\tif(this.frm.doc.ignore_pricing_rule) {\n\t\t\tvar me = this;\n\t\t\tvar item_list = [];\n\n\t\t\t$.each(this.frm.doc[\"items\"] || [], function(i, d) {\n\t\t\t\tif (d.item_code && !d.is_free_item) {\n\t\t\t\t\titem_list.push({\n\t\t\t\t\t\t\"doctype\": d.doctype,\n\t\t\t\t\t\t\"name\": d.name,\n\t\t\t\t\t\t\"item_code\": d.item_code,\n\t\t\t\t\t\t\"pricing_rules\": d.pricing_rules,\n\t\t\t\t\t\t\"parenttype\": d.parenttype,\n\t\t\t\t\t\t\"parent\": d.parent\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn this.frm.call({\n\t\t\t\tmethod: \"erpnext.accounts.doctype.pricing_rule.pricing_rule.remove_pricing_rules\",\n\t\t\t\targs: { item_list: item_list },\n\t\t\t\tcallback: function(r) {\n\t\t\t\t\tif (!r.exc && r.message) {\n\t\t\t\t\t\tr.message.forEach(row_item => {\n\t\t\t\t\t\t\tme.remove_pricing_rule(row_item);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tme._set_values_for_item_list(r.message);\n\t\t\t\t\t\tme.calculate_taxes_and_totals();\n\t\t\t\t\t\tif(me.frm.doc.apply_discount_on) me.frm.trigger(\"apply_discount_on\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t} else {\n\t\t\tthis.apply_pricing_rule();\n\t\t}\n\t}\n\n\tapply_pricing_rule(item, calculate_taxes_and_totals) {\n\t\tvar me = this;\n\t\tvar args = this._get_args(item);\n\t\tif (!(args.items && args.items.length)) {\n\t\t\tif(calculate_taxes_and_totals) me.calculate_taxes_and_totals();\n\t\t\treturn;\n\t\t}\n\n\t\treturn this.frm.call({\n\t\t\tmethod: \"erpnext.accounts.doctype.pricing_rule.pricing_rule.apply_pricing_rule\",\n\t\t\targs: {\targs: args, doc: me.frm.doc },\n\t\t\tcallback: function(r) {\n\t\t\t\tif (!r.exc && r.message) {\n\t\t\t\t\tme._set_values_for_item_list(r.message);\n\t\t\t\t\tif(item) me.set_gross_profit(item);\n\t\t\t\t\tif(me.frm.doc.apply_discount_on) me.frm.trigger(\"apply_discount_on\")\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\t_get_args(item) {\n\t\tvar me = this;\n\t\treturn {\n\t\t\t\"items\": this._get_item_list(item),\n\t\t\t\"customer\": me.frm.doc.customer || me.frm.doc.party_name,\n\t\t\t\"quotation_to\": me.frm.doc.quotation_to,\n\t\t\t\"customer_group\": me.frm.doc.customer_group,\n\t\t\t\"territory\": me.frm.doc.territory,\n\t\t\t\"supplier\": me.frm.doc.supplier,\n\t\t\t\"supplier_group\": me.frm.doc.supplier_group,\n\t\t\t\"currency\": me.frm.doc.currency,\n\t\t\t\"conversion_rate\": me.frm.doc.conversion_rate,\n\t\t\t\"price_list\": me.frm.doc.selling_price_list || me.frm.doc.buying_price_list,\n\t\t\t\"price_list_currency\": me.frm.doc.price_list_currency,\n\t\t\t\"plc_conversion_rate\": me.frm.doc.plc_conversion_rate,\n\t\t\t\"company\": me.frm.doc.company,\n\t\t\t\"transaction_date\": me.frm.doc.transaction_date || me.frm.doc.posting_date,\n\t\t\t\"campaign\": me.frm.doc.campaign,\n\t\t\t\"sales_partner\": me.frm.doc.sales_partner,\n\t\t\t\"ignore_pricing_rule\": me.frm.doc.ignore_pricing_rule,\n\t\t\t\"doctype\": me.frm.doc.doctype,\n\t\t\t\"name\": me.frm.doc.name,\n\t\t\t\"is_return\": cint(me.frm.doc.is_return),\n\t\t\t\"update_stock\": in_list(['Sales Invoice', 'Purchase Invoice'], me.frm.doc.doctype) ? cint(me.frm.doc.update_stock) : 0,\n\t\t\t\"conversion_factor\": me.frm.doc.conversion_factor,\n\t\t\t\"pos_profile\": me.frm.doc.doctype == 'Sales Invoice' ? me.frm.doc.pos_profile : '',\n\t\t\t\"coupon_code\": me.frm.doc.coupon_code\n\t\t};\n\t}\n\n\t_get_item_list(item) {\n\t\tvar item_list = [];\n\t\tvar append_item = function(d) {\n\t\t\tif (d.item_code) {\n\t\t\t\titem_list.push({\n\t\t\t\t\t\"doctype\": d.doctype,\n\t\t\t\t\t\"name\": d.name,\n\t\t\t\t\t\"child_docname\": d.name,\n\t\t\t\t\t\"item_code\": d.item_code,\n\t\t\t\t\t\"item_group\": d.item_group,\n\t\t\t\t\t\"brand\": d.brand,\n\t\t\t\t\t\"qty\": d.qty,\n\t\t\t\t\t\"stock_qty\": d.stock_qty,\n\t\t\t\t\t\"uom\": d.uom,\n\t\t\t\t\t\"stock_uom\": d.stock_uom,\n\t\t\t\t\t\"parenttype\": d.parenttype,\n\t\t\t\t\t\"parent\": d.parent,\n\t\t\t\t\t\"pricing_rules\": d.pricing_rules,\n\t\t\t\t\t\"warehouse\": d.warehouse,\n\t\t\t\t\t\"serial_no\": d.serial_no,\n\t\t\t\t\t\"batch_no\": d.batch_no,\n\t\t\t\t\t\"price_list_rate\": d.price_list_rate,\n\t\t\t\t\t\"conversion_factor\": d.conversion_factor || 1.0\n\t\t\t\t});\n\n\t\t\t\t// if doctype is Quotation Item / Sales Order Iten then add Margin Type and rate in item_list\n\t\t\t\tif (in_list([\"Quotation Item\", \"Sales Order Item\", \"Delivery Note Item\", \"Sales Invoice Item\",  \"Purchase Invoice Item\", \"Purchase Order Item\", \"Purchase Receipt Item\",\"Proforma Invoice Item\"]), d.doctype) {\n\t\t\t\t\titem_list[0][\"margin_type\"] = d.margin_type;\n\t\t\t\t\titem_list[0][\"margin_rate_or_amount\"] = d.margin_rate_or_amount;\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tif (item) {\n\t\t\tappend_item(item);\n\t\t} else {\n\t\t\t$.each(this.frm.doc[\"items\"] || [], function(i, d) {\n\t\t\t\tappend_item(d);\n\t\t\t});\n\t\t}\n\t\treturn item_list;\n\t}\n\n\t_set_values_for_item_list(children) {\n\t\tvar me = this;\n\t\tvar price_list_rate_changed = false;\n\t\tvar items_rule_dict = {};\n\n\t\tfor(var i=0, l=children.length; i<l; i++) {\n\t\t\tvar d = children[i];\n\t\t\tvar existing_pricing_rule = frappe.model.get_value(d.doctype, d.name, \"pricing_rules\");\n\t\t\tfor(var k in d) {\n\t\t\t\tvar v = d[k];\n\t\t\t\tif ([\"doctype\", \"name\"].indexOf(k)===-1) {\n\t\t\t\t\tif(k==\"price_list_rate\") {\n\t\t\t\t\t\tif(flt(v) != flt(d.price_list_rate)) price_list_rate_changed = true;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (k !== 'free_item_data') {\n\t\t\t\t\t\tfrappe.model.set_value(d.doctype, d.name, k, v);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// if pricing rule set as blank from an existing value, apply price_list\n\t\t\tif(!me.frm.doc.ignore_pricing_rule && existing_pricing_rule && !d.pricing_rules) {\n\t\t\t\tme.apply_price_list(frappe.get_doc(d.doctype, d.name));\n\t\t\t} else if(!d.pricing_rules) {\n\t\t\t\tme.remove_pricing_rule(frappe.get_doc(d.doctype, d.name));\n\t\t\t}\n\n\t\t\tif (d.free_item_data) {\n\t\t\t\tme.apply_product_discount(d);\n\t\t\t}\n\n\t\t\tif (d.apply_rule_on_other_items) {\n\t\t\t\titems_rule_dict[d.name] = d;\n\t\t\t}\n\t\t}\n\n\t\tme.apply_rule_on_other_items(items_rule_dict);\n\n\t\tif(!price_list_rate_changed) me.calculate_taxes_and_totals();\n\t}\n\n\tapply_rule_on_other_items(args) {\n\t\tconst me = this;\n\t\tconst fields = [\"discount_percentage\", \"pricing_rules\", \"discount_amount\", \"rate\"];\n\n\t\tfor(var k in args) {\n\t\t\tlet data = args[k];\n\n\t\t\tif (data && data.apply_rule_on_other_items) {\n\t\t\t\tme.frm.doc.items.forEach(d => {\n\t\t\t\t\tif (in_list(data.apply_rule_on_other_items, d[data.apply_rule_on])) {\n\t\t\t\t\t\tfor(var k in data) {\n\t\t\t\t\t\t\tif (in_list(fields, k) && data[k] && (data.price_or_product_discount === 'price' || k === 'pricing_rules')) {\n\t\t\t\t\t\t\t\tfrappe.model.set_value(d.doctype, d.name, k, data[k]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\tapply_product_discount(args) {\n\t\tconst items = this.frm.doc.items.filter(d => (d.is_free_item)) || [];\n\n\t\tconst exist_items = items.map(row => (row.item_code, row.pricing_rules));\n\n\t\targs.free_item_data.forEach(pr_row => {\n\t\t\tlet row_to_modify = {};\n\t\t\tif (!items || !in_list(exist_items, (pr_row.item_code, pr_row.pricing_rules))) {\n\n\t\t\t\trow_to_modify = frappe.model.add_child(this.frm.doc,\n\t\t\t\t\tthis.frm.doc.doctype + ' Item', 'items');\n\n\t\t\t} else if(items) {\n\t\t\t\trow_to_modify = items.filter(d => (d.item_code === pr_row.item_code\n\t\t\t\t\t&& d.pricing_rules === pr_row.pricing_rules))[0];\n\t\t\t}\n\n\t\t\tfor (let key in pr_row) {\n\t\t\t\trow_to_modify[key] = pr_row[key];\n\t\t\t}\n\t\t});\n\n\t\t// free_item_data is a temporary variable\n\t\targs.free_item_data = '';\n\t\trefresh_field('items');\n\t}\n\n\tapply_price_list(item, reset_plc_conversion) {\n\t\t// We need to reset plc_conversion_rate sometimes because the call to\n\t\t// `erpnext.stock.get_item_details.apply_price_list` is sensitive to its value\n\t\tif (!reset_plc_conversion) {\n\t\t\tthis.frm.set_value(\"plc_conversion_rate\", \"\");\n\t\t}\n\n\t\tvar me = this;\n\t\tvar args = this._get_args(item);\n\t\tif (!((args.items && args.items.length) || args.price_list)) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (me.in_apply_price_list == true) return;\n\n\t\tme.in_apply_price_list = true;\n\t\treturn this.frm.call({\n\t\t\tmethod: \"erpnext.stock.get_item_details.apply_price_list\",\n\t\t\targs: {\targs: args },\n\t\t\tcallback: function(r) {\n\t\t\t\tif (!r.exc) {\n\t\t\t\t\tfrappe.run_serially([\n\t\t\t\t\t\t() => me.frm.set_value(\"price_list_currency\", r.message.parent.price_list_currency),\n\t\t\t\t\t\t() => me.frm.set_value(\"plc_conversion_rate\", r.message.parent.plc_conversion_rate),\n\t\t\t\t\t\t() => {\n\t\t\t\t\t\t\tif(args.items.length) {\n\t\t\t\t\t\t\t\tme._set_values_for_item_list(r.message.children);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\t() => { me.in_apply_price_list = false; }\n\t\t\t\t\t]);\n\n\t\t\t\t} else {\n\t\t\t\t\tme.in_apply_price_list = false;\n\t\t\t\t}\n\t\t\t}\n\t\t}).always(() => {\n\t\t\tme.in_apply_price_list = false;\n\t\t});\n\t}\n\n\tremove_pricing_rule(item) {\n\t\tlet me = this;\n\t\tconst fields = [\"discount_percentage\",\n\t\t\t\"discount_amount\", \"margin_rate_or_amount\", \"rate_with_margin\"];\n\n\t\tif(item.remove_free_item) {\n\t\t\tvar items = [];\n\n\t\t\tme.frm.doc.items.forEach(d => {\n\t\t\t\tif(d.item_code != item.remove_free_item || !d.is_free_item) {\n\t\t\t\t\titems.push(d);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tme.frm.doc.items = items;\n\t\t\trefresh_field('items');\n\t\t} else if(item.applied_on_items && item.apply_on) {\n\t\t\tconst applied_on_items = item.applied_on_items.split(',');\n\t\t\tme.frm.doc.items.forEach(row => {\n\t\t\t\tif(applied_on_items.includes(row[item.apply_on])) {\n\t\t\t\t\tfields.forEach(f => {\n\t\t\t\t\t\trow[f] = 0;\n\t\t\t\t\t});\n\n\t\t\t\t\t[\"pricing_rules\", \"margin_type\"].forEach(field => {\n\t\t\t\t\t\tif (row[field]) {\n\t\t\t\t\t\t\trow[field] = '';\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tme.trigger_price_list_rate();\n\t\t}\n\t}\n\n\ttrigger_price_list_rate() {\n\t\tvar me  = this;\n\n\t\tthis.frm.doc.items.forEach(child_row => {\n\t\t\tme.frm.script_manager.trigger(\"price_list_rate\",\n\t\t\t\tchild_row.doctype, child_row.name);\n\t\t})\n\t}\n\n\tvalidate_company_and_party() {\n\t\tvar me = this;\n\t\tvar valid = true;\n\n\t\t$.each([\"company\", \"customer\"], function(i, fieldname) {\n\t\t\tif(frappe.meta.has_field(me.frm.doc.doctype, fieldname) && me.frm.doc.doctype != \"Purchase Order\") {\n\t\t\t\tif (!me.frm.doc[fieldname]) {\n\t\t\t\t\tfrappe.msgprint(__(\"Please specify\") + \": \" +\n\t\t\t\t\t\tfrappe.meta.get_label(me.frm.doc.doctype, fieldname, me.frm.doc.name) +\n\t\t\t\t\t\t\". \" + __(\"It is needed to fetch Item Details.\"));\n\t\t\t\t\tvalid = false;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\treturn valid;\n\t}\n\n\tget_terms() {\n\t\tvar me = this;\n\n\t\terpnext.utils.get_terms(this.frm.doc.tc_name, this.frm.doc, function(r) {\n\t\t\tif(!r.exc) {\n\t\t\t\tme.frm.set_value(\"terms\", r.message);\n\t\t\t}\n\t\t});\n\t}\n\n\ttaxes_and_charges() {\n\t\tvar me = this;\n\t\tif(this.frm.doc.taxes_and_charges) {\n\t\t\treturn this.frm.call({\n\t\t\t\tmethod: \"erpnext.controllers.accounts_controller.get_taxes_and_charges\",\n\t\t\t\targs: {\n\t\t\t\t\t\"master_doctype\": frappe.meta.get_docfield(this.frm.doc.doctype, \"taxes_and_charges\",\n\t\t\t\t\t\tthis.frm.doc.name).options,\n\t\t\t\t\t\"master_name\": this.frm.doc.taxes_and_charges\n\t\t\t\t},\n\t\t\t\tcallback: function(r) {\n\t\t\t\t\tif(!r.exc) {\n\t\t\t\t\t\tif(me.frm.doc.shipping_rule && me.frm.doc.taxes) {\n\t\t\t\t\t\t\tfor (let tax of r.message) {\n\t\t\t\t\t\t\t\tme.frm.add_child(\"taxes\", tax);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\trefresh_field(\"taxes\");\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tme.frm.set_value(\"taxes\", r.message);\n\t\t\t\t\t\t\tme.calculate_taxes_and_totals();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\ttax_category() {\n\t\tvar me = this;\n\t\tif(me.frm.updating_party_details) return;\n\n\t\tfrappe.run_serially([\n\t\t\t() => this.update_item_tax_map(),\n\t\t\t() => erpnext.utils.set_taxes(this.frm, \"tax_category\"),\n\t\t]);\n\t}\n\n\tupdate_item_tax_map() {\n\t\tlet me = this;\n\t\tlet item_codes = [];\n\t\tlet item_rates = {};\n\t\tlet item_tax_templates = {};\n\n\t\t$.each(this.frm.doc.items || [], function(i, item) {\n\t\t\tif (item.item_code) {\n\t\t\t\t// Use combination of name and item code in case same item is added multiple times\n\t\t\t\titem_codes.push([item.item_code, item.name]);\n\t\t\t\titem_rates[item.name] = item.net_rate;\n\t\t\t\titem_tax_templates[item.name] = item.item_tax_template;\n\t\t\t}\n\t\t});\n\n\t\tif (item_codes.length) {\n\t\t\treturn this.frm.call({\n\t\t\t\tmethod: \"erpnext.stock.get_item_details.get_item_tax_info\",\n\t\t\t\targs: {\n\t\t\t\t\tcompany: me.frm.doc.company,\n\t\t\t\t\ttax_category: cstr(me.frm.doc.tax_category),\n\t\t\t\t\titem_codes: item_codes,\n\t\t\t\t\titem_rates: item_rates,\n\t\t\t\t\titem_tax_templates: item_tax_templates\n\t\t\t\t},\n\t\t\t\tcallback: function(r) {\n\t\t\t\t\tif (!r.exc) {\n\t\t\t\t\t\t$.each(me.frm.doc.items || [], function(i, item) {\n\t\t\t\t\t\t\tif (item.name && r.message.hasOwnProperty(item.name) && r.message[item.name].item_tax_template) {\n\t\t\t\t\t\t\t\titem.item_tax_template = r.message[item.name].item_tax_template;\n\t\t\t\t\t\t\t\titem.item_tax_rate = r.message[item.name].item_tax_rate;\n\t\t\t\t\t\t\t\tme.add_taxes_from_item_tax_template(item.item_tax_rate);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\titem_tax_template(doc, cdt, cdn) {\n\t\tvar me = this;\n\t\tif(me.frm.updating_party_details) return;\n\n\t\tvar item = frappe.get_doc(cdt, cdn);\n\n\t\tif(item.item_tax_template) {\n\t\t\treturn this.frm.call({\n\t\t\t\tmethod: \"erpnext.stock.get_item_details.get_item_tax_map\",\n\t\t\t\targs: {\n\t\t\t\t\tcompany: me.frm.doc.company,\n\t\t\t\t\titem_tax_template: item.item_tax_template,\n\t\t\t\t\tas_json: true\n\t\t\t\t},\n\t\t\t\tcallback: function(r) {\n\t\t\t\t\tif(!r.exc) {\n\t\t\t\t\t\titem.item_tax_rate = r.message;\n\t\t\t\t\t\tme.calculate_taxes_and_totals();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t} else {\n\t\t\titem.item_tax_rate = \"{}\";\n\t\t\tme.calculate_taxes_and_totals();\n\t\t}\n\t}\n\n\n\n\tis_recurring() {\n\t\t// set default values for recurring documents\n\t\tif(this.frm.doc.is_recurring && this.frm.doc.__islocal) {\n\t\t\tfrappe.msgprint(__(\"Please set recurring after saving\"));\n\t\t\tthis.frm.set_value('is_recurring', 0);\n\t\t\treturn;\n\t\t}\n\n\t\tif(this.frm.doc.is_recurring) {\n\t\t\tif(!this.frm.doc.recurring_id) {\n\t\t\t\tthis.frm.set_value('recurring_id', this.frm.doc.name);\n\t\t\t}\n\n\t\t\tvar owner_email = this.frm.doc.owner==\"Administrator\"\n\t\t\t\t? frappe.user_info(\"Administrator\").email\n\t\t\t\t: this.frm.doc.owner;\n\n\t\t\tthis.frm.doc.notification_email_address = $.map([cstr(owner_email),\n\t\t\t\tcstr(this.frm.doc.contact_email)], function(v) { return v || null; }).join(\", \");\n\t\t\tthis.frm.doc.repeat_on_day_of_month = frappe.datetime.str_to_obj(this.frm.doc.posting_date).getDate();\n\t\t}\n\n\t\trefresh_many([\"notification_email_address\", \"repeat_on_day_of_month\"]);\n\t}\n\n\tfrom_date() {\n\t\t// set to_date\n\t\tif(this.frm.doc.from_date) {\n\t\t\tvar recurring_type_map = {'Monthly': 1, 'Quarterly': 3, 'Half-yearly': 6,\n\t\t\t\t'Yearly': 12};\n\n\t\t\tvar months = recurring_type_map[this.frm.doc.recurring_type];\n\t\t\tif(months) {\n\t\t\t\tvar to_date = frappe.datetime.add_months(this.frm.doc.from_date,\n\t\t\t\t\tmonths);\n\t\t\t\tthis.frm.doc.to_date = frappe.datetime.add_days(to_date, -1);\n\t\t\t\trefresh_field('to_date');\n\t\t\t}\n\t\t}\n\t}\n\n\tset_gross_profit(item) {\n\t\tif ([\"Sales Order\", \"Quotation\",\"Proforma Invoice\"].includes(this.frm.doc.doctype) && item.valuation_rate) {\n\t\t\tvar rate = flt(item.rate) * flt(this.frm.doc.conversion_rate || 1);\n\t\t\titem.gross_profit = flt(((rate - item.valuation_rate) * item.stock_qty), precision(\"amount\", item));\n\t\t}\n\t}\n\n\tsetup_item_selector() {\n\t\t// TODO: remove item selector\n\n\t\treturn;\n\t\t// if(!this.item_selector) {\n\t\t// \tthis.item_selector = new erpnext.ItemSelector({frm: this.frm});\n\t\t// }\n\t}\n\n\tget_advances() {\n\t\tif(!this.frm.is_return) {\n\t\t\treturn this.frm.call({\n\t\t\t\tmethod: \"set_advances\",\n\t\t\t\tdoc: this.frm.doc,\n\t\t\t\tcallback: function(r, rt) {\n\t\t\t\t\trefresh_field(\"advances\");\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\t}\n\n\tmake_payment_entry() {\n\t\treturn frappe.call({\n\t\t\tmethod: cur_frm.cscript.get_method_for_payment(),\n\t\t\targs: {\n\t\t\t\t\"dt\": cur_frm.doc.doctype,\n\t\t\t\t\"dn\": cur_frm.doc.name\n\t\t\t},\n\t\t\tcallback: function(r) {\n\t\t\t\tvar doclist = frappe.model.sync(r.message);\n\t\t\t\tfrappe.set_route(\"Form\", doclist[0].doctype, doclist[0].name);\n\t\t\t\t// cur_frm.refresh_fields()\n\t\t\t}\n\t\t});\n\t}\n\n\tmake_quality_inspection () {\n\t\tlet data = [];\n\t\tconst fields = [\n\t\t\t{\n\t\t\t\tlabel: \"Items\",\n\t\t\t\tfieldtype: \"Table\",\n\t\t\t\tfieldname: \"items\",\n\t\t\t\tcannot_add_rows: true,\n\t\t\t\tin_place_edit: true,\n\t\t\t\tdata: data,\n\t\t\t\tget_data: () => {\n\t\t\t\t\treturn data;\n\t\t\t\t},\n\t\t\t\tfields: [\n\t\t\t\t\t{\n\t\t\t\t\t\tfieldtype: \"Data\",\n\t\t\t\t\t\tfieldname: \"docname\",\n\t\t\t\t\t\thidden: true\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tfieldtype: \"Read Only\",\n\t\t\t\t\t\tfieldname: \"item_code\",\n\t\t\t\t\t\tlabel: __(\"Item Code\"),\n\t\t\t\t\t\tin_list_view: true\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tfieldtype: \"Read Only\",\n\t\t\t\t\t\tfieldname: \"item_name\",\n\t\t\t\t\t\tlabel: __(\"Item Name\"),\n\t\t\t\t\t\tin_list_view: true\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tfieldtype: \"Float\",\n\t\t\t\t\t\tfieldname: \"qty\",\n\t\t\t\t\t\tlabel: __(\"Accepted Quantity\"),\n\t\t\t\t\t\tin_list_view: true,\n\t\t\t\t\t\tread_only: true\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tfieldtype: \"Float\",\n\t\t\t\t\t\tfieldname: \"sample_size\",\n\t\t\t\t\t\tlabel: __(\"Sample Size\"),\n\t\t\t\t\t\treqd: true,\n\t\t\t\t\t\tin_list_view: true\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tfieldtype: \"Data\",\n\t\t\t\t\t\tfieldname: \"description\",\n\t\t\t\t\t\tlabel: __(\"Description\"),\n\t\t\t\t\t\thidden: true\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tfieldtype: \"Data\",\n\t\t\t\t\t\tfieldname: \"serial_no\",\n\t\t\t\t\t\tlabel: __(\"Serial No\"),\n\t\t\t\t\t\thidden: true\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tfieldtype: \"Data\",\n\t\t\t\t\t\tfieldname: \"batch_no\",\n\t\t\t\t\t\tlabel: __(\"Batch No\"),\n\t\t\t\t\t\thidden: true\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t}\n\t\t];\n\n\t\tconst me = this;\n\t\tconst dialog = new frappe.ui.Dialog({\n\t\t\ttitle: __(\"Select Items for Quality Inspection\"),\n\t\t\tfields: fields,\n\t\t\tprimary_action: function () {\n\t\t\t\tconst data = dialog.get_values();\n\t\t\t\tfrappe.call({\n\t\t\t\t\tmethod: \"erpnext.controllers.stock_controller.make_quality_inspections\",\n\t\t\t\t\targs: {\n\t\t\t\t\t\tdoctype: me.frm.doc.doctype,\n\t\t\t\t\t\tdocname: me.frm.doc.name,\n\t\t\t\t\t\titems: data.items\n\t\t\t\t\t},\n\t\t\t\t\tfreeze: true,\n\t\t\t\t\tcallback: function (r) {\n\t\t\t\t\t\tif (r.message.length > 0) {\n\t\t\t\t\t\t\tif (r.message.length === 1) {\n\t\t\t\t\t\t\t\tfrappe.set_route(\"Form\", \"Quality Inspection\", r.message[0]);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tfrappe.route_options = {\n\t\t\t\t\t\t\t\t\t\"reference_type\": me.frm.doc.doctype,\n\t\t\t\t\t\t\t\t\t\"reference_name\": me.frm.doc.name\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\tfrappe.set_route(\"List\", \"Quality Inspection\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdialog.hide();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\tprimary_action_label: __(\"Create\")\n\t\t});\n\n\t\tthis.frm.doc.items.forEach(item => {\n\t\t\tif (!item.quality_inspection) {\n\t\t\t\tlet dialog_items = dialog.fields_dict.items;\n\t\t\t\tdialog_items.df.data.push({\n\t\t\t\t\t\"docname\": item.name,\n\t\t\t\t\t\"item_code\": item.item_code,\n\t\t\t\t\t\"item_name\": item.item_name,\n\t\t\t\t\t\"qty\": item.qty,\n\t\t\t\t\t\"description\": item.description,\n\t\t\t\t\t\"serial_no\": item.serial_no,\n\t\t\t\t\t\"batch_no\": item.batch_no\n\t\t\t\t});\n\t\t\t\tdialog_items.grid.refresh();\n\t\t\t}\n\t\t});\n\n\t\tdata = dialog.fields_dict.items.df.data;\n\t\tif (!data.length) {\n\t\t\tfrappe.msgprint(__(\"All items in this document already have a linked Quality Inspection.\"));\n\t\t} else {\n\t\t\tdialog.show();\n\t\t}\n\t}\n\n\tget_method_for_payment(){\n\t\tvar method = \"erpnext.accounts.doctype.payment_entry.payment_entry.get_payment_entry\";\n\t\tif(cur_frm.doc.__onload && cur_frm.doc.__onload.make_payment_via_journal_entry){\n\t\t\tif(in_list(['Sales Invoice', 'Purchase Invoice'],  cur_frm.doc.doctype)){\n\t\t\t\tmethod = \"erpnext.accounts.doctype.journal_entry.journal_entry.get_payment_entry_against_invoice\";\n\t\t\t}else {\n\t\t\t\tmethod= \"erpnext.accounts.doctype.journal_entry.journal_entry.get_payment_entry_against_order\";\n\t\t\t}\n\t\t}\n\n\t\treturn method\n\t}\n\n\tset_query_for_batch(doc, cdt, cdn) {\n\t\t// Show item's batches in the dropdown of batch no\n\n\t\tvar me = this;\n\t\tvar item = frappe.get_doc(cdt, cdn);\n\n\t\tif(!item.item_code) {\n\t\t\tfrappe.throw(__(\"Please enter Item Code to get batch no\"));\n\t\t} else if (doc.doctype == \"Purchase Receipt\" ||\n\t\t\t(doc.doctype == \"Purchase Invoice\" && doc.update_stock)) {\n\t\t\treturn {\n\t\t\t\tfilters: {'item': item.item_code}\n\t\t\t}\n\t\t} else {\n\t\t\tlet filters = {\n\t\t\t\t'item_code': item.item_code,\n\t\t\t\t'posting_date': me.frm.doc.posting_date || frappe.datetime.nowdate(),\n\t\t\t}\n\n\t\t\tif (doc.is_return) {\n\t\t\t\tfilters[\"is_return\"] = 1;\n\t\t\t}\n\n\t\t\tif (item.warehouse) filters[\"warehouse\"] = item.warehouse;\n\n\t\t\treturn {\n\t\t\t\tquery : \"erpnext.controllers.queries.get_batch_no\",\n\t\t\t\tfilters: filters\n\t\t\t}\n\t\t}\n\t}\n\n\tset_query_for_item_tax_template(doc, cdt, cdn) {\n\t\tvar item = frappe.get_doc(cdt, cdn);\n\t\tif(!item.item_code) {\n\t\t\treturn doc.company ? {filters: {company: doc.company}} : {};\n\t\t} else {\n\t\t\tlet filters = {\n\t\t\t\t'item_code': item.item_code,\n\t\t\t\t'valid_from': [\"<=\", doc.transaction_date || doc.bill_date || doc.posting_date],\n\t\t\t\t'item_group': item.item_group,\n\t\t\t}\n\n\t\t\tif (doc.tax_category)\n\t\t\t\tfilters['tax_category'] = doc.tax_category;\n\t\t\tif (doc.company)\n\t\t\t\tfilters['company'] = doc.company;\n\t\t\treturn {\n\t\t\t\tquery: \"erpnext.controllers.queries.get_tax_template\",\n\t\t\t\tfilters: filters\n\t\t\t}\n\t\t}\n\t}\n\n\tpayment_terms_template() {\n\t\tvar me = this;\n\t\tconst doc = this.frm.doc;\n\t\tif(doc.payment_terms_template && doc.doctype !== 'Delivery Note') {\n\t\t\tvar posting_date = doc.posting_date || doc.transaction_date;\n\t\t\tfrappe.call({\n\t\t\t\tmethod: \"erpnext.controllers.accounts_controller.get_payment_terms\",\n\t\t\t\targs: {\n\t\t\t\t\tterms_template: doc.payment_terms_template,\n\t\t\t\t\tposting_date: posting_date,\n\t\t\t\t\tgrand_total: doc.rounded_total || doc.grand_total,\n\t\t\t\t\tbase_grand_total: doc.base_rounded_total || doc.base_grand_total,\n\t\t\t\t\tbill_date: doc.bill_date\n\t\t\t\t},\n\t\t\t\tcallback: function(r) {\n\t\t\t\t\tif(r.message && !r.exc) {\n\t\t\t\t\t\tme.frm.set_value(\"payment_schedule\", r.message);\n\t\t\t\t\t\tconst company_currency = me.get_company_currency();\n\t\t\t\t\t\tme.update_payment_schedule_grid_labels(company_currency);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\t}\n\n\tpayment_term(doc, cdt, cdn) {\n\t\tconst me = this;\n\t\tvar row = locals[cdt][cdn];\n\t\tif(row.payment_term) {\n\t\t\tfrappe.call({\n\t\t\t\tmethod: \"erpnext.controllers.accounts_controller.get_payment_term_details\",\n\t\t\t\targs: {\n\t\t\t\t\tterm: row.payment_term,\n\t\t\t\t\tbill_date: this.frm.doc.bill_date,\n\t\t\t\t\tposting_date: this.frm.doc.posting_date || this.frm.doc.transaction_date,\n\t\t\t\t\tgrand_total: this.frm.doc.rounded_total || this.frm.doc.grand_total,\n\t\t\t\t\tbase_grand_total: this.frm.doc.base_rounded_total || this.frm.doc.base_grand_total\n\t\t\t\t},\n\t\t\t\tcallback: function(r) {\n\t\t\t\t\tif(r.message && !r.exc) {\n\t\t\t\t\t\tfor (var d in r.message) {\n\t\t\t\t\t\t\tfrappe.model.set_value(cdt, cdn, d, r.message[d]);\n\t\t\t\t\t\t\tconst company_currency = me.get_company_currency();\n\t\t\t\t\t\t\tme.update_payment_schedule_grid_labels(company_currency);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\t}\n\n\tagainst_blanket_order(doc, cdt, cdn) {\n\t\tvar item = locals[cdt][cdn];\n\t\tif(!item.against_blanket_order) {\n\t\t\tfrappe.model.set_value(this.frm.doctype + \" Item\", item.name, \"blanket_order\", null);\n\t\t\tfrappe.model.set_value(this.frm.doctype + \" Item\", item.name, \"blanket_order_rate\", 0.00);\n\t\t}\n\t}\n\n\tblanket_order(doc, cdt, cdn) {\n\t\tvar me = this;\n\t\tvar item = locals[cdt][cdn];\n\t\tif (item.blanket_order && (item.parenttype==\"Sales Order\" || item.parenttype==\"Purchase Order\")) {\n\t\t\tfrappe.call({\n\t\t\t\tmethod: \"erpnext.stock.get_item_details.get_blanket_order_details\",\n\t\t\t\targs: {\n\t\t\t\t\targs:{\n\t\t\t\t\t\titem_code: item.item_code,\n\t\t\t\t\t\tcustomer: doc.customer,\n\t\t\t\t\t\tsupplier: doc.supplier,\n\t\t\t\t\t\tcompany: doc.company,\n\t\t\t\t\t\ttransaction_date: doc.transaction_date,\n\t\t\t\t\t\tblanket_order: item.blanket_order\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tcallback: function(r) {\n\t\t\t\t\tif (!r.message) {\n\t\t\t\t\t\tfrappe.throw(__(\"Invalid Blanket Order for the selected Customer and Item\"));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tfrappe.run_serially([\n\t\t\t\t\t\t\t() => frappe.model.set_value(cdt, cdn, \"blanket_order_rate\", r.message.blanket_order_rate),\n\t\t\t\t\t\t\t() => me.frm.script_manager.trigger(\"price_list_rate\", cdt, cdn)\n\t\t\t\t\t\t]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\t}\n\n\tset_reserve_warehouse() {\n\t\tthis.autofill_warehouse(this.frm.doc.supplied_items, \"reserve_warehouse\", this.frm.doc.set_reserve_warehouse);\n\t}\n\n\tset_warehouse() {\n\t\tthis.autofill_warehouse(this.frm.doc.items, \"warehouse\", this.frm.doc.set_warehouse);\n\t}\n\n\tset_target_warehouse() {\n\t\tthis.autofill_warehouse(this.frm.doc.items, \"target_warehouse\", this.frm.doc.set_target_warehouse);\n\t}\n\n\tset_from_warehouse() {\n\t\tthis.autofill_warehouse(this.frm.doc.items, \"from_warehouse\", this.frm.doc.set_from_warehouse);\n\t}\n\n\tautofill_warehouse (child_table, warehouse_field, warehouse) {\n\t\tif (warehouse && child_table && child_table.length) {\n\t\t\tlet doctype = child_table[0].doctype;\n\t\t\t$.each(child_table || [], function(i, item) {\n\t\t\t\tfrappe.model.set_value(doctype, item.name, warehouse_field, warehouse);\n\t\t\t});\n\t\t}\n\t}\n\n\tcoupon_code() {\n\t\tvar me = this;\n\t\tfrappe.run_serially([\n\t\t\t() => this.frm.doc.ignore_pricing_rule=1,\n\t\t\t() => me.ignore_pricing_rule(),\n\t\t\t() => this.frm.doc.ignore_pricing_rule=0,\n\t\t\t() => me.apply_pricing_rule()\n\t\t]);\n\t}\n}\n\nerpnext.show_serial_batch_selector = function (frm, d, callback, on_close, show_dialog) {\n\tlet warehouse, receiving_stock, existing_stock;\n\tif (frm.doc.is_return) {\n\t\tif ([\"Purchase Receipt\", \"Purchase Invoice\"].includes(frm.doc.doctype)) {\n\t\t\texisting_stock = true;\n\t\t\twarehouse = d.warehouse;\n\t\t} else if ([\"Delivery Note\", \"Sales Invoice\"].includes(frm.doc.doctype)) {\n\t\t\treceiving_stock = true;\n\t\t}\n\t} else {\n\t\tif (frm.doc.doctype == \"Stock Entry\") {\n\t\t\tif (frm.doc.purpose == \"Material Receipt\") {\n\t\t\t\treceiving_stock = true;\n\t\t\t} else {\n\t\t\t\texisting_stock = true;\n\t\t\t\twarehouse = d.s_warehouse;\n\t\t\t}\n\t\t} else {\n\t\t\texisting_stock = true;\n\t\t\twarehouse = d.warehouse;\n\t\t}\n\t}\n\n\tif (!warehouse) {\n\t\tif (receiving_stock) {\n\t\t\twarehouse = [\"like\", \"\"];\n\t\t} else if (existing_stock) {\n\t\t\twarehouse = [\"!=\", \"\"];\n\t\t}\n\t}\n\n\tfrappe.require(\"assets/erpnext/js/utils/serial_no_batch_selector.js\", function() {\n\t\tnew erpnext.SerialNoBatchSelector({\n\t\t\tfrm: frm,\n\t\t\titem: d,\n\t\t\twarehouse_details: {\n\t\t\t\ttype: \"Warehouse\",\n\t\t\t\tname: warehouse\n\t\t\t},\n\t\t\tcallback: callback,\n\t\t\ton_close: on_close\n\t\t}, show_dialog);\n\t});\n}\n\nerpnext.apply_putaway_rule = (frm, purpose=null) => {\n\tif (!frm.doc.company) {\n\t\tfrappe.throw({message: __(\"Please select a Company first.\"), title: __(\"Mandatory\")});\n\t}\n\tif (!frm.doc.items.length) return;\n\n\tfrappe.call({\n\t\tmethod: \"erpnext.stock.doctype.putaway_rule.putaway_rule.apply_putaway_rule\",\n\t\targs: {\n\t\t\tdoctype: frm.doctype,\n\t\t\titems: frm.doc.items,\n\t\t\tcompany: frm.doc.company,\n\t\t\tsync: true,\n\t\t\tpurpose: purpose\n\t\t},\n\t\tcallback: (result) => {\n\t\t\tif (!result.exc && result.message) {\n\t\t\t\tfrm.clear_table(\"items\");\n\n\t\t\t\tlet items =  result.message;\n\t\t\t\titems.forEach((row) => {\n\t\t\t\t\tdelete row[\"name\"]; // dont overwrite name from server side\n\t\t\t\t\tlet child = frm.add_child(\"items\");\n\t\t\t\t\tObject.assign(child, row);\n\t\t\t\t\tfrm.script_manager.trigger(\"qty\", child.doctype, child.name);\n\t\t\t\t});\n\t\t\t\tfrm.get_field(\"items\").grid.refresh();\n\t\t\t}\n\t\t}\n\t});\n};\n", "// Copyright (c) 2018, Frappe Technologies Pvt. Ltd. and Contributors\n// MIT License. See license.txt\nimport DataTable from \"frappe-datatable\";\n\nfrappe.provide(\"frappe.widget.utils\");\nfrappe.provide(\"frappe.views\");\nfrappe.provide(\"frappe.query_reports\");\n\nfrappe.standard_pages[\"query-report\"] = function () {\n\tvar wrapper = frappe.container.add_page(\"query-report\");\n\n\tfrappe.ui.make_app_page({\n\t\tparent: wrapper,\n\t\ttitle: __(\"Query Report\"),\n\t\tsingle_column: true,\n\t});\n\n\tfrappe.query_report = new frappe.views.QueryReport({\n\t\tparent: wrapper,\n\t});\n\n\t$(wrapper).bind(\"show\", function () {\n\t\tfrappe.query_report.show();\n\t});\n};\n\nfrappe.views.QueryReport = class QueryReport extends frappe.views.BaseList {\n\tshow() {\n\t\tthis.init().then(() => this.load());\n\t}\n\n\tinit() {\n\t\tif (this.init_promise) {\n\t\t\treturn this.init_promise;\n\t\t}\n\n\t\tlet tasks = [\n\t\t\tthis.setup_defaults,\n\t\t\tthis.setup_page,\n\t\t\tthis.setup_report_wrapper,\n\t\t\tthis.setup_events,\n\t\t].map((fn) => fn.bind(this));\n\t\tthis.init_promise = frappe.run_serially(tasks);\n\t\treturn this.init_promise;\n\t}\n\n\tsetup_defaults() {\n\t\tthis.route = frappe.get_route();\n\t\tthis.page_name = frappe.get_route_str();\n\n\t\t// Setup buttons\n\t\tthis.primary_action = null;\n\n\t\t// throttle refresh for 300ms\n\t\tthis.refresh = frappe.utils.throttle(this.refresh, 300);\n\n\t\tthis.menu_items = [];\n\t}\n\n\tupdate_url_with_filters() {\n\t\tif (frappe.get_route_str() == this.page_name) {\n\t\t\twindow.history.replaceState(null, null, this.get_url_with_filters());\n\t\t}\n\t}\n\n\tget_url_with_filters() {\n\t\tconst query_params = Object.entries(this.get_filter_values())\n\t\t\t.map(([field, value], _idx) => {\n\t\t\t\t// multiselects\n\t\t\t\tif (Array.isArray(value)) {\n\t\t\t\t\tif (!value.length) return \"\";\n\t\t\t\t\tvalue = JSON.stringify(value);\n\t\t\t\t}\n\t\t\t\treturn `${field}=${encodeURIComponent(value)}`;\n\t\t\t})\n\t\t\t.filter(Boolean)\n\t\t\t.join(\"&\");\n\n\t\tlet full_url = window.location.href.replace(window.location.search, \"\");\n\t\tif (query_params) {\n\t\t\tfull_url += \"?\" + query_params;\n\t\t}\n\t\treturn full_url;\n\t}\n\n\tset_default_secondary_action() {\n\t\tthis.refresh_button && this.refresh_button.remove();\n\t\tthis.refresh_button = this.page.add_action_icon(\"refresh\", () => {\n\t\t\tthis.setup_progress_bar();\n\t\t\tthis.refresh();\n\t\t});\n\t}\n\n\tget_no_result_message() {\n\t\treturn `<div class=\"msg-box no-border\">\n\t\t\t<div>\n\t\t\t\t<img src=\"/assets/frappe/images/ui-states/list-empty-state.svg\" alt=\"Generic Empty State\" class=\"null-state\">\n\t\t\t</div>\n\t\t\t<p>${__(\"Nothing to show\")}</p>\n\t\t</div>`;\n\t}\n\n\tsetup_events() {\n\t\tfrappe.realtime.on(\"report_generated\", (data) => {\n\t\t\tthis.toggle_primary_button_disabled(false);\n\t\t\tif (data.report_name) {\n\t\t\t\tthis.prepared_report_action = \"Rebuild\";\n\t\t\t\t// If generated report and currently active Prepared Report has same fiters\n\t\t\t\t// then refresh the Prepared Report\n\t\t\t\t// Otherwise show alert with the link to the Prepared Report\n\t\t\t\tif (data.name == this.prepared_report_doc_name) {\n\t\t\t\t\tthis.refresh();\n\t\t\t\t} else {\n\t\t\t\t\tlet alert_message = `Report ${this.report_name} generated.\n\t\t\t\t\t\t<a href=\"#query-report/${this.report_name}/?prepared_report_name=${data.name}\">View</a>`;\n\t\t\t\t\tfrappe.show_alert({ message: alert_message, indicator: \"orange\" });\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tthis.page.wrapper.on(\"click\", \"[data-action]\", (e) => {\n\t\t\tlet action_name = $(e.currentTarget).data(\"action\");\n\t\t\tlet action = this[action_name];\n\t\t\tif (action.call) {\n\t\t\t\taction.call(this, e);\n\t\t\t}\n\t\t});\n\t}\n\n\tload() {\n\t\tif (frappe.get_route().length < 2) {\n\t\t\tthis.toggle_nothing_to_show(true);\n\t\t\treturn;\n\t\t}\n\n\t\tlet route_options = {};\n\t\troute_options = Object.assign(route_options, frappe.route_options);\n\n\t\tif (this.report_name !== frappe.get_route()[1]) {\n\t\t\t// different report\n\t\t\tthis.load_report(route_options);\n\t\t} else if (frappe.has_route_options()) {\n\t\t\t// filters passed through routes\n\t\t\t// so refresh report again\n\t\t\tthis.refresh_report(route_options);\n\t\t} else {\n\t\t\t// same report\n\t\t\t// don't do anything to preserve state\n\t\t\t// like filters and datatable column widths\n\t\t}\n\t}\n\n\tload_report(route_options) {\n\t\tthis.page.clear_inner_toolbar();\n\t\tthis.route = frappe.get_route();\n\t\tthis.page_name = frappe.get_route_str();\n\t\tthis.report_name = this.route[1];\n\t\tthis.page_title = __(this.report_name);\n\t\tthis.show_save = false;\n\t\tthis.menu_items = this.get_menu_items();\n\t\tthis.datatable = null;\n\t\tthis.prepared_report_action = \"New\";\n\n\t\tfrappe.run_serially([\n\t\t\t() => this.get_report_doc(),\n\t\t\t() => this.get_report_settings(),\n\t\t\t() => this.setup_progress_bar(),\n\t\t\t() => this.setup_page_head(),\n\t\t\t() => this.refresh_report(route_options),\n\t\t\t() => this.add_chart_buttons_to_toolbar(true),\n\t\t\t() => this.add_card_button_to_toolbar(true),\n\t\t]);\n\t}\n\n\tadd_card_button_to_toolbar() {\n\t\tthis.page.add_inner_button(__(\"Create Card\"), () => {\n\t\t\tthis.add_card_to_dashboard();\n\t\t});\n\t}\n\n\tadd_chart_buttons_to_toolbar(show) {\n\t\tif (show) {\n\t\t\tthis.create_chart_button && this.create_chart_button.remove();\n\t\t\tthis.create_chart_button = this.page.add_button(__(\"Set Chart\"), () => {\n\t\t\t\tthis.open_create_chart_dialog();\n\t\t\t});\n\n\t\t\tif (this.chart_fields || this.chart_options) {\n\t\t\t\tthis.add_to_dashboard_button && this.add_to_dashboard_button.remove();\n\t\t\t\tthis.add_to_dashboard_button = this.page.add_button(\n\t\t\t\t\t__(\"Add Chart to Dashboard\"),\n\t\t\t\t\t() => {\n\t\t\t\t\t\tthis.add_chart_to_dashboard();\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.create_chart_button && this.create_chart_button.remove();\n\t\t\tthis.add_to_dashboard_button && this.add_to_dashboard_button.remove();\n\t\t}\n\t}\n\n\tadd_card_to_dashboard() {\n\t\tlet field_options = frappe.report_utils.get_field_options_from_report(\n\t\t\tthis.columns,\n\t\t\tthis.raw_data\n\t\t);\n\t\tconst dashboard_field = frappe.dashboard_utils.get_dashboard_link_field();\n\t\tconst set_standard = frappe.boot.developer_mode;\n\n\t\tconst dialog = new frappe.ui.Dialog({\n\t\t\ttitle: __(\"Create Card\"),\n\t\t\tfields: [\n\t\t\t\t{\n\t\t\t\t\tfieldname: \"report_field\",\n\t\t\t\t\tlabel: __(\"Field\"),\n\t\t\t\t\tfieldtype: \"Select\",\n\t\t\t\t\toptions: field_options.numeric_fields,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tfieldname: \"cb_1\",\n\t\t\t\t\tfieldtype: \"Column Break\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tfieldname: \"report_function\",\n\t\t\t\t\tlabel: __(\"Function\"),\n\t\t\t\t\toptions: [\"Sum\", \"Average\", \"Minimum\", \"Maximum\"],\n\t\t\t\t\tfieldtype: \"Select\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tfieldname: \"sb_1\",\n\t\t\t\t\tlabel: __(\"Add to Dashboard\"),\n\t\t\t\t\tfieldtype: \"Section Break\",\n\t\t\t\t},\n\t\t\t\tdashboard_field,\n\t\t\t\t{\n\t\t\t\t\tfieldname: \"cb_2\",\n\t\t\t\t\tfieldtype: \"Column Break\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tfieldname: \"label\",\n\t\t\t\t\tlabel: __(\"Card Label\"),\n\t\t\t\t\tfieldtype: \"Data\",\n\t\t\t\t},\n\t\t\t],\n\t\t\tprimary_action_label: __(\"Add\"),\n\t\t\tprimary_action: (values) => {\n\t\t\t\tif (!values.label) {\n\t\t\t\t\tvalues.label = `${values.report_function} of ${toTitle(values.report_field)}`;\n\t\t\t\t}\n\t\t\t\tthis.create_number_card(values, values.dashboard, values.label, set_standard);\n\t\t\t\tdialog.hide();\n\t\t\t},\n\t\t});\n\n\t\tdialog.show();\n\t}\n\n\tadd_chart_to_dashboard() {\n\t\tif (this.chart_fields || this.chart_options) {\n\t\t\tconst dashboard_field = frappe.dashboard_utils.get_dashboard_link_field();\n\t\t\tconst set_standard = frappe.boot.developer_mode;\n\n\t\t\tconst dialog = new frappe.ui.Dialog({\n\t\t\t\ttitle: __(\"Create Chart\"),\n\t\t\t\tfields: [\n\t\t\t\t\t{\n\t\t\t\t\t\tfieldname: \"dashboard_chart_name\",\n\t\t\t\t\t\tlabel: \"Chart Name\",\n\t\t\t\t\t\tfieldtype: \"Data\",\n\t\t\t\t\t},\n\t\t\t\t\tdashboard_field,\n\t\t\t\t],\n\t\t\t\tprimary_action_label: __(\"Add\"),\n\t\t\t\tprimary_action: (values) => {\n\t\t\t\t\tthis.create_dashboard_chart(\n\t\t\t\t\t\tthis.chart_fields || this.chart_options,\n\t\t\t\t\t\tvalues.dashboard,\n\t\t\t\t\t\tvalues.dashboard_chart_name,\n\t\t\t\t\t\tset_standard\n\t\t\t\t\t);\n\t\t\t\t\tdialog.hide();\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tdialog.show();\n\t\t} else {\n\t\t\tfrappe.msgprint(__(\"Please Set Chart\"));\n\t\t}\n\t}\n\n\tcreate_number_card(values, dashboard_name, card_name, set_standard) {\n\t\tlet args = {\n\t\t\tdashboard: dashboard_name || null,\n\t\t\ttype: \"Report\",\n\t\t\treport_name: this.report_name,\n\t\t\tfilters_json: JSON.stringify(this.get_filter_values()),\n\t\t\tset_standard: set_standard,\n\t\t};\n\t\tObject.assign(args, values);\n\n\t\tthis.add_to_dashboard(\n\t\t\t\"frappe.desk.doctype.number_card.number_card.create_report_number_card\",\n\t\t\targs,\n\t\t\tdashboard_name,\n\t\t\tcard_name,\n\t\t\t\"Number Card\"\n\t\t);\n\t}\n\n\tcreate_dashboard_chart(chart_args, dashboard_name, chart_name, set_standard) {\n\t\tlet args = {\n\t\t\tdashboard: dashboard_name || null,\n\t\t\tchart_type: \"Report\",\n\t\t\treport_name: this.report_name,\n\t\t\ttype: chart_args.chart_type || frappe.model.unscrub(chart_args.type),\n\t\t\tcolor: chart_args.color,\n\t\t\tfilters_json: JSON.stringify(this.get_filter_values()),\n\t\t\tcustom_options: {},\n\t\t\tset_standard: set_standard,\n\t\t};\n\n\t\tfor (let key in chart_args) {\n\t\t\tif (key != \"data\") {\n\t\t\t\targs[\"custom_options\"][key] = chart_args[key];\n\t\t\t}\n\t\t}\n\n\t\tif (this.chart_fields) {\n\t\t\tlet x_field_title = toTitle(chart_args.x_field);\n\t\t\tlet y_field_title = toTitle(chart_args.y_fields[0]);\n\t\t\tchart_name = chart_name || `${this.report_name}: ${x_field_title} vs ${y_field_title}`;\n\n\t\t\tObject.assign(args, {\n\t\t\t\tchart_name: chart_name,\n\t\t\t\tx_field: chart_args.x_field,\n\t\t\t\ty_axis: chart_args.y_axis_fields.map((f) => {\n\t\t\t\t\treturn { y_field: f.y_field, color: f.color };\n\t\t\t\t}),\n\t\t\t\tuse_report_chart: 0,\n\t\t\t});\n\t\t} else {\n\t\t\tchart_name = chart_name || this.report_name;\n\t\t\tObject.assign(args, {\n\t\t\t\tchart_name: chart_name,\n\t\t\t\tuse_report_chart: 1,\n\t\t\t});\n\t\t}\n\n\t\tthis.add_to_dashboard(\n\t\t\t\"frappe.desk.doctype.dashboard_chart.dashboard_chart.create_report_chart\",\n\t\t\targs,\n\t\t\tdashboard_name,\n\t\t\tchart_name,\n\t\t\t\"Dashboard Chart\"\n\t\t);\n\t}\n\n\tadd_to_dashboard(method, args, dashboard_name, name, doctype) {\n\t\tfrappe.xcall(method, { args: args }).then(() => {\n\t\t\tlet message;\n\t\t\tif (dashboard_name) {\n\t\t\t\tlet dashboard_route_html = `<a href=\"#dashboard-view/${dashboard_name}\">${dashboard_name}</a>`;\n\t\t\t\tmessage = __(\"New {0} {1} added to Dashboard {2}\", [\n\t\t\t\t\t__(doctype),\n\t\t\t\t\tname,\n\t\t\t\t\tdashboard_route_html,\n\t\t\t\t]);\n\t\t\t} else {\n\t\t\t\tmessage = __(\"New {0} {1} created\", [__(doctype), name]);\n\t\t\t}\n\n\t\t\tfrappe.msgprint(message, __(\"New {0} Created\", [__(doctype)]));\n\t\t});\n\t}\n\n\trefresh_report(route_options) {\n\t\tthis.toggle_message(true);\n\t\tthis.toggle_report(false);\n\n\t\treturn frappe.run_serially([\n\t\t\t() => this.setup_filters(),\n\t\t\t() => this.set_route_filters(route_options),\n\t\t\t() => this.page.clear_custom_actions(),\n\t\t\t() => this.report_settings.onload && this.report_settings.onload(this),\n\t\t\t() => this.refresh(),\n\t\t]);\n\t}\n\n\tget_report_doc() {\n\t\treturn frappe.model\n\t\t\t.with_doc(\"Report\", this.report_name)\n\t\t\t.then((doc) => {\n\t\t\t\tthis.report_doc = doc;\n\t\t\t})\n\t\t\t.then(() => frappe.model.with_doctype(this.report_doc.ref_doctype));\n\t}\n\n\tget_report_settings() {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tif (frappe.query_reports[this.report_name]) {\n\t\t\t\tthis.report_settings = frappe.query_reports[this.report_name];\n\t\t\t\tresolve();\n\t\t\t} else {\n\t\t\t\tfrappe\n\t\t\t\t\t.xcall(\"frappe.desk.query_report.get_script\", {\n\t\t\t\t\t\treport_name: this.report_name,\n\t\t\t\t\t})\n\t\t\t\t\t.then((settings) => {\n\t\t\t\t\t\tfrappe.dom.eval(settings.script || \"\");\n\t\t\t\t\t\tfrappe.after_ajax(() => {\n\t\t\t\t\t\t\tthis.report_settings = this.get_local_report_settings();\n\t\t\t\t\t\t\tthis.report_settings.html_format = settings.html_format;\n\t\t\t\t\t\t\tthis.report_settings.execution_time = settings.execution_time || 0;\n\t\t\t\t\t\t\tfrappe.query_reports[this.report_name] = this.report_settings;\n\n\t\t\t\t\t\t\tif (this.report_doc.filters && !this.report_settings.filters) {\n\t\t\t\t\t\t\t\t// add configured filters\n\t\t\t\t\t\t\t\tthis.report_settings.filters = this.report_doc.filters;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t});\n\t\t\t\t\t})\n\t\t\t\t\t.catch(reject);\n\t\t\t}\n\t\t});\n\t}\n\n\tget_local_report_settings() {\n\t\tlet report_script_name =\n\t\t\tthis.report_doc.report_type === \"Custom Report\"\n\t\t\t\t? this.report_doc.reference_report\n\t\t\t\t: this.report_name;\n\t\treturn frappe.query_reports[report_script_name] || {};\n\t}\n\n\tsetup_progress_bar() {\n\t\tlet seconds_elapsed = 0;\n\t\tconst execution_time = this.report_settings.execution_time || 0;\n\n\t\tif (execution_time < 5) return;\n\n\t\tthis.interval = setInterval(function () {\n\t\t\tseconds_elapsed += 1;\n\t\t\tfrappe.show_progress(__(\"Preparing Report\"), seconds_elapsed, execution_time);\n\t\t}, 1000);\n\t}\n\n\trefresh_filters_dependency() {\n\t\tthis.filters.forEach((filter) => {\n\t\t\tfilter.guardian_has_value = true;\n\n\t\t\tif (filter.df.depends_on) {\n\t\t\t\tfilter.guardian_has_value = this.evaluate_depends_on_value(\n\t\t\t\t\tfilter.df.depends_on,\n\t\t\t\t\tfilter.df.label\n\t\t\t\t);\n\n\t\t\t\tif (filter.guardian_has_value) {\n\t\t\t\t\tif (filter.df.hidden_due_to_dependency) {\n\t\t\t\t\t\tfilter.df.hidden_due_to_dependency = false;\n\t\t\t\t\t\tthis.toggle_filter_display(filter.df.fieldname, false);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (!filter.df.hidden_due_to_dependency) {\n\t\t\t\t\t\tfilter.df.hidden_due_to_dependency = true;\n\t\t\t\t\t\tthis.toggle_filter_display(filter.df.fieldname, true);\n\t\t\t\t\t\tfilter.set_value(filter.df.default || null);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tevaluate_depends_on_value(expression, filter_label) {\n\t\tlet out = null;\n\t\tlet doc = this.get_filter_values();\n\t\tif (doc) {\n\t\t\tif (typeof expression === \"boolean\") {\n\t\t\t\tout = expression;\n\t\t\t} else if (expression.substr(0, 5) == \"eval:\") {\n\t\t\t\ttry {\n\t\t\t\t\tout = frappe.utils.eval(expression.substr(5), { doc });\n\t\t\t\t} catch (e) {\n\t\t\t\t\tfrappe.throw(\n\t\t\t\t\t\t__('Invalid \"depends_on\" expression set in filter {0}', [filter_label])\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tvar value = doc[expression];\n\t\t\t\tif ($.isArray(value)) {\n\t\t\t\t\tout = !!value.length;\n\t\t\t\t} else {\n\t\t\t\t\tout = !!value;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn out;\n\t}\n\n\tsetup_filters() {\n\t\tthis.clear_filters();\n\t\tconst { filters = [] } = this.report_settings;\n\n\t\tlet filter_area = this.page.page_form;\n\n\t\tthis.filters = filters\n\t\t\t.map((df) => {\n\t\t\t\tif (df.fieldtype === \"Break\") return;\n\n\t\t\t\tlet f = this.page.add_field(df, filter_area);\n\n\t\t\t\tif (df.default) {\n\t\t\t\t\tf.set_input(df.default);\n\t\t\t\t}\n\n\t\t\t\tif (df.get_query) f.get_query = df.get_query;\n\t\t\t\tif (df.on_change) f.on_change = df.on_change;\n\n\t\t\t\tdf.onchange = () => {\n\t\t\t\t\tthis.refresh_filters_dependency();\n\n\t\t\t\t\tlet current_filters = this.get_filter_values();\n\t\t\t\t\tif (\n\t\t\t\t\t\tthis.previous_filters &&\n\t\t\t\t\t\tJSON.stringify(this.previous_filters) === JSON.stringify(current_filters)\n\t\t\t\t\t) {\n\t\t\t\t\t\t// filter values have not changed\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\t// clear previous_filters after 10 seconds, to allow refresh for new data\n\t\t\t\t\tthis.previous_filters = current_filters;\n\t\t\t\t\tsetTimeout(() => (this.previous_filters = null), 10000);\n\n\t\t\t\t\tif (f.on_change) {\n\t\t\t\t\t\tf.on_change(this);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (this.prepared_report) {\n\t\t\t\t\t\t\tthis.reset_report_view();\n\t\t\t\t\t\t} else if (!this._no_refresh) {\n\t\t\t\t\t\t\tthis.refresh();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tf = Object.assign(f, df);\n\n\t\t\t\treturn f;\n\t\t\t})\n\t\t\t.filter(Boolean);\n\n\t\tthis.refresh_filters_dependency();\n\t\tif (this.filters.length === 0) {\n\t\t\t// hide page form if no filters\n\t\t\tthis.page.hide_form();\n\t\t} else {\n\t\t\tthis.page.show_form();\n\t\t}\n\t}\n\n\tset_filters(filters) {\n\t\tthis.filters.map((f) => {\n\t\t\tf.set_input(filters[f.fieldname]);\n\t\t});\n\t}\n\n\tset_route_filters(route_options) {\n\t\tif (!route_options) route_options = frappe.route_options;\n\n\t\tif (route_options) {\n\t\t\tconst fields = Object.keys(route_options);\n\n\t\t\tconst filters_to_set = this.filters.filter((f) => fields.includes(f.df.fieldname));\n\n\t\t\tconst promises = filters_to_set.map((f) => {\n\t\t\t\treturn () => {\n\t\t\t\t\tlet value = route_options[f.df.fieldname];\n\t\t\t\t\tif (typeof value === \"string\" && value[0] === \"[\") {\n\t\t\t\t\t\t// multiselect array\n\t\t\t\t\t\tvalue = JSON.parse(value);\n\t\t\t\t\t}\n\t\t\t\t\tf.set_value(value);\n\t\t\t\t};\n\t\t\t});\n\t\t\tpromises.push(() => {\n\t\t\t\tfrappe.route_options = null;\n\t\t\t});\n\n\t\t\treturn frappe.run_serially(promises);\n\t\t}\n\t}\n\n\tclear_filters() {\n\t\tthis.page.clear_fields();\n\t}\n\n\trefresh() {\n\t\tthis.toggle_message(true);\n\t\tthis.toggle_report(false);\n\t\tlet filters = this.get_filter_values(true);\n\t\tthis.show_loading_screen();\n\n\t\t// only one refresh at a time\n\t\tif (this.last_ajax) {\n\t\t\tthis.last_ajax.abort();\n\t\t}\n\n\t\tconst query_params = this.get_query_params();\n\n\t\tif (query_params.prepared_report_name) {\n\t\t\tfilters.prepared_report_name = query_params.prepared_report_name;\n\t\t}\n\n\t\treturn new Promise((resolve) => {\n\t\t\tthis.last_ajax = frappe.call({\n\t\t\t\tmethod: \"frappe.desk.query_report.run\",\n\t\t\t\ttype: \"GET\",\n\t\t\t\targs: {\n\t\t\t\t\treport_name: this.report_name,\n\t\t\t\t\tfilters: filters,\n\t\t\t\t\tis_tree: this.report_settings.tree,\n\t\t\t\t\tparent_field: this.report_settings.parent_field,\n\t\t\t\t},\n\t\t\t\tcallback: resolve,\n\t\t\t\talways: () => this.page.btn_secondary.prop(\"disabled\", false),\n\t\t\t});\n\t\t})\n\t\t\t.then((r) => {\n\t\t\t\tlet data = r.message;\n\t\t\t\tthis.hide_status();\n\t\t\t\tclearInterval(this.interval);\n\n\t\t\t\tthis.execution_time = data.execution_time || 0.1;\n\n\t\t\t\tif (data.prepared_report) {\n\t\t\t\t\tthis.prepared_report = true;\n\t\t\t\t\tthis.prepared_report_document = data.doc;\n\t\t\t\t\t// If query_string contains prepared_report_name then set filters\n\t\t\t\t\t// to match the mentioned prepared report doc and disable editing\n\t\t\t\t\tif (query_params.prepared_report_name) {\n\t\t\t\t\t\tthis.prepared_report_action = \"Edit\";\n\t\t\t\t\t\tconst filters_from_report = JSON.parse(data.doc.filters);\n\t\t\t\t\t\tObject.values(this.filters).forEach(function (field) {\n\t\t\t\t\t\t\tif (filters_from_report[field.fieldname]) {\n\t\t\t\t\t\t\t\tfield.set_input(filters_from_report[field.fieldname]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (field.input) {\n\t\t\t\t\t\t\t\tfield.input.disabled = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tthis.add_prepared_report_buttons(data.doc);\n\t\t\t\t}\n\n\t\t\t\tif (data.report_summary) {\n\t\t\t\t\tthis.$summary.empty();\n\t\t\t\t\tthis.render_summary(data.report_summary);\n\t\t\t\t}\n\n\t\t\t\tif (data.message && !data.prepared_report) this.show_status(data.message);\n\n\t\t\t\tthis.toggle_message(false);\n\t\t\t\tif (data.result && data.result.length) {\n\t\t\t\t\tthis.prepare_report_data(data);\n\t\t\t\t\tthis.chart_options = this.get_chart_options(data);\n\n\t\t\t\t\tthis.$chart.empty();\n\t\t\t\t\tif (this.chart_options) {\n\t\t\t\t\t\tthis.render_chart(this.chart_options);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.$chart.empty();\n\t\t\t\t\t\tif (this.chart_fields) {\n\t\t\t\t\t\t\tthis.chart_options = frappe.report_utils.make_chart_options(\n\t\t\t\t\t\t\t\tthis.columns,\n\t\t\t\t\t\t\t\tthis.raw_data,\n\t\t\t\t\t\t\t\tthis.chart_fields\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tthis.chart_options && this.render_chart(this.chart_options);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tthis.render_datatable();\n\t\t\t\t\tthis.add_chart_buttons_to_toolbar(true);\n\t\t\t\t\tthis.add_card_button_to_toolbar();\n\t\t\t\t\tthis.$report.show();\n\t\t\t\t} else {\n\t\t\t\t\tthis.data = [];\n\t\t\t\t\tthis.toggle_nothing_to_show(true);\n\t\t\t\t\tthis.add_chart_buttons_to_toolbar(false);\n\t\t\t\t}\n\n\t\t\t\tthis.show_footer_message();\n\t\t\t\tfrappe.hide_progress();\n\t\t\t})\n\t\t\t.finally(() => {\n\t\t\t\tthis.hide_loading_screen();\n\t\t\t\tthis.update_url_with_filters();\n\t\t\t});\n\t}\n\n\trender_summary(data) {\n\t\tdata.forEach((summary) => {\n\t\t\tfrappe.utils.build_summary_item(summary).appendTo(this.$summary);\n\t\t});\n\n\t\tthis.$summary.show();\n\t}\n\n\tget_query_params() {\n\t\tconst query_string = frappe.utils.get_query_string(frappe.get_route_str());\n\t\tconst query_params = frappe.utils.get_query_params(query_string);\n\t\treturn query_params;\n\t}\n\n\tadd_prepared_report_buttons(doc) {\n\t\tif (doc) {\n\t\t\tthis.page.add_inner_button(__(\"Download Report\"), function () {\n\t\t\t\twindow.open(\n\t\t\t\t\tfrappe.urllib.get_full_url(\n\t\t\t\t\t\t\"/api/method/frappe.core.doctype.prepared_report.prepared_report.download_attachment?\" +\n\t\t\t\t\t\t\t\"dn=\" +\n\t\t\t\t\t\t\tencodeURIComponent(doc.name)\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t});\n\n\t\t\tconst part1 = __(\"This report was generated {0}.\", [\n\t\t\t\tfrappe.datetime.comment_when(doc.report_end_time),\n\t\t\t]);\n\t\t\tconst part2 = __(\"To get the updated report, click on {0}.\", [__(\"Rebuild\")]);\n\t\t\tconst part3 = __(\"See all past reports.\");\n\n\t\t\tthis.show_status(`\n\t\t\t\t<div class=\"indicator orange\">\n\t\t\t\t\t<span>\n\t\t\t\t\t\t${part1}\n\t\t\t\t\t\t${part2}\n\t\t\t\t\t\t<a href=\"/app/List/Prepared%20Report?report_name=${this.report_name}\"> ${part3}</a>\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t`);\n\t\t}\n\n\t\t// Three cases\n\t\t// 1. First time with given filters, no data.\n\t\t// 2. Showing data from specific report\n\t\t// 3. Showing data from an old report without specific report name\n\t\tthis.primary_action_map = {\n\t\t\tNew: {\n\t\t\t\tlabel: __(\"Generate New Report\"),\n\t\t\t\tclick: () => {\n\t\t\t\t\tthis.show_warning_or_generate_report();\n\t\t\t\t},\n\t\t\t},\n\t\t\tEdit: {\n\t\t\t\tlabel: __(\"Edit\"),\n\t\t\t\tclick: () => {\n\t\t\t\t\tfrappe.set_route(frappe.get_route());\n\t\t\t\t},\n\t\t\t},\n\t\t\tRebuild: {\n\t\t\t\tlabel: __(\"Rebuild\"),\n\t\t\t\tclick: () => {\n\t\t\t\t\tthis.show_warning_or_generate_report();\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\n\t\tlet primary_action = this.primary_action_map[this.prepared_report_action];\n\n\t\tif (!this.primary_button || this.primary_button.text() !== primary_action.label) {\n\t\t\tthis.primary_button = this.page.set_primary_action(\n\t\t\t\tprimary_action.label,\n\t\t\t\tprimary_action.click\n\t\t\t);\n\t\t}\n\t}\n\n\ttoggle_primary_button_disabled(disable) {\n\t\tthis.primary_button.prop(\"disabled\", disable);\n\t}\n\n\tshow_warning_or_generate_report() {\n\t\tfrappe\n\t\t\t.xcall(\n\t\t\t\t\"frappe.core.doctype.prepared_report.prepared_report.get_reports_in_queued_state\",\n\t\t\t\t{\n\t\t\t\t\tfilters: this.get_filter_values(),\n\t\t\t\t\treport_name: this.report_name,\n\t\t\t\t}\n\t\t\t)\n\t\t\t.then((reports) => {\n\t\t\t\tthis.queued_prepared_reports = reports;\n\n\t\t\t\tif (reports.length) {\n\t\t\t\t\tconst message = this.get_queued_prepared_reports_warning_message(reports);\n\t\t\t\t\tthis.prepared_report_dialog = frappe.warn(\n\t\t\t\t\t\t__(\"Reports already in Queue\"),\n\t\t\t\t\t\tmessage,\n\t\t\t\t\t\t() => this.generate_background_report(),\n\t\t\t\t\t\t__(\"Proceed Anyway\"),\n\t\t\t\t\t\ttrue\n\t\t\t\t\t);\n\n\t\t\t\t\tthis.prepared_report_dialog.footer.prepend(`\n\t\t\t\t\t<button type=\"button\" class=\"btn btn-sm btn-default pull-left\" data-action=\"delete_old_queued_reports\">\n\t\t\t\t\t\t${__(\"Delete and Generate New\")}\n\t\t\t\t\t</button>`);\n\n\t\t\t\t\tfrappe.utils.bind_actions_with_object(\n\t\t\t\t\t\tthis.prepared_report_dialog.wrapper,\n\t\t\t\t\t\tthis\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\tthis.generate_background_report();\n\t\t\t\t}\n\t\t\t});\n\t}\n\n\tget_queued_prepared_reports_warning_message(reports) {\n\t\tconst route = `/app/List/Prepared Report/List?status=Queued&report_name=${this.report_name}`;\n\t\tconst report_link_html =\n\t\t\treports.length == 1\n\t\t\t\t? `<a class=\"underline\" href=\"${route}\">${__(\"1 Report\")}</a>`\n\t\t\t\t: `<a class=\"underline\" href=\"${route}\">${__(\"{0} Reports\", [\n\t\t\t\t\t\treports.length,\n\t\t\t\t  ])}</a>`;\n\n\t\tconst no_of_reports_html =\n\t\t\treports.length == 1\n\t\t\t\t? `${__(\"There is {0} with the same filters already in the queue:\", [\n\t\t\t\t\t\treport_link_html,\n\t\t\t\t  ])}`\n\t\t\t\t: `${__(\"There are {0} with the same filters already in the queue:\", [\n\t\t\t\t\t\treport_link_html,\n\t\t\t\t  ])}`;\n\n\t\tlet warning_message = `\n\t\t\t<p>\n\t\t\t\t${__(\"Are you sure you want to generate a new report?\")}\n\t\t\t\t${no_of_reports_html}\n\t\t\t</p>`;\n\n\t\tlet get_item_html = (item) =>\n\t\t\t`<a class=\"underline\" href=\"/app/prepared-report/${item.name}\">${item.name}</a>`;\n\n\t\twarning_message += reports.map(get_item_html).join(\", \");\n\n\t\treturn warning_message;\n\t}\n\n\tdelete_old_queued_reports() {\n\t\tthis.prepared_report_dialog.hide();\n\t\tfrappe\n\t\t\t.xcall(\"frappe.core.doctype.prepared_report.prepared_report.delete_prepared_reports\", {\n\t\t\t\treports: this.queued_prepared_reports,\n\t\t\t})\n\t\t\t.then(() => this.generate_background_report());\n\t}\n\n\tgenerate_background_report() {\n\t\tthis.toggle_primary_button_disabled(true);\n\t\tlet mandatory = this.filters.filter((f) => f.df.reqd);\n\t\tlet missing_mandatory = mandatory.filter((f) => !f.get_value());\n\t\tif (!missing_mandatory.length) {\n\t\t\tlet filters = this.get_filter_values(true);\n\t\t\treturn new Promise((resolve) =>\n\t\t\t\tfrappe.call({\n\t\t\t\t\tmethod: \"frappe.desk.query_report.background_enqueue_run\",\n\t\t\t\t\ttype: \"GET\",\n\t\t\t\t\targs: {\n\t\t\t\t\t\treport_name: this.report_name,\n\t\t\t\t\t\tfilters: filters,\n\t\t\t\t\t},\n\t\t\t\t\tcallback: resolve,\n\t\t\t\t})\n\t\t\t).then((r) => {\n\t\t\t\tconst data = r.message;\n\t\t\t\t// Rememeber the name of Prepared Report doc\n\t\t\t\tthis.prepared_report_doc_name = data.name;\n\t\t\t\tlet alert_message =\n\t\t\t\t\t`<a href='/app/prepared-report/${data.name}'>` +\n\t\t\t\t\t__(\"Report initiated, click to view status\") +\n\t\t\t\t\t`</a>`;\n\t\t\t\tfrappe.show_alert({ message: alert_message, indicator: \"orange\" }, 10);\n\t\t\t\tthis.toggle_nothing_to_show(true);\n\t\t\t});\n\t\t}\n\t}\n\n\tprepare_report_data(data) {\n\t\tthis.raw_data = data;\n\t\tthis.columns = this.prepare_columns(data.columns);\n\t\tthis.custom_columns = [];\n\t\tthis.data = this.prepare_data(data.result);\n\t\tthis.linked_doctypes = this.get_linked_doctypes();\n\t\tthis.tree_report = this.data.some((d) => \"indent\" in d);\n\t}\n\n\trender_datatable() {\n\t\tlet data = this.data;\n\t\tlet columns = this.columns.filter((col) => !col.hidden);\n\n\t\tif (this.raw_data.add_total_row && !this.report_settings.tree) {\n\t\t\tdata = data.slice();\n\t\t\tdata.splice(-1, 1);\n\t\t}\n\n\t\tthis.$report.show();\n\t\tif (\n\t\t\tthis.datatable &&\n\t\t\tthis.datatable.options &&\n\t\t\tthis.datatable.options.showTotalRow === this.raw_data.add_total_row\n\t\t) {\n\t\t\tthis.datatable.options.treeView = this.tree_report;\n\t\t\tthis.datatable.refresh(data, columns);\n\t\t} else {\n\t\t\tlet datatable_options = {\n\t\t\t\tcolumns: columns,\n\t\t\t\tdata: data,\n\t\t\t\tinlineFilters: true,\n\t\t\t\tlanguage: frappe.boot.lang,\n\t\t\t\ttranslations: frappe.utils.datatable.get_translations(),\n\t\t\t\ttreeView: this.tree_report,\n\t\t\t\tlayout: \"fixed\",\n\t\t\t\tcellHeight: 33,\n\t\t\t\tshowTotalRow: this.raw_data.add_total_row && !this.report_settings.tree,\n\t\t\t\tdirection: frappe.utils.is_rtl() ? \"rtl\" : \"ltr\",\n\t\t\t\thooks: {\n\t\t\t\t\tcolumnTotal: frappe.utils.report_column_total,\n\t\t\t\t},\n\t\t\t};\n\n\t\t\tif (this.report_settings.get_datatable_options) {\n\t\t\t\tdatatable_options = this.report_settings.get_datatable_options(datatable_options);\n\t\t\t}\n\t\t\tthis.datatable = new DataTable(this.$report[0], datatable_options);\n\t\t}\n\n\t\tif (typeof this.report_settings.initial_depth == \"number\") {\n\t\t\tthis.datatable.rowmanager.setTreeDepth(this.report_settings.initial_depth);\n\t\t}\n\t\tif (this.report_settings.after_datatable_render) {\n\t\t\tthis.report_settings.after_datatable_render(this.datatable);\n\t\t}\n\t}\n\n\tshow_loading_screen() {\n\t\tconst loading_state = `<div class=\"msg-box no-border\">\n\t\t\t<div>\n\t\t\t\t<img src=\"/assets/frappe/images/ui-states/list-empty-state.svg\" alt=\"Generic Empty State\" class=\"null-state\">\n\t\t\t</div>\n\t\t\t<p>${__(\"Loading\")}...</p>\n\t\t</div>`;\n\n\t\tthis.$loading.find(\"div\").html(loading_state);\n\t\tthis.$report.hide();\n\t\tthis.$loading.show();\n\t}\n\n\thide_loading_screen() {\n\t\tthis.$loading.hide();\n\t}\n\n\tget_chart_options(data) {\n\t\tlet options = this.report_settings.get_chart_data\n\t\t\t? this.report_settings.get_chart_data(data.columns, data.result)\n\t\t\t: data.chart\n\t\t\t? data.chart\n\t\t\t: undefined;\n\n\t\tif (!(options && options.data && options.data.labels && options.data.labels.length > 0))\n\t\t\treturn;\n\n\t\tif (options.fieldtype) {\n\t\t\toptions.tooltipOptions = {\n\t\t\t\tformatTooltipY: (d) =>\n\t\t\t\t\tfrappe.format(d, {\n\t\t\t\t\t\tfieldtype: options.fieldtype,\n\t\t\t\t\t\toptions: options.options,\n\t\t\t\t\t}),\n\t\t\t};\n\t\t}\n\t\toptions.axisOptions = {\n\t\t\tshortenYAxisNumbers: 1,\n\t\t\tnumberFormatter: frappe.utils.format_chart_axis_number,\n\t\t};\n\t\toptions.height = 280;\n\t\treturn options;\n\t}\n\n\trender_chart(options) {\n\t\tthis.$chart.empty();\n\t\tthis.$chart.show();\n\t\tthis.chart = new frappe.Chart(this.$chart[0], options);\n\t}\n\n\topen_create_chart_dialog() {\n\t\tconst me = this;\n\t\tlet field_options = frappe.report_utils.get_field_options_from_report(\n\t\t\tthis.columns,\n\t\t\tthis.raw_data\n\t\t);\n\n\t\tfunction set_chart_values(values) {\n\t\t\tvalues.y_fields = [];\n\t\t\tvalues.colors = [];\n\t\t\tif (values.y_axis_fields) {\n\t\t\t\tvalues.y_axis_fields.map((f) => {\n\t\t\t\t\tvalues.y_fields.push(f.y_field);\n\t\t\t\t\tvalues.colors.push(f.color);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tvalues.y_fields = values.y_fields.map((d) => d.trim()).filter(Boolean);\n\n\t\t\treturn values;\n\t\t}\n\n\t\tfunction preview_chart() {\n\t\t\tconst wrapper = $(dialog.fields_dict[\"chart_preview\"].wrapper);\n\t\t\tlet values = dialog.get_values(true);\n\t\t\tvalues = set_chart_values(values);\n\n\t\t\tif (values.x_field && values.y_fields.length) {\n\t\t\t\tlet options = frappe.report_utils.make_chart_options(\n\t\t\t\t\tme.columns,\n\t\t\t\t\tme.raw_data,\n\t\t\t\t\tvalues\n\t\t\t\t);\n\t\t\t\tme.chart_fields = values;\n\t\t\t\twrapper.empty();\n\t\t\t\tnew frappe.Chart(wrapper[0], options);\n\t\t\t\twrapper.find(\".chart-container .title, .chart-container .sub-title\").hide();\n\t\t\t\twrapper.show();\n\n\t\t\t\tdialog.fields_dict[\"create_dashoard_chart\"].df.hidden = 0;\n\t\t\t\tdialog.refresh();\n\t\t\t} else {\n\t\t\t\twrapper[0].innerHTML = `<div class=\"flex justify-center align-center text-muted\" style=\"height: 120px; display: flex;\">\n\t\t\t\t\t<div>${__(\"Please select X and Y fields\")}</div>\n\t\t\t\t</div>`;\n\t\t\t}\n\t\t}\n\n\t\tconst dialog = new frappe.ui.Dialog({\n\t\t\ttitle: __(\"Create Chart\"),\n\t\t\tfields: [\n\t\t\t\t{\n\t\t\t\t\tfieldname: \"x_field\",\n\t\t\t\t\tlabel: \"X Field\",\n\t\t\t\t\tfieldtype: \"Select\",\n\t\t\t\t\tdefault: me.chart_fields ? me.chart_fields.x_field : null,\n\t\t\t\t\toptions: field_options.non_numeric_fields,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tfieldname: \"cb_1\",\n\t\t\t\t\tfieldtype: \"Column Break\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tfieldname: \"chart_type\",\n\t\t\t\t\tlabel: \"Type of Chart\",\n\t\t\t\t\tfieldtype: \"Select\",\n\t\t\t\t\toptions: [\"Bar\", \"Line\", \"Percentage\", \"Pie\", \"Donut\"],\n\t\t\t\t\tdefault: me.chart_fields ? me.chart_fields.chart_type : \"Bar\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tfieldname: \"sb_1\",\n\t\t\t\t\tfieldtype: \"Section Break\",\n\t\t\t\t\tlabel: \"Y Axis\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tfieldname: \"y_axis_fields\",\n\t\t\t\t\tfieldtype: \"Table\",\n\t\t\t\t\tfields: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tfieldtype: \"Select\",\n\t\t\t\t\t\t\tfieldname: \"y_field\",\n\t\t\t\t\t\t\tname: \"y_field\",\n\t\t\t\t\t\t\tlabel: __(\"Y Field\"),\n\t\t\t\t\t\t\toptions: field_options.numeric_fields,\n\t\t\t\t\t\t\tin_list_view: 1,\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tfieldtype: \"Color\",\n\t\t\t\t\t\t\tfieldname: \"color\",\n\t\t\t\t\t\t\tname: \"color\",\n\t\t\t\t\t\t\tlabel: __(\"Color\"),\n\t\t\t\t\t\t\tin_list_view: 1,\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tfieldname: \"preview_chart_button\",\n\t\t\t\t\tfieldtype: \"Button\",\n\t\t\t\t\tlabel: \"Preview Chart\",\n\t\t\t\t\tclick: preview_chart,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tfieldname: \"sb_2\",\n\t\t\t\t\tfieldtype: \"Section Break\",\n\t\t\t\t\tlabel: \"Chart Preview\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tfieldname: \"chart_preview\",\n\t\t\t\t\tlabel: \"Chart Preview\",\n\t\t\t\t\tfieldtype: \"HTML\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tfieldname: \"create_dashoard_chart\",\n\t\t\t\t\tlabel: \"Add Chart to Dashboard\",\n\t\t\t\t\tfieldtype: \"Button\",\n\t\t\t\t\thidden: 1,\n\t\t\t\t\tclick: () => {\n\t\t\t\t\t\tdialog.hide();\n\t\t\t\t\t\tthis.add_chart_to_dashboard();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t\tprimary_action_label: __(\"Create\"),\n\t\t\tprimary_action: (values) => {\n\t\t\t\tvalues = set_chart_values(values);\n\n\t\t\t\tlet options = frappe.report_utils.make_chart_options(\n\t\t\t\t\tthis.columns,\n\t\t\t\t\tthis.raw_data,\n\t\t\t\t\tvalues\n\t\t\t\t);\n\t\t\t\tme.chart_fields = values;\n\n\t\t\t\tlet x_field_label = field_options.numeric_fields.filter(\n\t\t\t\t\t(field) => field.value == values.y_fields[0]\n\t\t\t\t)[0].label;\n\t\t\t\tlet y_field_label = field_options.non_numeric_fields.filter(\n\t\t\t\t\t(field) => field.value == values.x_field\n\t\t\t\t)[0].label;\n\n\t\t\t\toptions.title = __(\"{0}: {1} vs {2}\", [\n\t\t\t\t\tthis.report_name,\n\t\t\t\t\tx_field_label,\n\t\t\t\t\ty_field_label,\n\t\t\t\t]);\n\n\t\t\t\tthis.render_chart(options);\n\t\t\t\tthis.add_chart_buttons_to_toolbar(true);\n\n\t\t\t\tdialog.hide();\n\t\t\t},\n\t\t});\n\n\t\tdialog.show();\n\n\t\t// load preview after dialog animation\n\t\tsetTimeout(preview_chart, 500);\n\t}\n\n\tprepare_columns(columns) {\n\t\treturn columns.map((column) => {\n\t\t\tcolumn = frappe.report_utils.prepare_field_from_column(column);\n\n\t\t\tconst format_cell = (value, row, column, data) => {\n\t\t\t\tif (column.isHeader && !data && this.data) {\n\t\t\t\t\t// totalRow doesn't have a data object\n\t\t\t\t\t// proxy it using the first data object\n\t\t\t\t\t// applied to Float, Currency fields, needed only for currency formatting.\n\t\t\t\t\t// make first data column have value 'Total'\n\t\t\t\t\tlet index = 1;\n\n\t\t\t\t\tif (this.report_settings.get_datatable_options) {\n\t\t\t\t\t\tlet datatable = this.report_settings.get_datatable_options({});\n\t\t\t\t\t\tif (datatable && datatable.checkboxColumn) index = 2;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (column.colIndex === index && !value) {\n\t\t\t\t\t\tvalue = \"Total\";\n\t\t\t\t\t\tcolumn = { fieldtype: \"Data\" }; // avoid type issues for value if Date column\n\t\t\t\t\t} else if (in_list([\"Currency\", \"Float\"], column.fieldtype)) {\n\t\t\t\t\t\t// proxy for currency and float\n\t\t\t\t\t\tdata = this.data[0];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn frappe.format(\n\t\t\t\t\tvalue,\n\t\t\t\t\tcolumn,\n\t\t\t\t\t{ for_print: false, always_show_decimals: true },\n\t\t\t\t\tdata\n\t\t\t\t);\n\t\t\t};\n\n\t\t\tlet compareFn = null;\n\t\t\tif (column.fieldtype === \"Date\") {\n\t\t\t\tcompareFn = (cell, keyword) => {\n\t\t\t\t\tif (!cell.content) return null;\n\t\t\t\t\tif (keyword.length !== \"YYYY-MM-DD\".length) return null;\n\n\t\t\t\t\tconst keywordValue = frappe.datetime.user_to_obj(keyword);\n\t\t\t\t\tconst cellValue = frappe.datetime.str_to_obj(cell.content);\n\t\t\t\t\treturn [+cellValue, +keywordValue];\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn Object.assign(column, {\n\t\t\t\tid: column.fieldname,\n\t\t\t\tname: __(column.label, null, `Column of report '${this.report_name}'`), // context has to match context in   get_messages_from_report in translate.py\n\t\t\t\twidth: parseInt(column.width) || null,\n\t\t\t\teditable: false,\n\t\t\t\tcompareValue: compareFn,\n\t\t\t\tformat: (value, row, column, data) => {\n\t\t\t\t\tif (this.report_settings.formatter) {\n\t\t\t\t\t\treturn this.report_settings.formatter(\n\t\t\t\t\t\t\tvalue,\n\t\t\t\t\t\t\trow,\n\t\t\t\t\t\t\tcolumn,\n\t\t\t\t\t\t\tdata,\n\t\t\t\t\t\t\tformat_cell\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\treturn format_cell(value, row, column, data);\n\t\t\t\t},\n\t\t\t});\n\t\t});\n\t}\n\n\tprepare_data(data) {\n\t\treturn data.map((row) => {\n\t\t\tlet row_obj = {};\n\t\t\tif (Array.isArray(row)) {\n\t\t\t\tthis.columns.forEach((column, i) => {\n\t\t\t\t\trow_obj[column.id] = row[i];\n\t\t\t\t});\n\n\t\t\t\treturn row_obj;\n\t\t\t}\n\t\t\treturn row;\n\t\t});\n\t}\n\n\tget_visible_columns() {\n\t\tconst visible_column_ids = this.datatable.datamanager\n\t\t\t.getColumns(true)\n\t\t\t.map((col) => col.id);\n\n\t\treturn visible_column_ids\n\t\t\t.map((id) => this.columns.find((col) => col.id === id))\n\t\t\t.filter(Boolean);\n\t}\n\n\tget_filter_values(raise) {\n\t\t// check for mandatory property for filters added via UI\n\t\tconst mandatory = this.filters.filter((f) => f.df.reqd || f.df.mandatory);\n\t\tlet missing_mandatory = mandatory.filter((f) => !f.get_value());\n\t\tmissing_mandatory = mandatory.filter((f) => f.get_value().length == 0);\n\t\tif (raise && missing_mandatory.length > 0) {\n\t\t\tlet message = __(\"Please set filters\");\n\t\t\tthis.hide_loading_screen();\n\t\t\tthis.toggle_message(raise, message);\n\t\t\tthrow \"Filter missing\";\n\t\t}\n\n\t\traise && this.toggle_message(false);\n\n\t\tconst filters = this.filters\n\t\t\t.filter((f) => f.get_value())\n\t\t\t.map((f) => {\n\t\t\t\tvar v = f.get_value();\n\t\t\t\t// hidden fields dont have $input\n\t\t\t\tif (f.df.hidden) v = f.value;\n\t\t\t\tif (v === \"%\") v = null;\n\t\t\t\tif (f.df.wildcard_filter) {\n\t\t\t\t\tv = `%${v}%`;\n\t\t\t\t}\n\t\t\t\treturn {\n\t\t\t\t\t[f.df.fieldname]: v,\n\t\t\t\t};\n\t\t\t})\n\t\t\t.reduce((acc, f) => {\n\t\t\t\tObject.assign(acc, f);\n\t\t\t\treturn acc;\n\t\t\t}, {});\n\t\treturn filters;\n\t}\n\n\tget_filter(fieldname) {\n\t\tconst field = (this.filters || []).find((f) => f.df.fieldname === fieldname);\n\t\tif (!field) {\n\t\t\tconsole.warn(`[Query Report] Invalid filter: ${fieldname}`);\n\t\t}\n\t\treturn field;\n\t}\n\n\tget_filter_value(fieldname) {\n\t\tconst field = this.get_filter(fieldname);\n\t\treturn field ? field.get_value() : null;\n\t}\n\n\tset_filter_value(fieldname, value) {\n\t\tlet field_value_map = {};\n\t\tif (typeof fieldname === \"string\") {\n\t\t\tfield_value_map[fieldname] = value;\n\t\t} else {\n\t\t\tfield_value_map = fieldname;\n\t\t}\n\n\t\tthis._no_refresh = true;\n\t\tObject.keys(field_value_map).forEach((fieldname, i, arr) => {\n\t\t\tconst value = field_value_map[fieldname];\n\n\t\t\tif (i === arr.length - 1) {\n\t\t\t\tthis._no_refresh = false;\n\t\t\t}\n\n\t\t\tthis.get_filter(fieldname).set_value(value);\n\t\t});\n\t}\n\n\tset_breadcrumbs() {\n\t\tif (!this.report_doc || !this.report_doc.ref_doctype) return;\n\t\tconst ref_doctype = frappe.get_meta(this.report_doc.ref_doctype);\n\t\tfrappe.breadcrumbs.add(ref_doctype.module);\n\t}\n\n\tmake_access_log(method, file_format) {\n\t\tfrappe.call(\"frappe.core.doctype.access_log.access_log.make_access_log\", {\n\t\t\tdoctype: this.doctype || \"\",\n\t\t\treport_name: this.report_name,\n\t\t\tfilters: this.get_filter_values(),\n\t\t\tfile_type: file_format,\n\t\t\tmethod: method,\n\t\t});\n\t}\n\n\tprint_report(print_settings) {\n\t\tconst custom_format = this.report_settings.html_format || null;\n\t\tconst filters_html = this.get_filters_html_for_print();\n\t\tconst landscape = print_settings.orientation == \"Landscape\";\n\n\t\tthis.make_access_log(\"Print\", \"PDF\");\n\t\tfrappe.render_grid({\n\t\t\ttemplate: print_settings.columns ? \"print_grid\" : custom_format,\n\t\t\ttitle: __(this.report_name),\n\t\t\tsubtitle: filters_html,\n\t\t\tprint_settings: print_settings,\n\t\t\tlandscape: landscape,\n\t\t\tfilters: this.get_filter_values(),\n\t\t\tdata: this.get_data_for_print(),\n\t\t\tcolumns: this.get_columns_for_print(print_settings, custom_format),\n\t\t\toriginal_data: this.data,\n\t\t\treport: this,\n\t\t});\n\t}\n\n\tpdf_report(print_settings) {\n\t\tconst base_url = frappe.urllib.get_base_url();\n\t\tconst print_css = frappe.boot.print_css;\n\t\tconst landscape = print_settings.orientation == \"Landscape\";\n\n\t\tconst custom_format = this.report_settings.html_format || null;\n\t\tconst columns = this.get_columns_for_print(print_settings, custom_format);\n\t\tconst data = this.get_data_for_print();\n\t\tconst applied_filters = this.get_filter_values();\n\n\t\tconst filters_html = this.get_filters_html_for_print();\n\t\tconst template = print_settings.columns || !custom_format ? \"print_grid\" : custom_format;\n\t\tconst content = frappe.render_template(template, {\n\t\t\ttitle: __(this.report_name),\n\t\t\tsubtitle: filters_html,\n\t\t\tfilters: applied_filters,\n\t\t\tdata: data,\n\t\t\toriginal_data: this.data,\n\t\t\tcolumns: columns,\n\t\t\treport: this,\n\t\t});\n\n\t\t// Render Report in HTML\n\t\tconst html = frappe.render_template(\"print_template\", {\n\t\t\ttitle: __(this.report_name),\n\t\t\tcontent: content,\n\t\t\tbase_url: base_url,\n\t\t\tprint_css: print_css,\n\t\t\tprint_settings: print_settings,\n\t\t\tlandscape: landscape,\n\t\t\tcolumns: columns,\n\t\t\tlang: frappe.boot.lang,\n\t\t\tlayout_direction: frappe.utils.is_rtl() ? \"rtl\" : \"ltr\",\n\t\t});\n\n\t\tlet filter_values = [],\n\t\t\tname_len = 0;\n\t\tfor (var key of Object.keys(applied_filters)) {\n\t\t\tname_len = name_len + applied_filters[key].toString().length;\n\t\t\tif (name_len > 200) break;\n\t\t\tfilter_values.push(applied_filters[key]);\n\t\t}\n\t\tprint_settings.report_name = `${__(this.report_name)}_${filter_values.join(\"_\")}.pdf`;\n\t\tfrappe.render_pdf(html, print_settings);\n\t}\n\n\tget_filters_html_for_print() {\n\t\tconst applied_filters = this.get_filter_values();\n\t\treturn Object.keys(applied_filters)\n\t\t\t.map((fieldname) => {\n\t\t\t\tconst label = frappe.query_report.get_filter(fieldname).df.label;\n\t\t\t\tconst value = applied_filters[fieldname];\n\t\t\t\treturn `<h6>${__(label)}: ${value}</h6>`;\n\t\t\t})\n\t\t\t.join(\"\");\n\t}\n\n\texport_report() {\n\t\tif (this.export_dialog) {\n\t\t\tthis.export_dialog.clear();\n\t\t\tthis.export_dialog.show();\n\t\t\treturn;\n\t\t}\n\n\t\tlet export_dialog_fields = [\n\t\t\t{\n\t\t\t\tlabel: __(\"Select File Format\"),\n\t\t\t\tfieldname: \"file_format\",\n\t\t\t\tfieldtype: \"Select\",\n\t\t\t\toptions: [\"Excel\", \"CSV\"],\n\t\t\t\tdefault: \"Excel\",\n\t\t\t\treqd: 1,\n\t\t\t},\n\t\t];\n\n\t\tif (this.tree_report) {\n\t\t\texport_dialog_fields.push({\n\t\t\t\tlabel: __(\"Include indentation\"),\n\t\t\t\tfieldname: \"include_indentation\",\n\t\t\t\tfieldtype: \"Check\",\n\t\t\t});\n\t\t}\n\n\t\tthis.export_dialog = frappe.prompt(\n\t\t\texport_dialog_fields,\n\t\t\t({ file_format, include_indentation }) => {\n\t\t\t\tthis.make_access_log(\"Export\", file_format);\n\t\t\t\tif (file_format === \"CSV\") {\n\t\t\t\t\tconst column_row = this.columns.reduce((acc, col) => {\n\t\t\t\t\t\tif (!col.hidden) {\n\t\t\t\t\t\t\tacc.push(__(col.label));\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn acc;\n\t\t\t\t\t}, []);\n\t\t\t\t\tconst data = this.get_data_for_csv(include_indentation);\n\t\t\t\t\tconst out = [column_row].concat(data);\n\n\t\t\t\t\tfrappe.tools.downloadify(out, null, this.report_name);\n\t\t\t\t} else {\n\t\t\t\t\tlet filters = this.get_filter_values(true);\n\t\t\t\t\tif (frappe.urllib.get_dict(\"prepared_report_name\")) {\n\t\t\t\t\t\tfilters = Object.assign(\n\t\t\t\t\t\t\tfrappe.urllib.get_dict(\"prepared_report_name\"),\n\t\t\t\t\t\t\tfilters\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\n\t\t\t\t\tconst visible_idx = this.datatable.bodyRenderer.visibleRowIndices;\n\t\t\t\t\tif (visible_idx.length + 1 === this.data.length) {\n\t\t\t\t\t\tvisible_idx.push(visible_idx.length);\n\t\t\t\t\t}\n\n\t\t\t\t\tconst args = {\n\t\t\t\t\t\tcmd: \"frappe.desk.query_report.export_query\",\n\t\t\t\t\t\treport_name: this.report_name,\n\t\t\t\t\t\tcustom_columns: this.custom_columns.length ? this.custom_columns : [],\n\t\t\t\t\t\tfile_format_type: file_format,\n\t\t\t\t\t\tfilters: filters,\n\t\t\t\t\t\tvisible_idx,\n\t\t\t\t\t\tinclude_indentation,\n\t\t\t\t\t};\n\n\t\t\t\t\topen_url_post(frappe.request.url, args);\n\t\t\t\t}\n\t\t\t},\n\t\t\t__(\"Export Report: {0}\", [this.report_name]),\n\t\t\t__(\"Download\")\n\t\t);\n\t}\n\n\tget_data_for_csv(include_indentation) {\n\t\tconst rows = this.datatable.bodyRenderer.visibleRows;\n\t\tif (this.raw_data.add_total_row) {\n\t\t\trows.push(this.datatable.bodyRenderer.getTotalRow());\n\t\t}\n\t\treturn rows.map((row) => {\n\t\t\tconst standard_column_count = this.datatable.datamanager.getStandardColumnCount();\n\t\t\treturn row.slice(standard_column_count).map((cell, i) => {\n\t\t\t\tif (cell.column.fieldtype === \"Duration\") {\n\t\t\t\t\tcell.content = frappe.utils.get_formatted_duration(cell.content);\n\t\t\t\t}\n\t\t\t\tif (include_indentation && i === 0) {\n\t\t\t\t\tcell.content = \"   \".repeat(row.meta.indent) + (cell.content || \"\");\n\t\t\t\t}\n\t\t\t\treturn cell.content || \"\";\n\t\t\t});\n\t\t});\n\t}\n\n\tget_data_for_print() {\n\t\tif (!this.data.length) {\n\t\t\treturn [];\n\t\t}\n\n\t\tconst rows = this.datatable.datamanager.rowViewOrder\n\t\t\t.map((index) => {\n\t\t\t\tif (this.datatable.bodyRenderer.visibleRowIndices.includes(index)) {\n\t\t\t\t\treturn this.data[index];\n\t\t\t\t}\n\t\t\t})\n\t\t\t.filter(Boolean);\n\n\t\tif (this.raw_data.add_total_row) {\n\t\t\tlet totalRow = this.datatable.bodyRenderer.getTotalRow().reduce((row, cell) => {\n\t\t\t\trow[cell.column.id] = cell.content;\n\t\t\t\trow.is_total_row = true;\n\t\t\t\treturn row;\n\t\t\t}, {});\n\n\t\t\trows.push(totalRow);\n\t\t}\n\t\treturn rows;\n\t}\n\n\tget_columns_for_print(print_settings, custom_format) {\n\t\tlet columns = [];\n\n\t\tif (print_settings && print_settings.columns) {\n\t\t\tcolumns = this.get_visible_columns().filter((column) =>\n\t\t\t\tprint_settings.columns.includes(column.fieldname)\n\t\t\t);\n\t\t} else {\n\t\t\tcolumns = custom_format ? this.columns : this.get_visible_columns();\n\t\t}\n\n\t\treturn columns;\n\t}\n\n\tget_menu_items() {\n\t\tlet items = [\n\t\t\t{\n\t\t\t\tlabel: __(\"Refresh\"),\n\t\t\t\taction: () => this.refresh(),\n\t\t\t\tclass: \"visible-xs\",\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: __(\"Edit\"),\n\t\t\t\taction: () => frappe.set_route(\"Form\", \"Report\", this.report_name),\n\t\t\t\tcondition: () => frappe.user.is_report_manager(),\n\t\t\t\tstandard: true,\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: __(\"Print\"),\n\t\t\t\taction: () => {\n\t\t\t\t\tlet dialog = frappe.ui.get_print_settings(\n\t\t\t\t\t\tfalse,\n\t\t\t\t\t\t(print_settings) => this.print_report(print_settings),\n\t\t\t\t\t\tthis.report_doc.letter_head,\n\t\t\t\t\t\tthis.get_visible_columns()\n\t\t\t\t\t);\n\t\t\t\t\tthis.add_portrait_warning(dialog);\n\t\t\t\t},\n\t\t\t\tcondition: () => frappe.model.can_print(this.report_doc.ref_doctype),\n\t\t\t\tstandard: true,\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: __(\"PDF\"),\n\t\t\t\taction: () => {\n\t\t\t\t\tlet dialog = frappe.ui.get_print_settings(\n\t\t\t\t\t\tfalse,\n\t\t\t\t\t\t(print_settings) => this.pdf_report(print_settings),\n\t\t\t\t\t\tthis.report_doc.letter_head,\n\t\t\t\t\t\tthis.get_visible_columns()\n\t\t\t\t\t);\n\n\t\t\t\t\tthis.add_portrait_warning(dialog);\n\t\t\t\t},\n\t\t\t\tcondition: () => frappe.model.can_print(this.report_doc.ref_doctype),\n\t\t\t\tstandard: true,\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: __(\"Export\"),\n\t\t\t\taction: () => this.export_report(),\n\t\t\t\tcondition: () => frappe.model.can_export(this.report_doc.ref_doctype),\n\t\t\t\tstandard: true,\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: __(\"Setup Auto Email\"),\n\t\t\t\taction: () =>\n\t\t\t\t\tfrappe.set_route(\"List\", \"Auto Email Report\", { report: this.report_name }),\n\t\t\t\tstandard: true,\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: __(\"Add Column\"),\n\t\t\t\taction: () => {\n\t\t\t\t\tlet d = new frappe.ui.Dialog({\n\t\t\t\t\t\ttitle: __(\"Add Column\"),\n\t\t\t\t\t\tfields: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tfieldtype: \"Select\",\n\t\t\t\t\t\t\t\tfieldname: \"doctype\",\n\t\t\t\t\t\t\t\tlabel: __(\"From Document Type\"),\n\t\t\t\t\t\t\t\toptions: this.linked_doctypes.map((df) => ({\n\t\t\t\t\t\t\t\t\tlabel: df.doctype,\n\t\t\t\t\t\t\t\t\tvalue: df.doctype,\n\t\t\t\t\t\t\t\t})),\n\t\t\t\t\t\t\t\tchange: () => {\n\t\t\t\t\t\t\t\t\tlet doctype = d.get_value(\"doctype\");\n\t\t\t\t\t\t\t\t\tfrappe.model.with_doctype(doctype, () => {\n\t\t\t\t\t\t\t\t\t\tlet options = frappe.meta\n\t\t\t\t\t\t\t\t\t\t\t.get_docfields(doctype)\n\t\t\t\t\t\t\t\t\t\t\t.filter(frappe.model.is_value_type)\n\t\t\t\t\t\t\t\t\t\t\t.map((df) => ({\n\t\t\t\t\t\t\t\t\t\t\t\tlabel: df.label,\n\t\t\t\t\t\t\t\t\t\t\t\tvalue: df.fieldname,\n\t\t\t\t\t\t\t\t\t\t\t}));\n\n\t\t\t\t\t\t\t\t\t\td.set_df_property(\n\t\t\t\t\t\t\t\t\t\t\t\"field\",\n\t\t\t\t\t\t\t\t\t\t\t\"options\",\n\t\t\t\t\t\t\t\t\t\t\toptions.sort(function (a, b) {\n\t\t\t\t\t\t\t\t\t\t\t\tif (a.label < b.label) {\n\t\t\t\t\t\t\t\t\t\t\t\t\treturn -1;\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\tif (a.label > b.label) {\n\t\t\t\t\t\t\t\t\t\t\t\t\treturn 1;\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\treturn 0;\n\t\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tfieldtype: \"Select\",\n\t\t\t\t\t\t\t\tlabel: __(\"Field\"),\n\t\t\t\t\t\t\t\tfieldname: \"field\",\n\t\t\t\t\t\t\t\toptions: [],\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tfieldtype: \"Select\",\n\t\t\t\t\t\t\t\tlabel: __(\"Insert After\"),\n\t\t\t\t\t\t\t\tfieldname: \"insert_after\",\n\t\t\t\t\t\t\t\toptions: this.columns.map((df) => df.label),\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t],\n\t\t\t\t\t\tprimary_action: (values) => {\n\t\t\t\t\t\t\tconst custom_columns = [];\n\t\t\t\t\t\t\tlet df = frappe.meta.get_docfield(values.doctype, values.field);\n\t\t\t\t\t\t\tconst insert_after_index = this.columns.findIndex(\n\t\t\t\t\t\t\t\t(column) => column.label === values.insert_after\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tcustom_columns.push({\n\t\t\t\t\t\t\t\tfieldname: df.fieldname,\n\t\t\t\t\t\t\t\tfieldtype: df.fieldtype,\n\t\t\t\t\t\t\t\tlabel: df.label,\n\t\t\t\t\t\t\t\tinsert_after_index: insert_after_index,\n\t\t\t\t\t\t\t\tlink_field: this.doctype_field_map[values.doctype],\n\t\t\t\t\t\t\t\tdoctype: values.doctype,\n\t\t\t\t\t\t\t\toptions: df.options,\n\t\t\t\t\t\t\t\twidth: 100,\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\tthis.custom_columns = this.custom_columns.concat(custom_columns);\n\t\t\t\t\t\t\tfrappe.call({\n\t\t\t\t\t\t\t\tmethod: \"frappe.desk.query_report.get_data_for_custom_field\",\n\t\t\t\t\t\t\t\targs: {\n\t\t\t\t\t\t\t\t\tfield: values.field,\n\t\t\t\t\t\t\t\t\tdoctype: values.doctype,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tcallback: (r) => {\n\t\t\t\t\t\t\t\t\tconst custom_data = r.message;\n\t\t\t\t\t\t\t\t\tconst link_field = this.doctype_field_map[values.doctype];\n\n\t\t\t\t\t\t\t\t\tthis.add_custom_column(\n\t\t\t\t\t\t\t\t\t\tcustom_columns,\n\t\t\t\t\t\t\t\t\t\tcustom_data,\n\t\t\t\t\t\t\t\t\t\tlink_field,\n\t\t\t\t\t\t\t\t\t\tvalues.field,\n\t\t\t\t\t\t\t\t\t\tinsert_after_index\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\td.hide();\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tthis.set_menu_items();\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\n\t\t\t\t\td.show();\n\t\t\t\t},\n\t\t\t\tstandard: true,\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: __(\"User Permissions\"),\n\t\t\t\taction: () =>\n\t\t\t\t\tfrappe.set_route(\"List\", \"User Permission\", {\n\t\t\t\t\t\tdoctype: \"Report\",\n\t\t\t\t\t\tname: this.report_name,\n\t\t\t\t\t}),\n\t\t\t\tcondition: () => frappe.model.can_set_user_permissions(\"Report\"),\n\t\t\t\tstandard: true,\n\t\t\t},\n\t\t];\n\n\t\tif (frappe.user.is_report_manager()) {\n\t\t\titems.push({\n\t\t\t\tlabel: __(\"Save\"),\n\t\t\t\taction: () => {\n\t\t\t\t\tlet d = new frappe.ui.Dialog({\n\t\t\t\t\t\ttitle: __(\"Save Report\"),\n\t\t\t\t\t\tfields: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tfieldtype: \"Data\",\n\t\t\t\t\t\t\t\tfieldname: \"report_name\",\n\t\t\t\t\t\t\t\tlabel: __(\"Report Name\"),\n\t\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\t\tthis.report_doc.is_standard == \"No\" ? this.report_name : \"\",\n\t\t\t\t\t\t\t\treqd: true,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t],\n\t\t\t\t\t\tprimary_action: (values) => {\n\t\t\t\t\t\t\tfrappe.call({\n\t\t\t\t\t\t\t\tmethod: \"frappe.desk.query_report.save_report\",\n\t\t\t\t\t\t\t\targs: {\n\t\t\t\t\t\t\t\t\treference_report: this.report_name,\n\t\t\t\t\t\t\t\t\treport_name: values.report_name,\n\t\t\t\t\t\t\t\t\tcolumns: this.get_visible_columns(),\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tcallback: function (r) {\n\t\t\t\t\t\t\t\t\tthis.show_save = false;\n\t\t\t\t\t\t\t\t\td.hide();\n\t\t\t\t\t\t\t\t\tfrappe.set_route(\"query-report\", r.message);\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\t\t\t\t\td.show();\n\t\t\t\t},\n\t\t\t\tstandard: true,\n\t\t\t});\n\t\t}\n\n\t\treturn items;\n\t}\n\n\tadd_portrait_warning(dialog) {\n\t\tif (this.columns.length > 10) {\n\t\t\tdialog.set_df_property(\"orientation\", \"change\", () => {\n\t\t\t\tlet value = dialog.get_value(\"orientation\");\n\t\t\t\tlet description =\n\t\t\t\t\tvalue === \"Portrait\"\n\t\t\t\t\t\t? __(\"Report with more than 10 columns looks better in Landscape mode.\")\n\t\t\t\t\t\t: \"\";\n\t\t\t\tdialog.set_df_property(\"orientation\", \"description\", description);\n\t\t\t});\n\t\t}\n\t}\n\n\tadd_custom_column(custom_column, custom_data, link_field, column_field, insert_after_index) {\n\t\tconst column = this.prepare_columns(custom_column);\n\n\t\tthis.columns.splice(insert_after_index + 1, 0, column[0]);\n\n\t\tthis.data.forEach((row) => {\n\t\t\trow[column_field] = custom_data[row[link_field]];\n\t\t});\n\n\t\tthis.render_datatable();\n\t}\n\n\tget_linked_doctypes() {\n\t\tlet doctypes = [];\n\t\tlet dynamic_links = [];\n\t\tlet dynamic_doctypes = new Set();\n\t\tthis.doctype_field_map = {};\n\n\t\tthis.columns.forEach((df) => {\n\t\t\tif (df.fieldtype == \"Link\" && df.options && df.options != \"Currency\") {\n\t\t\t\tdoctypes.push({\n\t\t\t\t\tdoctype: df.options,\n\t\t\t\t\tfieldname: df.fieldname,\n\t\t\t\t});\n\t\t\t} else if (df.fieldtype == \"Dynamic Link\" && df.options) {\n\t\t\t\tdynamic_links.push({\n\t\t\t\t\tlink_name: df.options,\n\t\t\t\t\tfieldname: df.fieldname,\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\tthis.data.forEach((row) => {\n\t\t\tdynamic_links.forEach((field) => {\n\t\t\t\tif (row[field.link_name]) {\n\t\t\t\t\tdynamic_doctypes.add(row[field.link_name] + \":\" + field.fieldname);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\tdoctypes = doctypes.concat(\n\t\t\tArray.from(dynamic_doctypes).map((d) => {\n\t\t\t\tconst doc_field_pair = d.split(\":\");\n\t\t\t\treturn {\n\t\t\t\t\tdoctype: doc_field_pair[0],\n\t\t\t\t\tfieldname: doc_field_pair[1],\n\t\t\t\t};\n\t\t\t})\n\t\t);\n\n\t\tdoctypes.forEach((doc) => {\n\t\t\tthis.doctype_field_map[doc.doctype] = doc.fieldname;\n\t\t});\n\n\t\treturn doctypes;\n\t}\n\n\tsetup_report_wrapper() {\n\t\tif (this.$report) return;\n\n\t\t// Remove border from\n\t\t$(\".page-head-content\").removeClass(\"border-bottom\");\n\n\t\tlet page_form = this.page.main.find(\".page-form\");\n\t\tthis.$status = $(`<div class=\"form-message text-muted small\"></div>`)\n\t\t\t.hide()\n\t\t\t.insertAfter(page_form);\n\n\t\tthis.$summary = $(`<div class=\"report-summary\"></div>`).hide().appendTo(this.page.main);\n\n\t\tthis.$chart = $('<div class=\"chart-wrapper\">').hide().appendTo(this.page.main);\n\n\t\tthis.$loading = $(this.message_div(\"\")).hide().appendTo(this.page.main);\n\t\tthis.$report = $('<div class=\"report-wrapper\">').appendTo(this.page.main);\n\t\tthis.$message = $(this.message_div(\"\")).hide().appendTo(this.page.main);\n\t}\n\n\tshow_status(status_message) {\n\t\tthis.$status.html(status_message).show();\n\t}\n\n\thide_status() {\n\t\tthis.$status.hide();\n\t}\n\n\tshow_footer_message() {\n\t\tthis.$report_footer && this.$report_footer.remove();\n\t\tthis.$report_footer = $(`<div class=\"report-footer text-muted\"></div>`).appendTo(\n\t\t\tthis.page.main\n\t\t);\n\t\tif (this.tree_report) {\n\t\t\tthis.$tree_footer = $(`<div class=\"tree-footer col-md-6\">\n\t\t\t\t<button class=\"btn btn-xs btn-default\" data-action=\"expand_all_rows\">\n\t\t\t\t\t${__(\"Expand All\")}</button>\n\t\t\t\t<button class=\"btn btn-xs btn-default\" data-action=\"collapse_all_rows\">\n\t\t\t\t\t${__(\"Collapse All\")}</button>\n\t\t\t</div>`);\n\t\t\t$(this.$report_footer).append(this.$tree_footer);\n\t\t\tthis.$tree_footer.find(\"[data-action=collapse_all_rows]\").show();\n\t\t\tthis.$tree_footer.find(\"[data-action=expand_all_rows]\").hide();\n\t\t}\n\n\t\tconst message = __(\n\t\t\t\"For comparison, use >5, <10 or =324. For ranges, use 5:10 (for values between 5 & 10).\"\n\t\t);\n\t\tconst execution_time_msg = __(\"Execution Time: {0} sec\", [this.execution_time || 0.1]);\n\n\t\tthis.$report_footer.append(`<div class=\"col-md-12\">\n\t\t\t<span\">${message}</span><span class=\"pull-right\">${execution_time_msg}</span>\n\t\t</div>`);\n\t}\n\n\texpand_all_rows() {\n\t\tthis.$tree_footer.find(\"[data-action=expand_all_rows]\").hide();\n\t\tthis.datatable.rowmanager.expandAllNodes();\n\t\tthis.$tree_footer.find(\"[data-action=collapse_all_rows]\").show();\n\t}\n\n\tcollapse_all_rows() {\n\t\tthis.$tree_footer.find(\"[data-action=collapse_all_rows]\").hide();\n\t\tthis.datatable.rowmanager.collapseAllNodes();\n\t\tthis.$tree_footer.find(\"[data-action=expand_all_rows]\").show();\n\t}\n\n\tmessage_div(message) {\n\t\treturn `<div class='flex justify-center align-center text-muted' style='height: 50vh;'>\n\t\t\t<div>${message}</div>\n\t\t</div>`;\n\t}\n\n\treset_report_view() {\n\t\tthis.hide_status();\n\t\tthis.toggle_nothing_to_show(true);\n\t\tthis.refresh();\n\t}\n\n\ttoggle_nothing_to_show(flag) {\n\t\tlet message =\n\t\t\tthis.prepared_report && !this.prepared_report_document\n\t\t\t\t? __(\n\t\t\t\t\t\t\"This is a background report. Please set the appropriate filters and then generate a new one.\"\n\t\t\t\t  )\n\t\t\t\t: this.get_no_result_message();\n\n\t\tthis.toggle_message(flag, message);\n\n\t\tif (flag && this.prepared_report) {\n\t\t\tthis.prepared_report_action = \"New\";\n\t\t\tif (!this.primary_button.is(\":visible\")) {\n\t\t\t\tthis.add_prepared_report_buttons();\n\t\t\t}\n\t\t}\n\t}\n\n\ttoggle_message(flag, message) {\n\t\tif (flag) {\n\t\t\tthis.$message.find(\"div\").html(message);\n\t\t\tthis.$message.show();\n\t\t} else {\n\t\t\tthis.$message.hide();\n\t\t}\n\t}\n\n\ttoggle_filter_display(fieldname, flag) {\n\t\tthis.$page.find(`div[data-fieldname=${fieldname}]`).toggleClass(\"hide-control\", flag);\n\t}\n\n\ttoggle_report(flag) {\n\t\tthis.$report.toggle(flag);\n\t\tthis.$chart.toggle(flag);\n\t\tthis.$summary.toggle(flag);\n\t}\n\n\tget_checked_items(only_docnames) {\n\t\tconst indexes = this.datatable.rowmanager.getCheckedRows();\n\n\t\treturn indexes.reduce((items, i) => {\n\t\t\tif (i === undefined) return items;\n\n\t\t\tconst item = this.data[i];\n\t\t\titems.push(only_docnames ? item.name : item);\n\t\t\treturn items;\n\t\t}, []);\n\t}\n\n\t// backward compatibility\n\tget get_values() {\n\t\treturn this.get_filter_values;\n\t}\n};", "// Copyright (c) 2015, Frappe Technologies Pvt. Ltd. and Contributors\n// License: GNU General Public License v3. See license.txt\nfrappe.provide(\"erpnext\");\nfrappe.provide(\"erpnext.utils\");\n\n$.extend(erpnext, {\n\tget_currency: function(company) {\n\t\tif(!company && cur_frm)\n\t\t\tcompany = cur_frm.doc.company;\n\t\tif(company)\n\t\t\treturn frappe.get_doc(\":Company\", company).default_currency || frappe.boot.sysdefaults.currency;\n\t\telse\n\t\t\treturn frappe.boot.sysdefaults.currency;\n\t},\n\n\tget_presentation_currency_list: () => {\n\t\tconst docs = frappe.boot.docs;\n\t\tlet currency_list = docs.filter(d => d.doctype === \":Currency\").map(d => d.name);\n\t\tcurrency_list.unshift(\"\");\n\t\treturn currency_list;\n\t},\n\n\ttoggle_naming_series: function() {\n\t\tif(cur_frm.fields_dict.naming_series) {\n\t\t\tcur_frm.toggle_display(\"naming_series\", cur_frm.doc.__islocal?true:false);\n\t\t}\n\t},\n\n\thide_company: function() {\n\t\tif(cur_frm.fields_dict.company) {\n\t\t\tvar companies = Object.keys(locals[\":Company\"] || {});\n\t\t\tif(companies.length === 1) {\n\t\t\t\tif(!cur_frm.doc.company) cur_frm.set_value(\"company\", companies[0]);\n\t\t\t\tcur_frm.toggle_display(\"company\", false);\n\t\t\t} else if(erpnext.last_selected_company) {\n\t\t\t\tif(!cur_frm.doc.company) cur_frm.set_value(\"company\", erpnext.last_selected_company);\n\t\t\t}\n\t\t}\n\t},\n\n\tis_perpetual_inventory_enabled: function(company) {\n\t\tif(company) {\n\t\t\treturn frappe.get_doc(\":Company\", company).enable_perpetual_inventory\n\t\t}\n\t},\n\n\tstale_rate_allowed: () => {\n\t\treturn cint(frappe.boot.sysdefaults.allow_stale);\n\t},\n\n\tsetup_serial_or_batch_no: function() {\n\t\tlet grid_row = cur_frm.open_grid_row();\n\t\tif (!grid_row || !grid_row.grid_form.fields_dict.serial_no ||\n\t\t\tgrid_row.grid_form.fields_dict.serial_no.get_status() !== \"Write\") return;\n\n\t\tfrappe.model.get_value('Item', {'name': grid_row.doc.item_code},\n\t\t\t['has_serial_no', 'has_batch_no'], ({has_serial_no, has_batch_no}) => {\n\t\t\t\tObject.assign(grid_row.doc, {has_serial_no, has_batch_no});\n\n\t\t\t\tif (has_serial_no) {\n\t\t\t\t\tattach_selector_button(__(\"Add Serial No\"),\n\t\t\t\t\t\tgrid_row.grid_form.fields_dict.serial_no.$wrapper, this, grid_row);\n\t\t\t\t} else if (has_batch_no) {\n\t\t\t\t\tattach_selector_button(__(\"Pick Batch No\"),\n\t\t\t\t\t\tgrid_row.grid_form.fields_dict.batch_no.$wrapper, this, grid_row);\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t},\n\n\troute_to_adjustment_jv: (args) => {\n\t\tfrappe.model.with_doctype('Journal Entry', () => {\n\t\t\t// route to adjustment Journal Entry to handle Account Balance and Stock Value mismatch\n\t\t\tlet journal_entry = frappe.model.get_new_doc('Journal Entry');\n\n\t\t\targs.accounts.forEach((je_account) => {\n\t\t\t\tlet child_row = frappe.model.add_child(journal_entry, \"accounts\");\n\t\t\t\tchild_row.account = je_account.account;\n\t\t\t\tchild_row.debit_in_account_currency = je_account.debit_in_account_currency;\n\t\t\t\tchild_row.credit_in_account_currency = je_account.credit_in_account_currency;\n\t\t\t\tchild_row.party_type = \"\" ;\n\t\t\t});\n\t\t\tfrappe.set_route('Form','Journal Entry', journal_entry.name);\n\t\t});\n\t},\n\n\troute_to_pending_reposts: (args) => {\n\t\tfrappe.set_route('List', 'Repost Item Valuation', args);\n\t},\n});\n\n\n$.extend(erpnext.utils, {\n\tset_party_dashboard_indicators: function(frm) {\n\t\tif(frm.doc.__onload && frm.doc.__onload.dashboard_info) {\n\t\t\tvar company_wise_info = frm.doc.__onload.dashboard_info;\n\t\t\tif(company_wise_info.length > 1) {\n\t\t\t\tcompany_wise_info.forEach(function(info) {\n\t\t\t\t\terpnext.utils.add_indicator_for_multicompany(frm, info);\n\t\t\t\t});\n\t\t\t} else if (company_wise_info.length === 1) {\n\t\t\t\tfrm.dashboard.add_indicator(__('Annual Billing: {0}',\n\t\t\t\t\t[format_currency(company_wise_info[0].billing_this_year, company_wise_info[0].currency)]), 'blue');\n\t\t\t\tfrm.dashboard.add_indicator(__('Total Unpaid: {0}',\n\t\t\t\t\t[format_currency(company_wise_info[0].total_unpaid, company_wise_info[0].currency)]),\n\t\t\t\tcompany_wise_info[0].total_unpaid ? 'orange' : 'green');\n\n\t\t\t\tif(company_wise_info[0].loyalty_points) {\n\t\t\t\t\tfrm.dashboard.add_indicator(__('Loyalty Points: {0}',\n\t\t\t\t\t\t[company_wise_info[0].loyalty_points]), 'blue');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\n\tadd_indicator_for_multicompany: function(frm, info) {\n\t\tfrm.dashboard.stats_area.show();\n\t\tfrm.dashboard.stats_area_row.addClass('flex');\n\t\tfrm.dashboard.stats_area_row.css('flex-wrap', 'wrap');\n\n\t\tvar color = info.total_unpaid ? 'orange' : 'green';\n\n\t\tvar indicator = $('<div class=\"flex-column col-xs-6\">'+\n\t\t\t'<div style=\"margin-top:10px\"><h6>'+info.company+'</h6></div>'+\n\n\t\t\t'<div class=\"badge-link small\" style=\"margin-bottom:10px\"><span class=\"indicator blue\">'+\n\t\t\t'Annual Billing: '+format_currency(info.billing_this_year, info.currency)+'</span></div>'+\n\n\t\t\t'<div class=\"badge-link small\" style=\"margin-bottom:10px\">'+\n\t\t\t'<span class=\"indicator '+color+'\">Total Unpaid: '\n\t\t\t+format_currency(info.total_unpaid, info.currency)+'</span></div>'+\n\n\n\t\t\t'</div>').appendTo(frm.dashboard.stats_area_row);\n\n\t\tif(info.loyalty_points){\n\t\t\t$('<div class=\"badge-link small\" style=\"margin-bottom:10px\"><span class=\"indicator blue\">'+\n\t\t\t'Loyalty Points: '+info.loyalty_points+'</span></div>').appendTo(indicator);\n\t\t}\n\n\t\treturn indicator;\n\t},\n\n\tget_party_name: function(party_type) {\n\t\tvar dict = {'Customer': 'customer_name', 'Supplier': 'supplier_name', 'Employee': 'employee_name',\n\t\t\t'Member': 'member_name'};\n\t\treturn dict[party_type];\n\t},\n\n\tcopy_value_in_all_rows: function(doc, dt, dn, table_fieldname, fieldname) {\n\t\tvar d = locals[dt][dn];\n\t\tif(d[fieldname]){\n\t\t\tvar cl = doc[table_fieldname] || [];\n\t\t\tfor(var i = 0; i < cl.length; i++) {\n\t\t\t\tif(!cl[i][fieldname]) cl[i][fieldname] = d[fieldname];\n\t\t\t}\n\t\t}\n\t\trefresh_field(table_fieldname);\n\t},\n\n\tget_terms: function(tc_name, doc, callback) {\n\t\tif(tc_name) {\n\t\t\treturn frappe.call({\n\t\t\t\tmethod: 'erpnext.setup.doctype.terms_and_conditions.terms_and_conditions.get_terms_and_conditions',\n\t\t\t\targs: {\n\t\t\t\t\ttemplate_name: tc_name,\n\t\t\t\t\tdoc: doc\n\t\t\t\t},\n\t\t\t\tcallback: function(r) {\n\t\t\t\t\tcallback(r)\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t},\n\n\tmake_bank_account: function(doctype, docname) {\n\t\tfrappe.call({\n\t\t\tmethod: \"erpnext.accounts.doctype.bank_account.bank_account.make_bank_account\",\n\t\t\targs: {\n\t\t\t\tdoctype: doctype,\n\t\t\t\tdocname: docname\n\t\t\t},\n\t\t\tfreeze: true,\n\t\t\tcallback: function(r) {\n\t\t\t\tvar doclist = frappe.model.sync(r.message);\n\t\t\t\tfrappe.set_route(\"Form\", doclist[0].doctype, doclist[0].name);\n\t\t\t}\n\t\t})\n\t},\n\n\tadd_dimensions: function(report_name, index) {\n\t\tlet filters = frappe.query_reports[report_name].filters;\n\n\t\tfrappe.call({\n\t\t\tmethod: \"erpnext.accounts.doctype.accounting_dimension.accounting_dimension.get_dimensions\",\n\t\t\tcallback: function(r) {\n\t\t\t\tlet accounting_dimensions = r.message[0];\n\t\t\t\taccounting_dimensions.forEach((dimension) => {\n\t\t\t\t\tlet found = filters.some(el => el.fieldname === dimension['fieldname']);\n\n\t\t\t\t\tif (!found) {\n\t\t\t\t\t\tconsole.log(\"Called\")\n\t\t\t\t\t\tfilters.splice(index, 0, {\n\t\t\t\t\t\t\t\"fieldname\": dimension[\"fieldname\"],\n\t\t\t\t\t\t\t\"label\": __(dimension[\"label\"]),\n\t\t\t\t\t\t\t\"fieldtype\": \"MultiSelectList\",\n\t\t\t\t\t\t\tget_data: function(txt) {\n\t\t\t\t\t\t\t\treturn frappe.db.get_link_options(dimension[\"document_type\"], txt);\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\"reqd\": 1\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t},\n\n\tadd_inventory_dimensions: function(report_name, index) {\n\t\tlet filters = frappe.query_reports[report_name].filters;\n\n\t\tfrappe.call({\n\t\t\tmethod: \"erpnext.stock.doctype.inventory_dimension.inventory_dimension.get_inventory_dimensions\",\n\t\t\tcallback: function(r) {\n\t\t\t\tif (r.message && r.message.length) {\n\t\t\t\t\tr.message.forEach((dimension) => {\n\t\t\t\t\t\tlet existing_filter = filters.filter(el => el.fieldname === dimension['fieldname']);\n\n\t\t\t\t\t\tif (!existing_filter.length) {\n\t\t\t\t\t\t\tfilters.splice(index, 0, {\n\t\t\t\t\t\t\t\t\"fieldname\": dimension[\"fieldname\"],\n\t\t\t\t\t\t\t\t\"label\": __(dimension[\"doctype\"]),\n\t\t\t\t\t\t\t\t\"fieldtype\": \"MultiSelectList\",\n\t\t\t\t\t\t\t\tget_data: function(txt) {\n\t\t\t\t\t\t\t\t\treturn frappe.db.get_link_options(dimension[\"doctype\"], txt);\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\texisting_filter[0]['fieldtype'] = \"MultiSelectList\";\n\t\t\t\t\t\t\texisting_filter[0]['get_data'] = function(txt) {\n\t\t\t\t\t\t\t\treturn frappe.db.get_link_options(dimension[\"doctype\"], txt);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t},\n\n\tmake_subscription: function(doctype, docname) {\n\t\tfrappe.call({\n\t\t\tmethod: \"frappe.automation.doctype.auto_repeat.auto_repeat.make_auto_repeat\",\n\t\t\targs: {\n\t\t\t\tdoctype: doctype,\n\t\t\t\tdocname: docname\n\t\t\t},\n\t\t\tcallback: function(r) {\n\t\t\t\tvar doclist = frappe.model.sync(r.message);\n\t\t\t\tfrappe.set_route(\"Form\", doclist[0].doctype, doclist[0].name);\n\t\t\t}\n\t\t})\n\t},\n\n\tmake_pricing_rule: function(doctype, docname) {\n\t\tfrappe.call({\n\t\t\tmethod: \"erpnext.accounts.doctype.pricing_rule.pricing_rule.make_pricing_rule\",\n\t\t\targs: {\n\t\t\t\tdoctype: doctype,\n\t\t\t\tdocname: docname\n\t\t\t},\n\t\t\tcallback: function(r) {\n\t\t\t\tvar doclist = frappe.model.sync(r.message);\n\t\t\t\tfrappe.set_route(\"Form\", doclist[0].doctype, doclist[0].name);\n\t\t\t}\n\t\t})\n\t},\n\n\t/**\n\t* Checks if the first row of a given child table is empty\n\t* @param child_table - Child table Doctype\n\t* @return {Boolean}\n\t**/\n\tfirst_row_is_empty: function(child_table){\n\t\tif($.isArray(child_table) && child_table.length > 0) {\n\t\t\treturn !child_table[0].item_code;\n\t\t}\n\t\treturn false;\n\t},\n\n\t/**\n\t* Removes the first row of a child table if it is empty\n\t* @param {_Frm} frm - The current form\n\t* @param {String} child_table_name - The child table field name\n\t* @return {Boolean}\n\t**/\n\tremove_empty_first_row: function(frm, child_table_name){\n\t\tconst rows = frm['doc'][child_table_name];\n\t\tif (this.first_row_is_empty(rows)){\n\t\t\tfrm['doc'][child_table_name] = rows.splice(1);\n\t\t}\n\t\treturn rows;\n\t},\n\tget_tree_options: function(option) {\n\t\t// get valid options for tree based on user permission & locals dict\n\t\tlet unscrub_option = frappe.model.unscrub(option);\n\t\tlet user_permission = frappe.defaults.get_user_permissions();\n\t\tlet options;\n\n\t\tif(user_permission && user_permission[unscrub_option]) {\n\t\t\toptions = user_permission[unscrub_option].map(perm => perm.doc);\n\t\t} else {\n\t\t\toptions = $.map(locals[`:${unscrub_option}`], function(c) { return c.name; }).sort();\n\t\t}\n\n\t\t// filter unique values, as there may be multiple user permissions for any value\n\t\treturn options.filter((value, index, self) => self.indexOf(value) === index);\n\t},\n\tget_tree_default: function(option) {\n\t\t// set default for a field based on user permission\n\t\tlet options = this.get_tree_options(option);\n\t\tif(options.includes(frappe.defaults.get_default(option))) {\n\t\t\treturn frappe.defaults.get_default(option);\n\t\t} else {\n\t\t\treturn options[0];\n\t\t}\n\t},\n\toverrides_parent_value_in_all_rows: function(doc, dt, dn, table_fieldname, fieldname, parent_fieldname) {\n\t\tif (doc[parent_fieldname]) {\n\t\t\tlet cl = doc[table_fieldname] || [];\n\t\t\tfor (let i = 0; i < cl.length; i++) {\n\t\t\t\tcl[i][fieldname] = doc[parent_fieldname];\n\t\t\t}\n\t\t\tfrappe.refresh_field(table_fieldname);\n\t\t}\n\t},\n\tcreate_new_doc: function (doctype, update_fields) {\n\t\tfrappe.model.with_doctype(doctype, function() {\n\t\t\tvar new_doc = frappe.model.get_new_doc(doctype);\n\t\t\tfor (let [key, value] of Object.entries(update_fields)) {\n\t\t\t\tnew_doc[key] = value;\n\t\t\t}\n\t\t\tfrappe.ui.form.make_quick_entry(doctype, null, null, new_doc);\n\t\t});\n\t},\n\n\t// check if payments app is installed on site, if not warn user.\n\tcheck_payments_app: () => {\n\t\tif (frappe.boot.versions && !frappe.boot.versions.payments) {\n\t\t\tconst marketplace_link = '<a href=\"https://frappecloud.com/marketplace/apps/payments\">Marketplace</a>'\n\t\t\tconst github_link = '<a href=\"https://github.com/frappe/payments/\">GitHub</a>'\n\t\t\tconst msg = __(\"payments app is not installed. Please install it from {0} or {1}\", [marketplace_link, github_link])\n\t\t\tfrappe.msgprint(msg);\n\t\t}\n\n\t},\n});\n\nerpnext.utils.select_alternate_items = function(opts) {\n\tconst frm = opts.frm;\n\tconst warehouse_field = opts.warehouse_field || 'warehouse';\n\tconst item_field = opts.item_field || 'item_code';\n\n\tthis.data = [];\n\tconst dialog = new frappe.ui.Dialog({\n\t\ttitle: __(\"Select Alternate Item\"),\n\t\tfields: [\n\t\t\t{fieldtype:'Section Break', label: __('Items')},\n\t\t\t{\n\t\t\t\tfieldname: \"alternative_items\", fieldtype: \"Table\", cannot_add_rows: true,\n\t\t\t\tin_place_edit: true, data: this.data,\n\t\t\t\tget_data: () => {\n\t\t\t\t\treturn this.data;\n\t\t\t\t},\n\t\t\t\tfields: [{\n\t\t\t\t\tfieldtype:'Data',\n\t\t\t\t\tfieldname:\"docname\",\n\t\t\t\t\thidden: 1\n\t\t\t\t}, {\n\t\t\t\t\tfieldtype:'Link',\n\t\t\t\t\tfieldname:\"item_code\",\n\t\t\t\t\toptions: 'Item',\n\t\t\t\t\tin_list_view: 1,\n\t\t\t\t\tread_only: 1,\n\t\t\t\t\tlabel: __('Item Code')\n\t\t\t\t}, {\n\t\t\t\t\tfieldtype:'Link',\n\t\t\t\t\tfieldname:\"alternate_item\",\n\t\t\t\t\toptions: 'Item',\n\t\t\t\t\tdefault: \"\",\n\t\t\t\t\tin_list_view: 1,\n\t\t\t\t\tlabel: __('Alternate Item'),\n\t\t\t\t\tonchange: function() {\n\t\t\t\t\t\tconst item_code = this.get_value();\n\t\t\t\t\t\tconst warehouse = this.grid_row.on_grid_fields_dict.warehouse.get_value();\n\t\t\t\t\t\tif (item_code && warehouse) {\n\t\t\t\t\t\t\tfrappe.call({\n\t\t\t\t\t\t\t\tmethod: \"erpnext.stock.utils.get_latest_stock_qty\",\n\t\t\t\t\t\t\t\targs: {\n\t\t\t\t\t\t\t\t\titem_code: item_code,\n\t\t\t\t\t\t\t\t\twarehouse: warehouse\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tcallback: (r) => {\n\t\t\t\t\t\t\t\t\tthis.grid_row.on_grid_fields_dict\n\t\t\t\t\t\t\t\t\t\t.actual_qty.set_value(r.message || 0);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tget_query: (e) => {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tquery: \"erpnext.stock.doctype.item_alternative.item_alternative.get_alternative_items\",\n\t\t\t\t\t\t\tfilters: {\n\t\t\t\t\t\t\t\titem_code: e.item_code\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t}, {\n\t\t\t\t\tfieldtype:'Link',\n\t\t\t\t\tfieldname:\"warehouse\",\n\t\t\t\t\toptions: 'Warehouse',\n\t\t\t\t\tdefault: \"\",\n\t\t\t\t\tin_list_view: 1,\n\t\t\t\t\tlabel: __('Warehouse'),\n\t\t\t\t\tonchange: function() {\n\t\t\t\t\t\tconst warehouse = this.get_value();\n\t\t\t\t\t\tconst item_code = this.grid_row.on_grid_fields_dict.item_code.get_value();\n\t\t\t\t\t\tif (item_code && warehouse) {\n\t\t\t\t\t\t\tfrappe.call({\n\t\t\t\t\t\t\t\tmethod: \"erpnext.stock.utils.get_latest_stock_qty\",\n\t\t\t\t\t\t\t\targs: {\n\t\t\t\t\t\t\t\t\titem_code: item_code,\n\t\t\t\t\t\t\t\t\twarehouse: warehouse\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tcallback: (r) => {\n\t\t\t\t\t\t\t\t\tthis.grid_row.on_grid_fields_dict\n\t\t\t\t\t\t\t\t\t\t.actual_qty.set_value(r.message || 0);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t}, {\n\t\t\t\t\tfieldtype:'Float',\n\t\t\t\t\tfieldname:\"actual_qty\",\n\t\t\t\t\tdefault: 0,\n\t\t\t\t\tread_only: 1,\n\t\t\t\t\tin_list_view: 1,\n\t\t\t\t\tlabel: __('Available Qty')\n\t\t\t\t}]\n\t\t\t},\n\t\t],\n\t\tprimary_action: function() {\n\t\t\tconst args = this.get_values()[\"alternative_items\"];\n\t\t\tconst alternative_items = args.filter(d => {\n\t\t\t\tif (d.alternate_item && d.item_code != d.alternate_item) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\talternative_items.forEach(d => {\n\t\t\t\tlet row = frappe.get_doc(opts.child_doctype, d.docname);\n\t\t\t\tlet qty = null;\n\t\t\t\tif (row.doctype === 'Work Order Item') {\n\t\t\t\t\tqty = row.required_qty;\n\t\t\t\t} else {\n\t\t\t\t\tqty = row.qty;\n\t\t\t\t}\n\t\t\t\trow[item_field] = d.alternate_item;\n\t\t\t\tfrappe.model.set_value(row.doctype, row.name, 'qty', qty);\n\t\t\t\tfrappe.model.set_value(row.doctype, row.name, opts.original_item_field, d.item_code);\n\t\t\t\tfrm.trigger(item_field, row.doctype, row.name);\n\t\t\t});\n\n\t\t\trefresh_field(opts.child_docname);\n\t\t\tthis.hide();\n\t\t},\n\t\tprimary_action_label: __('Update')\n\t});\n\n\tfrm.doc[opts.child_docname].forEach(d => {\n\t\tif (!opts.condition || opts.condition(d)) {\n\t\t\tdialog.fields_dict.alternative_items.df.data.push({\n\t\t\t\t\"docname\": d.name,\n\t\t\t\t\"item_code\": d[item_field],\n\t\t\t\t\"warehouse\": d[warehouse_field],\n\t\t\t\t\"actual_qty\": d.actual_qty\n\t\t\t});\n\t\t}\n\t})\n\n\tthis.data = dialog.fields_dict.alternative_items.df.data;\n\tdialog.fields_dict.alternative_items.grid.refresh();\n\tdialog.show();\n}\n\nerpnext.utils.update_child_items = function(opts) {\n\tconst frm = opts.frm;\n\tconst cannot_add_row = (typeof opts.cannot_add_row === 'undefined') ? true : opts.cannot_add_row;\n\tconst child_docname = (typeof opts.cannot_add_row === 'undefined') ? \"items\" : opts.child_docname;\n\tconst child_meta = frappe.get_meta(`${frm.doc.doctype} Item`);\n\tconst get_precision = (fieldname) => child_meta.fields.find(f => f.fieldname == fieldname).precision;\n\n\tthis.data = frm.doc[opts.child_docname].map((d) => {\n\t\treturn {\n\t\t\t\"docname\": d.name,\n\t\t\t\"name\": d.name,\n\t\t\t\"item_code\": d.item_code,\n\t\t\t\"delivery_date\": d.delivery_date,\n\t\t\t\"schedule_date\": d.schedule_date,\n\t\t\t\"conversion_factor\": d.conversion_factor,\n\t\t\t\"qty\": d.qty,\n\t\t\t\"rate\": d.rate,\n\t\t\t\"uom\": d.uom\n\t\t}\n\t});\n\n\tconst fields = [{\n\t\tfieldtype:'Data',\n\t\tfieldname:\"docname\",\n\t\tread_only: 1,\n\t\thidden: 1,\n\t}, {\n\t\tfieldtype:'Link',\n\t\tfieldname:\"item_code\",\n\t\toptions: 'Item',\n\t\tin_list_view: 1,\n\t\tread_only: 0,\n\t\tdisabled: 0,\n\t\tlabel: __('Item Code'),\n\t\tget_query: function() {\n\t\t\tlet filters;\n\t\t\tif (frm.doc.doctype == 'Sales Order') {\n\t\t\t\tfilters = {\"is_sales_item\": 1};\n\t\t\t} else if (frm.doc.doctype == 'Purchase Order') {\n\t\t\t\tif (frm.doc.is_subcontracted) {\n\t\t\t\t\tif (frm.doc.is_old_subcontracting_flow) {\n\t\t\t\t\t\tfilters = {\"is_sub_contracted_item\": 1};\n\t\t\t\t\t} else {\n\t\t\t\t\t\tfilters = {\"is_stock_item\": 0};\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tfilters = {\"is_purchase_item\": 1};\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn {\n\t\t\t\tquery: \"erpnext.controllers.queries.item_query\",\n\t\t\t\tfilters: filters\n\t\t\t};\n\t\t}\n\t}, {\n\t\tfieldtype:'Link',\n\t\tfieldname:'uom',\n\t\toptions: 'UOM',\n\t\tread_only: 0,\n\t\tlabel: __('UOM'),\n\t\treqd: 1,\n\t\tonchange: function () {\n\t\t\tfrappe.call({\n\t\t\t\tmethod: \"erpnext.stock.get_item_details.get_conversion_factor\",\n\t\t\t\targs: { item_code: this.doc.item_code, uom: this.value },\n\t\t\t\tcallback: r => {\n\t\t\t\t\tif(!r.exc) {\n\t\t\t\t\t\tif (this.doc.conversion_factor == r.message.conversion_factor) return;\n\n\t\t\t\t\t\tconst docname = this.doc.docname;\n\t\t\t\t\t\tdialog.fields_dict.trans_items.df.data.some(doc => {\n\t\t\t\t\t\t\tif (doc.docname == docname) {\n\t\t\t\t\t\t\t\tdoc.conversion_factor = r.message.conversion_factor;\n\t\t\t\t\t\t\t\tdialog.fields_dict.trans_items.grid.refresh();\n\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}, {\n\t\tfieldtype:'Float',\n\t\tfieldname:\"qty\",\n\t\tdefault: 0,\n\t\tread_only: 0,\n\t\tin_list_view: 1,\n\t\tlabel: __('Qty'),\n\t\tprecision: get_precision(\"qty\")\n\t}, {\n\t\tfieldtype:'Currency',\n\t\tfieldname:\"rate\",\n\t\toptions: \"currency\",\n\t\tdefault: 0,\n\t\tread_only: 0,\n\t\tin_list_view: 1,\n\t\tlabel: __('Rate'),\n\t\tprecision: get_precision(\"rate\")\n\t}];\n\n\tif (frm.doc.doctype == 'Sales Order' || frm.doc.doctype == 'Purchase Order' ) {\n\t\tfields.splice(2, 0, {\n\t\t\tfieldtype: 'Date',\n\t\t\tfieldname: frm.doc.doctype == 'Sales Order' ? \"delivery_date\" : \"schedule_date\",\n\t\t\tin_list_view: 1,\n\t\t\tlabel: frm.doc.doctype == 'Sales Order' ? __(\"Delivery Date\") : __(\"Reqd by date\"),\n\t\t\treqd: 1\n\t\t})\n\t\tfields.splice(3, 0, {\n\t\t\tfieldtype: 'Float',\n\t\t\tfieldname: \"conversion_factor\",\n\t\t\tin_list_view: 1,\n\t\t\tlabel: __(\"Conversion Factor\"),\n\t\t\tprecision: get_precision('conversion_factor')\n\t\t})\n\t}\n\n\tnew frappe.ui.Dialog({\n\t\ttitle: __(\"Update Items\"),\n\t\tfields: [\n\t\t\t{\n\t\t\t\tfieldname: \"trans_items\",\n\t\t\t\tfieldtype: \"Table\",\n\t\t\t\tlabel: \"Items\",\n\t\t\t\tcannot_add_rows: cannot_add_row,\n\t\t\t\tin_place_edit: false,\n\t\t\t\treqd: 1,\n\t\t\t\tdata: this.data,\n\t\t\t\tget_data: () => {\n\t\t\t\t\treturn this.data;\n\t\t\t\t},\n\t\t\t\tfields: fields\n\t\t\t},\n\t\t],\n\t\tprimary_action: function() {\n\t\t\tconst trans_items = this.get_values()[\"trans_items\"].filter((item) => !!item.item_code);\n\t\t\tfrappe.call({\n\t\t\t\tmethod: 'erpnext.controllers.accounts_controller.update_child_qty_rate',\n\t\t\t\tfreeze: true,\n\t\t\t\targs: {\n\t\t\t\t\t'parent_doctype': frm.doc.doctype,\n\t\t\t\t\t'trans_items': trans_items,\n\t\t\t\t\t'parent_doctype_name': frm.doc.name,\n\t\t\t\t\t'child_docname': child_docname\n\t\t\t\t},\n\t\t\t\tcallback: function() {\n\t\t\t\t\tfrm.reload_doc();\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis.hide();\n\t\t\trefresh_field(\"items\");\n\t\t},\n\t\tprimary_action_label: __('Update')\n\t}).show();\n}\n\nerpnext.utils.map_current_doc = function(opts) {\n\tfunction _map() {\n\t\tif($.isArray(cur_frm.doc.items) && cur_frm.doc.items.length > 0) {\n\t\t\t// remove first item row if empty\n\t\t\tif(!cur_frm.doc.items[0].item_code) {\n\t\t\t\tcur_frm.doc.items = cur_frm.doc.items.splice(1);\n\t\t\t}\n\n\t\t\t// find the doctype of the items table\n\t\t\tvar items_doctype = frappe.meta.get_docfield(cur_frm.doctype, 'items').options;\n\n\t\t\t// find the link fieldname from items table for the given\n\t\t\t// source_doctype\n\t\t\tvar link_fieldname = null;\n\t\t\tfrappe.get_meta(items_doctype).fields.forEach(function(d) {\n\t\t\t\tif(d.options===opts.source_doctype) link_fieldname = d.fieldname; });\n\n\t\t\t// search in existing items if the source_name is already set and full qty fetched\n\t\t\tvar already_set = false;\n\t\t\tvar item_qty_map = {};\n\n\t\t\t$.each(cur_frm.doc.items, function(i, d) {\n\t\t\t\topts.source_name.forEach(function(src) {\n\t\t\t\t\tif(d[link_fieldname]==src) {\n\t\t\t\t\t\talready_set = true;\n\t\t\t\t\t\tif (item_qty_map[d.item_code])\n\t\t\t\t\t\t\titem_qty_map[d.item_code] += flt(d.qty);\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\titem_qty_map[d.item_code] = flt(d.qty);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tif(already_set) {\n\t\t\t\topts.source_name.forEach(function(src) {\n\t\t\t\t\tfrappe.model.with_doc(opts.source_doctype, src, function(r) {\n\t\t\t\t\t\tvar source_doc = frappe.model.get_doc(opts.source_doctype, src);\n\t\t\t\t\t\t$.each(source_doc.items || [], function(i, row) {\n\t\t\t\t\t\t\tif(row.qty > flt(item_qty_map[row.item_code])) {\n\t\t\t\t\t\t\t\talready_set = false;\n\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t})\n\n\t\t\t\t\tif(already_set) {\n\t\t\t\t\t\tfrappe.msgprint(__(\"You have already selected items from {0} {1}\",\n\t\t\t\t\t\t\t[opts.source_doctype, src]));\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t})\n\t\t\t}\n\t\t}\n\n\t\treturn frappe.call({\n\t\t\t// Sometimes we hit the limit for URL length of a GET request\n\t\t\t// as we send the full target_doc. Hence this is a POST request.\n\t\t\ttype: \"POST\",\n\t\t\tmethod: 'frappe.model.mapper.map_docs',\n\t\t\targs: {\n\t\t\t\t\"method\": opts.method,\n\t\t\t\t\"source_names\": opts.source_name,\n\t\t\t\t\"target_doc\": cur_frm.doc,\n\t\t\t\t\"args\": opts.args\n\t\t\t},\n\t\t\tcallback: function(r) {\n\t\t\t\tif(!r.exc) {\n\t\t\t\t\tvar doc = frappe.model.sync(r.message);\n\t\t\t\t\tcur_frm.dirty();\n\t\t\t\t\tcur_frm.refresh();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tlet query_args = {};\n\tif (opts.get_query_filters) {\n\t\tquery_args.filters = opts.get_query_filters;\n\t}\n\n\tif (opts.get_query_method) {\n\t\tquery_args.query = opts.get_query_method;\n\t}\n\n\tif (query_args.filters || query_args.query) {\n\t\topts.get_query = () => query_args;\n\t}\n\n\tif (opts.source_doctype) {\n\t\tconst d = new frappe.ui.form.MultiSelectDialog({\n\t\t\tdoctype: opts.source_doctype,\n\t\t\ttarget: opts.target,\n\t\t\tdate_field: opts.date_field || undefined,\n\t\t\tsetters: opts.setters,\n\t\t\tget_query: opts.get_query,\n\t\t\tadd_filters_group: 1,\n\t\t\tallow_child_item_selection: opts.allow_child_item_selection,\n\t\t\tchild_fieldname: opts.child_fieldname,\n\t\t\tchild_columns: opts.child_columns,\n\t\t\tsize: opts.size,\n\t\t\taction: function(selections, args) {\n\t\t\t\tlet values = selections;\n\t\t\t\tif (values.length === 0) {\n\t\t\t\t\tfrappe.msgprint(__(\"Please select {0}\", [opts.source_doctype]))\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\topts.source_name = values;\n\t\t\t\tif (opts.allow_child_item_selection) {\n\t\t\t\t\t// args contains filtered child docnames\n\t\t\t\t\topts.args = args;\n\t\t\t\t}\n\t\t\t\td.dialog.hide();\n\t\t\t\t_map();\n\t\t\t},\n\t\t});\n\n\t\treturn d;\n\t}\n\n\tif (opts.source_name) {\n\t\topts.source_name = [opts.source_name];\n\t\t_map();\n\t}\n}\n\nfrappe.form.link_formatters['Item'] = function(value, doc) {\n\tif (doc && value && doc.item_name && doc.item_name !== value && doc.item_code === value) {\n\t\treturn value + ': ' + doc.item_name;\n\t} else if (!value && doc.doctype && doc.item_name) {\n\t\t// format blank value in child table\n\t\treturn doc.item_name;\n\t} else {\n\t\t// if value is blank in report view or item code and name are the same, return as is\n\t\treturn value;\n\t}\n}\n\nfrappe.form.link_formatters['Employee'] = function(value, doc) {\n\tif (doc && value && doc.employee_name && doc.employee_name !== value && doc.employee === value) {\n\t\treturn value + ': ' + doc.employee_name;\n\t} else if (!value && doc.doctype && doc.employee_name) {\n\t\t// format blank value in child table\n\t\treturn doc.employee;\n\t} else {\n\t\t// if value is blank in report view or project name and name are the same, return as is\n\t\treturn value;\n\t}\n}\n\nfrappe.form.link_formatters['Project'] = function(value, doc) {\n\tif (doc && value && doc.project_name && doc.project_name !== value && doc.project === value) {\n\t\treturn value + ': ' + doc.project_name;\n\t} else if (!value && doc.doctype && doc.project_name) {\n\t\t// format blank value in child table\n\t\treturn doc.project;\n\t} else {\n\t\t// if value is blank in report view or project name and name are the same, return as is\n\t\treturn value;\n\t}\n};\n\n// add description on posting time\n$(document).on('app_ready', function() {\n\tif(!frappe.datetime.is_timezone_same()) {\n\t\t$.each([\"Stock Reconciliation\", \"Stock Entry\", \"Stock Ledger Entry\",\n\t\t\t\"Delivery Note\", \"Purchase Receipt\", \"Sales Invoice\"], function(i, d) {\n\t\t\tfrappe.ui.form.on(d, \"onload\", function(frm) {\n\t\t\t\tcur_frm.set_df_property(\"posting_time\", \"description\",\n\t\t\t\t\tfrappe.sys_defaults.time_zone);\n\t\t\t});\n\t\t});\n\t}\n});\n\n// Show SLA dashboard\n$(document).on('app_ready', function() {\n\tfrappe.call({\n\t\tmethod: 'erpnext.support.doctype.service_level_agreement.service_level_agreement.get_sla_doctypes',\n\t\tcallback: function(r) {\n\t\t\tif (!r.message)\n\t\t\t\treturn;\n\n\t\t\t$.each(r.message, function(_i, d) {\n\t\t\t\tfrappe.ui.form.on(d, {\n\t\t\t\t\tonload: function(frm) {\n\t\t\t\t\t\tif (!frm.doc.service_level_agreement)\n\t\t\t\t\t\t\treturn;\n\n\t\t\t\t\t\tfrappe.call({\n\t\t\t\t\t\t\tmethod: 'erpnext.support.doctype.service_level_agreement.service_level_agreement.get_service_level_agreement_filters',\n\t\t\t\t\t\t\targs: {\n\t\t\t\t\t\t\t\tdoctype: frm.doc.doctype,\n\t\t\t\t\t\t\t\tname: frm.doc.service_level_agreement,\n\t\t\t\t\t\t\t\tcustomer: frm.doc.customer\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tcallback: function (r) {\n\t\t\t\t\t\t\t\tif (r && r.message) {\n\t\t\t\t\t\t\t\t\tfrm.set_query('priority', function() {\n\t\t\t\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t\t\t\tfilters: {\n\t\t\t\t\t\t\t\t\t\t\t\t'name': ['in', r.message.priority],\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\tfrm.set_query('service_level_agreement', function() {\n\t\t\t\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t\t\t\tfilters: {\n\t\t\t\t\t\t\t\t\t\t\t\t'name': ['in', r.message.service_level_agreements],\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\n\t\t\t\t\trefresh: function(frm) {\n\t\t\t\t\t\tif (frm.doc.status !== 'Closed' && frm.doc.service_level_agreement\n\t\t\t\t\t\t\t&& ['First Response Due', 'Resolution Due'].includes(frm.doc.agreement_status)) {\n\t\t\t\t\t\t\tfrappe.call({\n\t\t\t\t\t\t\t\t'method': 'frappe.client.get',\n\t\t\t\t\t\t\t\targs: {\n\t\t\t\t\t\t\t\t\tdoctype: 'Service Level Agreement',\n\t\t\t\t\t\t\t\t\tname: frm.doc.service_level_agreement\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tcallback: function(data) {\n\t\t\t\t\t\t\t\t\tlet statuses = data.message.pause_sla_on;\n\t\t\t\t\t\t\t\t\tconst hold_statuses = [];\n\t\t\t\t\t\t\t\t\t$.each(statuses, (_i, entry) => {\n\t\t\t\t\t\t\t\t\t\thold_statuses.push(entry.status);\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\tif (hold_statuses.includes(frm.doc.status)) {\n\t\t\t\t\t\t\t\t\t\tfrm.dashboard.clear_headline();\n\t\t\t\t\t\t\t\t\t\tlet message = {'indicator': 'orange', 'msg': __('SLA is on hold since {0}', [moment(frm.doc.on_hold_since).fromNow(true)])};\n\t\t\t\t\t\t\t\t\t\tfrm.dashboard.set_headline_alert(\n\t\t\t\t\t\t\t\t\t\t\t'<div class=\"row\">' +\n\t\t\t\t\t\t\t\t\t\t\t\t'<div class=\"col-xs-12\">' +\n\t\t\t\t\t\t\t\t\t\t\t\t\t'<span class=\"indicator whitespace-nowrap '+ message.indicator +'\"><span>'+ message.msg +'</span></span> ' +\n\t\t\t\t\t\t\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t\t\t\t\t\t\t'</div>'\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tset_time_to_resolve_and_response(frm, data.message.apply_sla_for_resolution);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} else if (frm.doc.service_level_agreement) {\n\t\t\t\t\t\t\tfrm.dashboard.clear_headline();\n\n\t\t\t\t\t\t\tlet agreement_status = (frm.doc.agreement_status == 'Fulfilled') ?\n\t\t\t\t\t\t\t\t{'indicator': 'green', 'msg': 'Service Level Agreement has been fulfilled'} :\n\t\t\t\t\t\t\t\t{'indicator': 'red', 'msg': 'Service Level Agreement Failed'};\n\n\t\t\t\t\t\t\tfrm.dashboard.set_headline_alert(\n\t\t\t\t\t\t\t\t'<div class=\"row\">' +\n\t\t\t\t\t\t\t\t\t'<div class=\"col-xs-12\">' +\n\t\t\t\t\t\t\t\t\t\t'<span class=\"indicator whitespace-nowrap '+ agreement_status.indicator +'\"><span class=\"hidden-xs\">'+ agreement_status.msg +'</span></span> ' +\n\t\t\t\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t\t\t\t'</div>'\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t});\n});\n\nfunction set_time_to_resolve_and_response(frm, apply_sla_for_resolution) {\n\tfrm.dashboard.clear_headline();\n\n\tlet time_to_respond;\n\tif (!frm.doc.first_responded_on) {\n\t\ttime_to_respond = get_time_left(frm.doc.response_by, frm.doc.agreement_status);\n\t} else {\n\t\ttime_to_respond = get_status(frm.doc.response_by, frm.doc.first_responded_on);\n\t}\n\n\tlet alert = `\n\t\t<div class=\"row\">\n\t\t\t<div class=\"col-xs-12 col-sm-6\">\n\t\t\t\t<span class=\"indicator whitespace-nowrap ${time_to_respond.indicator}\">\n\t\t\t\t\t<span>Time to Respond: ${time_to_respond.diff_display}</span>\n\t\t\t\t</span>\n\t\t\t</div>`;\n\n\n\tif (apply_sla_for_resolution) {\n\t\tlet time_to_resolve;\n\t\tif (!frm.doc.resolution_date) {\n\t\t\ttime_to_resolve = get_time_left(frm.doc.resolution_by, frm.doc.agreement_status);\n\t\t} else {\n\t\t\ttime_to_resolve = get_status(frm.doc.resolution_by, frm.doc.resolution_date);\n\t\t}\n\n\t\talert += `\n\t\t\t<div class=\"col-xs-12 col-sm-6\">\n\t\t\t\t<span class=\"indicator whitespace-nowrap ${time_to_resolve.indicator}\">\n\t\t\t\t\t<span>Time to Resolve: ${time_to_resolve.diff_display}</span>\n\t\t\t\t</span>\n\t\t\t</div>`;\n\t}\n\n\talert += '</div>';\n\n\tfrm.dashboard.set_headline_alert(alert);\n}\n\nfunction get_time_left(timestamp, agreement_status) {\n\tconst diff = moment(timestamp).diff(moment());\n\tconst diff_display = diff >= 44500 ? moment.duration(diff).humanize() : 'Failed';\n\tlet indicator = (diff_display == 'Failed' && agreement_status != 'Fulfilled') ? 'red' : 'green';\n\treturn {'diff_display': diff_display, 'indicator': indicator};\n}\n\nfunction get_status(expected, actual) {\n\tconst time_left = moment(expected).diff(moment(actual));\n\tif (time_left >= 0) {\n\t\treturn {'diff_display': 'Fulfilled', 'indicator': 'green'};\n\t} else {\n\t\treturn {'diff_display': 'Failed', 'indicator': 'red'};\n\t}\n}\n\nfunction attach_selector_button(inner_text, append_loction, context, grid_row) {\n\tlet $btn_div = $(\"<div>\").css({\"margin-bottom\": \"10px\", \"margin-top\": \"10px\"})\n\t\t.appendTo(append_loction);\n\tlet $btn = $(`<button class=\"btn btn-sm btn-default\">${inner_text}</button>`)\n\t\t.appendTo($btn_div);\n\n\t$btn.on(\"click\", function() {\n\t\tcontext.show_serial_batch_selector(grid_row.frm, grid_row.doc, \"\", \"\", true);\n\t});\n}\n"],
  "mappings": "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",
  "names": []
}
